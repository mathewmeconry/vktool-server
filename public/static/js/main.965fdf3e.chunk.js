(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{12:function(e,t,n){"use strict";var a;n.d(t,"a",function(){return a}),function(e){e.AUTHENTICATED="authenticated",e.CONTACTS_READ="contacts_read",e.CONTACTS_EDIT="contacts_edit",e.MEMBERS_READ="members_read",e.MEMBERS_EDIT="members_edit",e.MAILING_LISTS="mailing_lists",e.RANKS_READ="ranks_read",e.RANKS_EDIT="ranks_edit",e.ORDERS_READ="orders_read",e.ORDERS_EDIT="orders_edit",e.COMPENSATIONS_READ="compensations_read",e.COMPENSATIONS_CREATE="compensations_create",e.COMPENSATIONS_EDIT="compensations_edit",e.COMPENSATIONS_APPROVE="compensations_approve",e.BILLINGREPORTS_READ="billingreports_read",e.BILLINGREPORTS_CREATE="billingreports_create",e.BILLINGREPORTS_EDIT="billingreports_edit",e.BILLINGREPORTS_APPROVE="billingrepors_approve",e.DRAFT_READ="draft_read",e.DRAFT_CREATE="draft_create",e.DRAFT_EDIT="draft_edit",e.PAYOUTS_READ="payouts_read",e.PAYOUTS_CREATE="payouts_create",e.PAYOUTS_SEND="payouts_send",e.LOGOFFS_READ="logoffs_read",e.LOGOFFS_CREATE="logoffs_create",e.LOGOFFS_EDIT="logoffs_edit",e.LOGOFFS_APPROVE="logoffs_approve",e.ADMIN="admin"}(a||(a={}))},135:function(e,t){},152:function(e,t,n){"use strict";(function(e){n.d(t,"a",function(){return R});var a=n(3),r=n.n(a),o=n(14),i=n(6),s=n(9),c=n(5),l=n(11),u=n(4),p=n(10),d=n(153),h=n.n(d),f=n(0),m=n.n(f),b=n(20),v=n(22),y=n(16),g=n(18),E=n(8),O=n(15),k=n(154),C=n(155),S=n(88),j=n(156),N=n(157),w=n(24);function x(e){return function(){var t,n=Object(u.a)(e);if(function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var a=Object(u.a)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return Object(l.a)(this,t)}}var A=function(t){Object(p.a)(a,t);var n=x(a);function a(t){var r;return Object(i.a)(this,a),(r=n.call(this,t)).onNext=r.onNext.bind(Object(c.a)(r)),r.save=r.save.bind(Object(c.a)(r)),e(function(){r.props.fetchOpenOrders(),r.props.fetchMembers()}),r.state={els:[],drivers:[]},r}return Object(s.a)(a,[{key:"onNext",value:function(e){var t=this.state;for(var n in e)t[n]=e[n];this.setState(t)}},{key:"save",value:function(){var e=Object(o.a)(r.a.mark(function e(){var t,n;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(n in t={},this.state.vks)t[n]=this.state.vks[n],t[n].member=this.state.vks[n].member.id;return e.next=4,this.props.save({orderId:this.state.order.id,date:this.state.date,compensationEntries:this.state.vks,els:this.state.els,drivers:this.state.drivers,food:this.state.food,remarks:this.state.remarks,creatorId:this.props.user.id});case 4:return this.props.history.push("/billing-reports"),e.abrupt("return",!0);case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return this.props.loading?m.a.createElement(b.a,{title:"Verrechnungsrapport erfassen"},m.a.createElement(w.a,null)):m.a.createElement(b.a,{title:"Verrechnungsrapport erfassen"},m.a.createElement(v.a,null,m.a.createElement(y.a,{className:"col"},m.a.createElement(g.a,{title:""},m.a.createElement(h.a,{nav:m.a.createElement(k.a,null)},m.a.createElement(C.a,{openOrders:this.props.openOrders,onNext:this.onNext}),m.a.createElement(S.a,{onNext:this.onNext}),m.a.createElement(j.a,{onNext:this.onNext}),m.a.createElement(N.a,{onNext:this.save,order:this.state.order,date:this.state.date,vks:this.state.vks,els:this.state.els.map(function(e){return e.firstname+" "+e.lastname}),drivers:this.state.drivers.map(function(e){return e.firstname+" "+e.lastname}),food:this.state.food,remarks:this.state.remarks}))))))}}]),a}(f.Component),R=Object(O.c)(function(e){return{user:e.data.user.data,openOrders:e.data.openOrders,members:e.data.members,loading:e.data.openOrders.loading&&e.data.members.loading&&e.data.user.loading&&0===e.data.members.ids.length&&Object.keys(e.data.user.data).length<0}},function(e){return{fetchOpenOrders:function(){e(E.a.fetchOpenOrders())},fetchMembers:function(){e(E.a.fetchMembers())},save:function(t){return e(E.a.addBillingReport(t))}}})(A)}).call(this,n(93).setImmediate)},154:function(e,t,n){"use strict";n.d(t,"a",function(){return u});var a=n(6),r=n(9),o=n(11),i=n(4),s=n(10),c=n(0),l=n.n(c),u=function(e){function t(){return Object(a.a)(this,t),Object(o.a)(this,Object(i.a)(t).apply(this,arguments))}return Object(s.a)(t,e),Object(r.a)(t,[{key:"renderSteps",value:function(){for(var e=[],t=this.props.totalSteps||0,n=1;n<=t;n++){var a="dot";n==this.props.currentStep&&(a+=" active"),e.push(l.a.createElement("span",{key:n,className:a},"\u2022"))}return e}},{key:"render",value:function(){return l.a.createElement("div",{key:"WizardNav",id:"WizardNav",className:"d-flex justify-content-center"},this.renderSteps())}}]),t}(c.Component)},155:function(e,t,n){"use strict";n.d(t,"a",function(){return b});var a=n(3),r=n.n(a),o=n(14),i=n(30),s=n(6),c=n(9),l=n(11),u=n(4),p=n(5),d=n(10),h=n(0),f=n.n(h),m=n(58),b=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).onInputChange=n.onInputChange.bind(Object(p.a)(n)),n.validate=n.validate.bind(Object(p.a)(n)),n.state={order:"",date:""},n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"renderOptions",value:function(){var e=[f.a.createElement("option",{key:"none",value:""},"Bitte W\xe4hlen")],t=!0,n=!1,a=void 0;try{for(var r,o=this.props.openOrders.ids[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){var i=r.value,s=this.props.openOrders.byId[i];s.contact.firstname?e.push(f.a.createElement("option",{key:s.documentNr,value:s.id},"".concat(s.title))):e.push(f.a.createElement("option",{key:s.documentNr,value:s.id},"".concat(s.title," (").concat(s.contact.lastname,")")))}}catch(c){n=!0,a=c}finally{try{t||null==o.return||o.return()}finally{if(n)throw a}}return e}},{key:"onInputChange",value:function(e){var t=e.target,n=t.value,a=t.name;this.setState(Object(i.a)({},a,n))}},{key:"validate",value:function(){var e=Object(o.a)(r.a.mark(function e(){var t;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.formEl){e.next=5;break}return t=this.formEl.checkValidity(),this.formEl.className="was-validated",t&&this.props.onNext({order:this.props.openOrders.byId[parseInt(this.state.order)],date:new Date(this.state.date)}),e.abrupt("return",t);case 5:return e.abrupt("return",!1);case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return f.a.createElement(m.a,Object.assign({title:"Details",onNextStep:this.validate},this.props),f.a.createElement("form",{ref:function(t){return e.formEl=t}},f.a.createElement("h5",null,"Einsatz"),f.a.createElement("select",{className:"form-control",name:"order",id:"order",onChange:this.onInputChange,value:this.state.order,required:!0},this.renderOptions()),f.a.createElement("br",null),f.a.createElement("h5",null,"Datum"),f.a.createElement("input",{type:"Date",name:"date",id:"date",className:"form-control",value:this.state.date,onChange:this.onInputChange,required:!0})))}}]),t}(h.Component)},156:function(e,t,n){"use strict";n.d(t,"a",function(){return y});var a=n(3),r=n.n(a),o=n(14),i=n(30),s=n(6),c=n(9),l=n(11),u=n(4),p=n(5),d=n(10),h=n(0),f=n.n(h),m=n(58),b=n(65),v=n(54),y=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).onInputChange=n.onInputChange.bind(Object(p.a)(n)),n.onNext=n.onNext.bind(Object(p.a)(n)),n.onELChange=n.onSelectChange("els"),n.onDriversChange=n.onSelectChange("drivers"),n.state={els:[],drivers:[],food:!1,remarks:""},n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"onInputChange",value:function(e){var t=e.target,n="checkbox"===t.type?t.checked:t.value,a=t.id;this.setState(Object(i.a)({},a,n))}},{key:"onSelectChange",value:function(e){var t=this;return function(n){n?t.setState(Object(i.a)({},e,n)):t.setState(Object(i.a)({},e,[]))}}},{key:"onNext",value:function(){var e=Object(o.a)(r.a.mark(function e(){var t;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.elSelect){e.next=6;break}if(t=!0,this.state.els.length<=0&&(t=!1),!t){e.next=6;break}return this.props.onNext(this.state),e.abrupt("return",!0);case 6:return e.abrupt("return",!1);case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return f.a.createElement(m.a,Object.assign({title:"Weiteres",onNextStep:this.onNext},this.props),f.a.createElement("form",{ref:function(t){return e.formEl=t},className:"was-validated"},f.a.createElement("h5",null,"ELs"),f.a.createElement(v.a,{ref:function(t){return e.elSelect=t},onChange:this.onELChange,isMulti:!0,required:!0}),f.a.createElement("br",null),f.a.createElement("h5",null,"Fahrer"),f.a.createElement(v.a,{ref:function(t){return e.driversSelect=t},onChange:this.onDriversChange,isMulti:!0,required:!1}),f.a.createElement("br",null),f.a.createElement("h5",null,"Diverses"),f.a.createElement(b.a,{id:"food",checked:this.state.food,onChange:this.onInputChange,label:"Verpflegung"}),f.a.createElement("br",null),f.a.createElement("h5",null,"Bemerkungen"),f.a.createElement("small",{className:"text-muted"},"Bei mehreren EL bitte die Schichtzeiten hier eingeben"),f.a.createElement("textarea",{id:"remarks",value:this.state.remarks,onChange:this.onInputChange,className:"form-control"})))}}]),t}(h.Component)},157:function(e,t,n){"use strict";n.d(t,"a",function(){return d});var a=n(6),r=n(9),o=n(11),i=n(4),s=n(10),c=n(0),l=n.n(c),u=n(58),p=n(33),d=function(e){function t(){return Object(a.a)(this,t),Object(o.a)(this,Object(i.a)(t).apply(this,arguments))}return Object(s.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){return l.a.createElement(u.a,Object.assign({title:"Zusammenfassung",onNextStep:this.props.onNext},this.props),l.a.createElement("h5",null,"Einsatz"),l.a.createElement("p",null,this.props.order?this.props.order.title:""),l.a.createElement("h5",null,"Datum"),l.a.createElement("p",null,this.props.date?this.props.date.toLocaleDateString():""),l.a.createElement("h5",null,"VKs"),l.a.createElement(p.a,{columns:[{text:"VK",keys:{member:["firstname","lastname"]}},{text:"Von",keys:["from"],format:"toLocaleTimeString"},{text:"Bis",keys:["until"],format:"toLocaleTimeString"},{text:"Verrechnet",keys:["charge"]},{text:"Anzahl Stunden",keys:["totalHours"]}],defaultSort:{keys:["from"],direction:"asc"},data:this.props.vks?this.props.vks:{}}),l.a.createElement("h5",null,"ELs"),l.a.createElement("p",null,this.props.els.join(",")),l.a.createElement("h5",null,"Fahrer"),l.a.createElement("p",null,this.props.drivers.join(",")),l.a.createElement("h5",null,"Diverses"),l.a.createElement("p",{className:"switch switch-sm"},l.a.createElement("input",{type:"checkbox",className:"switch",id:"food",name:"food",checked:this.props.food}),l.a.createElement("label",{htmlFor:"food"},"Verpflegung")),l.a.createElement("h5",null,"Bemerkungen"),l.a.createElement("p",null,this.props.remarks?this.props.remarks:""))}}]),t}(c.Component)},16:function(e,t,n){"use strict";n.d(t,"a",function(){return u});var a=n(6),r=n(9),o=n(11),i=n(4),s=n(10),c=n(0),l=n.n(c),u=function(e){function t(e){var n;return Object(a.a)(this,t),(n=Object(o.a)(this,Object(i.a)(t).call(this,e))).className="col",n.props.className&&n.props.className.indexOf("col")>-1?n.className=n.props.className:n.props.className&&(n.className+=" "+n.props.className),n}return Object(s.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){return l.a.createElement("div",{className:this.className},this.props.children)}}]),t}(c.Component)},161:function(e,t,n){e.exports=n(276)},17:function(e,t,n){"use strict";n.d(t,"b",function(){return l}),n.d(t,"a",function(){return u});var a=n(3),r=n.n(a),o=n(14),i=n(6),s=n(9),c=n(34),l={NAVIBAR_TOGGLE:"navibar_toggle",NAVIBAR_OPEN:"navibar_open",NAVIBAR_CLOSE:"navibar_close",NAVIBAR_LEVEL_OPEN:"navibar_level_open",NAVIBAR_LEVEL_COLLAPSE:"navibar_level_collapse",NOTIFICATION_SUCCESS:"notification_success",NOTIFICATION_ERROR:"notification_error",LOGOUT:"logout",WORKING:"working"},u=function(){function e(){Object(i.a)(this,e)}return Object(s.a)(e,null,[{key:"toggleNavibar",value:function(){return{type:l.NAVIBAR_TOGGLE}}},{key:"openNavibar",value:function(){return{type:l.NAVIBAR_OPEN}}},{key:"closeNavibar",value:function(){return{type:l.NAVIBAR_CLOSE}}},{key:"openNavibarLevel",value:function(e){return{type:l.NAVIBAR_LEVEL_OPEN,payload:e}}},{key:"collapseNavibarLevel",value:function(){return{type:l.NAVIBAR_LEVEL_COLLAPSE}}},{key:"showError",value:function(e){return{type:l.NOTIFICATION_ERROR,payload:e}}},{key:"showSuccess",value:function(e){return{type:l.NOTIFICATION_SUCCESS,payload:e}}},{key:"logout",value:function(){return function(){var e=Object(o.a)(r.a.mark(function e(t){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t(Object(c.d)("/login")),e.abrupt("return",{type:l.LOGOUT});case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()}},{key:"setWorking",value:function(e){return{type:l.WORKING,payload:e}}}]),e}()},18:function(e,t,n){"use strict";n.d(t,"a",function(){return u});var a=n(6),r=n(9),o=n(11),i=n(4),s=n(10),c=n(0),l=n.n(c),u=function(e){function t(){return Object(a.a)(this,t),Object(o.a)(this,Object(i.a)(t).apply(this,arguments))}return Object(s.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e,t=this.props.actions||[];return this.props.title?e=this.props.title&&l.a.isValidElement(this.props.title)?l.a.createElement("div",{className:"panel-header d-flex align-items-center"},this.props.title,l.a.createElement("div",{className:"panel-actions"},t.map(function(e){return e}))):l.a.createElement("div",{className:"panel-header"},l.a.createElement("span",{className:"panel-title"},this.props.title),l.a.createElement("div",{className:"panel-actions"},t.map(function(e){return e}))):this.props.actions&&this.props.actions.length>0&&(e=l.a.createElement("div",{className:"panel-header"},l.a.createElement("div",{className:"panel-actions"},t.map(function(e){return e})))),l.a.createElement("div",{className:"panel "+(this.props.className||"")},e,l.a.createElement("div",{className:"panel-body ".concat(this.props.scrollable?"panel-body-scrollable":"")},this.props.children))}}]),t}(c.Component)},199:function(e,t,n){},20:function(e,t,n){"use strict";var a=n(6),r=n(9),o=n(5),i=n(11),s=n(4),c=n(10),l=n(0),u=n.n(l),p=n(15),d=n(17),h=function(e){function t(e){var n;return Object(a.a)(this,t),(n=Object(i.a)(this,Object(s.a)(t).call(this,e))).scrolling=!1,n.minThreshold=e.minThreshold||10,n.maxThreshold=e.maxThreshold||100,n.minDurationThreshold=e.minDurationThreshold||0,n.maxDurationThreshold=e.maxDurationThreshold||100,n.onStart=n.onStart.bind(Object(o.a)(n)),n.onMove=n.onMove.bind(Object(o.a)(n)),n.onEnd=n.onEnd.bind(Object(o.a)(n)),n.onScroll=n.onScroll.bind(Object(o.a)(n)),n.state={capturing:!1,start:{x:-1,y:-1}},n}return Object(c.a)(t,e),Object(r.a)(t,[{key:"onStart",value:function(e){if(!this.scrolling&&(e.clientX&&this.props.mouseMove||e.touches)){var t=0,n=0;e.clientX?(t=e.clientX,n=e.clientY):e.touches&&(t=e.touches[0].clientX,n=e.touches[0].clientY),this.setState({capturing:!0,start:{x:t,y:n},startTime:new Date,current:void 0,end:void 0})}}},{key:"onMove",value:function(e){if(this.state.capturing){var t=0,n=0;e.clientX?(t=e.clientX,n=e.clientY):e.touches&&(t=e.touches[0].clientX,n=e.touches[0].clientY),this.setState({current:{x:t,y:n}}),this.fireRunningEvents(this.calculateDirection(this.state.start,{x:t,y:n}),e)}}},{key:"onEnd",value:function(e){if(this.state.capturing&&this.state.start&&this.state.startTime){var t=0,n=0;e.clientX?(t=e.clientX,n=e.clientY):e.touches&&(t=e.changedTouches[0].clientX,n=e.changedTouches[0].clientY),this.setState({capturing:!1,end:{x:t,y:n},endTime:new Date}),this.fireFinishEvents(this.calculateDirection(this.state.start,{x:t,y:n}),(new Date).getTime()-this.state.startTime.getTime(),e)}}},{key:"onScroll",value:function(e){var t=this;this.scrolling=!0,this.scrollTimeout&&clearTimeout(this.scrollTimeout),this.scrollTimeout=setTimeout(function(){t.scrolling=!1},150)}},{key:"calculateDirection",value:function(e,t){var n=Math.abs(e.x-t.x),a=Math.abs(e.y-t.y);if(n>a){if(n>this.minThreshold&&n<this.maxThreshold)return e.x>t.x?"left":"right"}else if(a>this.minThreshold&&a<this.maxThreshold)return e.y>t.y?"up":"down";return""}},{key:"fireFinishEvents",value:function(e,t,n){if(t>this.minDurationThreshold&&t<this.maxDurationThreshold)switch(e){case"up":this.props.swipedUp&&this.props.swipedUp(n);break;case"right":this.props.swipedRight&&this.props.swipedRight(n);break;case"down":this.props.swipedDown&&this.props.swipedDown(n);break;case"left":this.props.swipedLeft&&this.props.swipedLeft(n)}}},{key:"fireRunningEvents",value:function(e,t){switch(e){case"up":this.props.swipingUp&&this.props.swipingUp(t);break;case"right":this.props.swipingRight&&this.props.swipingRight(t);break;case"down":this.props.swipingDown&&this.props.swipingDown(t);break;case"left":this.props.swipingLeft&&this.props.swipingLeft(t)}}},{key:"render",value:function(){return u.a.createElement("div",{onScroll:this.onScroll,onTouchStart:this.onStart,onTouchMove:this.onMove,onTouchEnd:this.onEnd,onMouseDown:this.onStart,onMouseMove:this.onMove,onMouseUp:this.onEnd,className:this.props.className},this.props.children)}}]),t}(l.Component),f=n(25),m=function(e){function t(){return Object(a.a)(this,t),Object(i.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e="navibar-open";return this.props.open||(e="navibar-collapsed"),this.props.user?u.a.createElement("div",{id:"header"},u.a.createElement("div",{id:"header-title",className:e},u.a.createElement("div",{id:"user"},this.props.user.displayName)),u.a.createElement("div",{id:"header-bars",onClick:this.props.onClick},u.a.createElement("span",null,u.a.createElement(f.a,{icon:"bars"})))):u.a.createElement("div",null)}}]),t}(l.Component),b=Object(p.c)(function(e){return{open:e.ui.navibar_open,user:e.data.user.data}},function(e){return{onClick:function(){e(d.a.toggleNavibar())}}})(m),v=n(284),y=n(70),g=n(291),E=function(e){function t(e){var n;return Object(a.a)(this,t),(n=Object(i.a)(this,Object(s.a)(t).call(this,e))).onMouseUp=n.onMouseUp.bind(Object(o.a)(n)),n.level=n.props.level||0,n}return Object(c.a)(t,e),Object(r.a)(t,[{key:"onMouseUp",value:function(e){0===this.level&&this.props.onClose&&this.props.onClose(),this.props.onMouseUp&&this.props.onMouseUp(e),y.a.mobile()&&this.props.toggleNavibar&&this.props.to&&this.props.toggleNavibar()}},{key:"renderLinkElement",value:function(e,t,n){return e.match(/^(http|https):\/\//)?u.a.createElement("a",{href:e,className:"navibar-element",onMouseUp:n,target:"_blank"},t):u.a.createElement(v.a,{exact:!0,to:e,className:"navibar-element",activeClassName:"navibar-element-active",onMouseUp:n},t)}},{key:"render",value:function(){var e,t=u.a.createElement("p",null);return this.props.leftIcon&&(e=u.a.createElement(f.a,{icon:this.props.leftIcon,className:"navibar-element-icon"})),this.props.rightIcon&&(t=u.a.createElement(f.a,{icon:this.props.rightIcon,className:"navibar-element-icon navibar-element-icon-right float-right"})),this.props.to?this.renderLinkElement(this.props.to,[u.a.createElement("li",{key:this.props.to},e,u.a.createElement("p",{className:"navibar-element-text"},this.props.text),t)],this.onMouseUp):u.a.createElement("li",{className:"navibar-element",onMouseUp:this.onMouseUp,key:this.props.text},e,u.a.createElement("p",{className:"navibar-element-text"},this.props.text),t)}}]),t}(l.Component),O=Object(g.a)(Object(p.c)(function(e){return{navibar_open:e.ui.navibar_open}},function(e){return{onClose:function(){e(d.a.collapseNavibarLevel())},toggleNavibar:function(){e(d.a.toggleNavibar())}}})(E));function k(e){return function(){var t,n=Object(s.a)(e);if(function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var a=Object(s.a)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return Object(i.a)(this,t)}}var C=function(e){Object(c.a)(n,e);var t=k(n);function n(e){var r;return Object(a.a)(this,n),(r=t.call(this,e)).onClick=r.onClick.bind(Object(o.a)(r)),r}return Object(r.a)(n,[{key:"onClick",value:function(e){this.props.open_level===this.props.id?this.props.onClose():this.props.onOpen(this.props.id)}},{key:"render",value:function(){var e=this,t="",n="angle-down";return this.props.id!==this.props.open_level&&(t=" level-collapsed",n="angle-left"),u.a.createElement("div",null,u.a.createElement(O,{leftIcon:this.props.leftIcon,rightIcon:n,text:this.props.text,onMouseUp:this.onClick}),u.a.createElement("div",{key:"levelContainer-"+this.props.id,className:"level-container level-"+this.props.level.toString()+t},l.Children.map(this.props.children,function(t){if(t)return Object(l.cloneElement)(t,{level:e.props.level})})))}}]),n}(l.Component),S=Object(p.c)(function(e){return{open_level:e.ui.navibar_level}},function(e){return{onOpen:function(t){e(d.a.openNavibarLevel(t))},onClose:function(){e(d.a.collapseNavibarLevel())}}})(C),j=n(12),N=n(21);function w(e){if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(!e)return;if("string"===typeof e)return x(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return x(e,t)}(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,r,o=!0,i=!1;return{s:function(){a=e[Symbol.iterator]()},n:function(){var e=a.next();return o=e.done,e},e:function(e){i=!0,r=e},f:function(){try{o||null==a.return||a.return()}finally{if(i)throw r}}}}function x(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function A(e){return function(){var t,n=Object(s.a)(e);if(function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var a=Object(s.a)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return Object(i.a)(this,t)}}var R=function(e){Object(c.a)(n,e);var t=A(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(r.a)(n,[{key:"renderElement",value:function(e,t){if(!t)return e;var n,a=w(t);try{for(a.s();!(n=a.n()).done;){var r=n.value;if(this.props.user&&(this.props.user.roles.includes(r)||this.props.user.roles.includes(j.a.ADMIN)))return e}}catch(o){a.e(o)}finally{a.f()}}},{key:"render",value:function(){var e="navibar-open";return this.props.open||(e="navibar-collapsed"),this.props.user?u.a.createElement("div",{id:"navibar",className:e},u.a.createElement("ol",null,this.renderElement(u.a.createElement(O,{to:"/dashboard",text:"Dashboard",leftIcon:"tachometer-alt"}),[j.a.AUTHENTICATED]),this.renderElement(u.a.createElement(O,{to:"/members",text:"Mitglieder",leftIcon:"users"}),[j.a.MEMBERS_READ]),this.renderElement(u.a.createElement(O,{to:"/mailing-lists",text:"Verteiler",leftIcon:"mail-bulk"}),[j.a.MEMBERS_READ]),this.renderElement(u.a.createElement(S,{text:"Aufgebot",leftIcon:"address-book",id:"draft",level:1},this.renderElement(u.a.createElement(O,{to:"/draft/collection-points",leftIcon:"map-marker-alt",text:"Abholpunkte"}),[j.a.DRAFT_READ]),this.renderElement(u.a.createElement(O,{to:"/draft/logoffs",leftIcon:"user-times",text:"Abmeldungen"}),[j.a.LOGOFFS_READ])),[j.a.DRAFT_READ,j.a.LOGOFFS_READ]),this.renderElement(u.a.createElement(O,{to:"/orders",text:"Auftr\xe4ge",leftIcon:"file-alt"}),[j.a.ORDERS_READ]),this.renderElement(u.a.createElement(S,{text:"Verrechnungsrapporte",leftIcon:"file-signature",id:"billingreports",level:1},this.renderElement(u.a.createElement(O,{to:"/billing-reports/add",leftIcon:"plus",text:"Erstellen"}),[j.a.BILLINGREPORTS_CREATE]),u.a.createElement(O,{to:"/billing-reports",leftIcon:"list",text:"Alle"}),u.a.createElement(O,{to:"https://vkazu.sharepoint.com/:w:/r/Vorlagen/Verrechungsrapport.docx?d=w66977fb79dfd4ab3832ca05fd6d9b8d2&csf=1&e=Spme13",text:"Word Vorlage",leftIcon:"file-word"})),[j.a.BILLINGREPORTS_READ,j.a.BILLINGREPORTS_CREATE]),this.renderElement(u.a.createElement(O,{to:"/compensations",leftIcon:"dollar-sign",text:"Entsch\xe4digungen"}),[j.a.COMPENSATIONS_READ]),this.renderElement(u.a.createElement(O,{to:"/payouts",text:"Auszahlungen",leftIcon:"file-invoice-dollar"}),[j.a.PAYOUTS_READ]),this.renderElement(u.a.createElement(O,{to:"/users",text:"Benutzer",leftIcon:"user"}),[j.a.ADMIN]),u.a.createElement(O,{to:"https://vkazu.sharepoint.com/Dokumente",text:"Dokumente",leftIcon:"external-link-alt"}),u.a.createElement(O,{to:"".concat(N.a.apiEndpoint,"/api/logout"),text:"Abmelden",leftIcon:"power-off"}))):u.a.createElement("div",null)}}]),n}(l.Component),T=Object(p.c)(function(e){return{open:e.ui.navibar_open,user:e.data.user.data}},{},null,{pure:!1})(R);var I=Object(p.c)(function(e){return{working:e.ui.working}})(function(e){return u.a.createElement("div",{id:"working_indicator",className:"nop"!==e.working?"show":"hide"},u.a.createElement("img",{src:"/webapp/gear.svg"}))});function D(e){return function(){var t,n=Object(s.a)(e);if(function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var a=Object(s.a)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return Object(i.a)(this,t)}}n.d(t,"a",function(){return L});var _=function(e){Object(c.a)(n,e);var t=D(n);function n(e){var r;return Object(a.a)(this,n),(r=t.call(this,e)).swipedRight=r.swipedRight.bind(Object(o.a)(r)),r.swipedLeft=r.swipedLeft.bind(Object(o.a)(r)),r}return Object(r.a)(n,[{key:"swipedRight",value:function(){this.props.openNavibar&&this.props.openNavibar()}},{key:"swipedLeft",value:function(){this.props.closeNavibar&&this.props.closeNavibar()}},{key:"render",value:function(){var e="navibar-open";return this.props.open||(e="navibar-collapsed"),u.a.createElement("div",{className:"body"},u.a.createElement(b,null),u.a.createElement(T,null),u.a.createElement(h,{className:e+" content",mouseMove:!0,swipedRight:this.swipedRight,swipedLeft:this.swipedLeft},u.a.createElement("div",{className:"content-top"},u.a.createElement("h1",{className:"page-title"},this.props.title)),u.a.createElement("div",{className:"content-body container-fluid"},this.props.children)),u.a.createElement(I,null))}}]),n}(l.Component),L=Object(p.c)(function(e){return{open:e.ui.navibar_open}},function(e){return{closeNavibar:function(){e(d.a.closeNavibar())},openNavibar:function(){e(d.a.openNavibar())}}})(_)},21:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var a=n(6),r=n(9),o=function(){function e(){Object(a.a)(this,e)}return Object(r.a)(e,null,[{key:"loadConfig",value:function(){e.apiEndpoint="".concat(window.location.protocol,"//").concat(window.location.host)}},{key:"isModeProduction",value:function(){return e.isMode("production")}},{key:"isModeDev",value:function(){return e.isMode("development")}},{key:"isMode",value:function(e){return"production".toLowerCase()===e.toLowerCase()}}]),e}()},22:function(e,t,n){"use strict";n.d(t,"a",function(){return u});var a=n(6),r=n(9),o=n(11),i=n(4),s=n(10),c=n(0),l=n.n(c),u=function(e){function t(){return Object(a.a)(this,t),Object(o.a)(this,Object(i.a)(t).apply(this,arguments))}return Object(s.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){return l.a.createElement("div",{className:"row "+this.props.className},this.props.children)}}]),t}(c.Component)},23:function(e,t,n){"use strict";n.d(t,"a",function(){return g});var a=n(3),r=n.n(a),o=n(14),i=n(6),s=n(9),c=n(5),l=n(11),u=n(4),p=n(10),d=n(0),h=n.n(d),f=n(281),m=n(25),b=n(12),v=n(15);function y(e){return function(){var t,n=Object(u.a)(e);if(function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var a=Object(u.a)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return Object(l.a)(this,t)}}var g=function(e){Object(p.a)(n,e);var t=y(n);function n(e){var a;return Object(i.a)(this,n),(a=t.call(this,e)).onClick=a.onClick.bind(Object(c.a)(a)),a.state={state:a.props.loading?"inProgress":"normal"},a}return Object(s.a)(n,[{key:"onClick",value:function(){var e=Object(o.a)(r.a.mark(function e(t){var n=this;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("normal"!==this.state.state){e.next=6;break}return this.setState({state:"inProgress"}),e.next=4,this.props.onClick(t);case 4:this.setState({state:"done"}),setTimeout(function(){n.setState({state:"normal"})},1e3);case 6:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;if(this.props.roles&&this.props.user&&!this.props.user.roles.some(function(t){return(e.props.roles||[]).concat([b.a.ADMIN]).includes(t)}))return null;switch(this.state.state){case"normal":return h.a.createElement(f.a,Object.assign({},this.props,{onClick:this.onClick}),this.props.children);case"inProgress":return h.a.createElement(f.a,Object.assign({},this.props,{onClick:this.onClick}),h.a.createElement("svg",{className:"button-loading",viewBox:"0 0 128 128"},h.a.createElement("g",null,h.a.createElement("path",{d:"M64 127.75A63.76 63.76 0 0 1 52.8 1.23v14.23a49.8 49.8 0 1 0 22.4 0V1.23A63.76 63.76 0 0 1 64 127.75z",fillOpacity:"1"}),h.a.createElement("animateTransform",{attributeName:"transform",type:"rotate",from:"0 64 64",to:"360 64 64",dur:"2160ms",repeatCount:"indefinite"}))));case"done":return h.a.createElement(f.a,Object.assign({},this.props,{onClick:this.onClick}),h.a.createElement(m.a,{icon:"check-circle"}));default:return h.a.createElement(f.a,Object.assign({},this.props,{onClick:this.onClick}),this.props.children)}}}],[{key:"getDerivedStateFromProps",value:function(e,t){return{state:e.loading?"inProgress":"normal"}}}]),n}(d.Component);Object(v.c)(function(e,t){return{user:e.data.user.data}})(g)},24:function(e,t,n){"use strict";n.d(t,"a",function(){return u});var a=n(6),r=n(9),o=n(11),i=n(4),s=n(10),c=n(0),l=n.n(c),u=function(e){function t(){return Object(a.a)(this,t),Object(o.a)(this,Object(i.a)(t).apply(this,arguments))}return Object(s.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){return l.a.createElement("div",{className:"loading-animation "+(this.props.fullscreen?"fullscreen":"")},l.a.createElement("div",{className:"sk-folding-cube"},l.a.createElement("div",{className:"sk-cube1 sk-cube"}),l.a.createElement("div",{className:"sk-cube2 sk-cube"}),l.a.createElement("div",{className:"sk-cube4 sk-cube"}),l.a.createElement("div",{className:"sk-cube3 sk-cube"})),this.props.children)}}]),t}(c.Component)},267:function(e,t){},268:function(e,t){},276:function(e,t,n){"use strict";n.r(t);var a=n(76),r=n(26),o=n(136);a.b.add(o.a,r.F,r.f,r.o,r.r,r.p,r.k,r.n,r.x,r.D,r.y,r.a,r.u,r.j,r.h,r.d,r.B,r.G,r.g,r.C,r.e,r.A,r.z,r.v,r.m,r.l,r.q,r.w,r.s,r.i,r.i,r.E,r.c,r.b,r.t);var i=n(0),s=n.n(i),c=n(36),l=n.n(c),u=n(6),p=n(9),d=n(11),h=n(4),f=n(10),m=n(15),b=n(64),v=n(40),y=n(17),g=n(77),E=n(70);var O=Object(v.combineReducers)({navibar_open:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:!E.a.mobile();switch((arguments.length>1?arguments[1]:void 0).type){case y.b.NAVIBAR_TOGGLE:return!e;case y.b.NAVIBAR_OPEN:return!0;case y.b.NAVIBAR_CLOSE:return!1;default:return e}},navibar_level:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;switch(t.type){case y.b.NAVIBAR_LEVEL_OPEN:return t.payload;case y.b.NAVIBAR_LEVEL_COLLAPSE:return"";default:return e}},notification:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case y.b.NOTIFICATION_SUCCESS:return g.toast.success(t.payload,{autoClose:2e3,position:E.a.mobile()?"bottom-center":"top-right"}),e;case y.b.NOTIFICATION_ERROR:return g.toast.error(t.payload,{autoClose:2e3,position:E.a.mobile()?"bottom-center":"top-right"}),e;default:return e}},working:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"dynamic",t=arguments.length>1?arguments[1]:void 0;switch(t.type){case y.b.WORKING:return t.payload;default:return e}}}),k=n(8);function C(e){if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(!e)return;if("string"===typeof e)return S(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return S(e,t)}(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,r,o=!0,i=!1;return{s:function(){a=e[Symbol.iterator]()},n:function(){var e=a.next();return o=e.done,e},e:function(e){i=!0,r=e},f:function(){try{o||null==a.return||a.return()}finally{if(i)throw r}}}}function S(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var j={ui:O,data:Object(v.combineReducers)({logoffs:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{loading:!1,byId:{},ids:[],sort:{keys:["from"],direction:"desc"}},t=arguments.length>1?arguments[1]:void 0,n={},a=[];switch(t.type){case k.b.FETCH_LOGOFFS:return Object.assign({},e,{loading:!0});case k.b.GOT_LOGOFFS:if(Object.keys(t.payload).length<1)return Object.assign({},e,{loading:!1});var r,o=C(t.payload);try{for(o.s();!(r=o.n()).done;){var i=r.value;n[i.id]=i,a.push(i.id)}}catch(s){o.e(s)}finally{o.f()}return Object.assign({},e,{loading:!1,byId:n,ids:a});case k.b.APPROVE_LOGOFF:return n=Object.assign({},e.byId,Object.assign({},e.byId[t.payload],{approved:!0})),Object.assign({},e,{byId:n});case k.b.DECLINE_LOGOFF:return Object.assign({},e,{ids:e.ids.filter(function(e){return e!==t.payload})});default:return e}},payouts:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{loading:!1,byId:{},ids:[],sort:{keys:["until"],direction:"desc"}},t=arguments.length>1?arguments[1]:void 0,n={},a=[];switch(t.type){case k.b.FETCH_PAYOUTS:return Object.assign({},e,{loading:!0});case k.b.GOT_PAYOUTS:if(Object.keys(t.payload).length<1)return Object.assign({},e,{loading:!1});var r,o=C(t.payload);try{var i=function(){var e=r.value,t={};for(var o in e.compensations){var i=e.compensations[o];i.hasOwnProperty("description")||i.hasOwnProperty("billingReport")&&i.billingReport&&i.billingReport.hasOwnProperty("order")&&(i=i.billingReport.order.hasOwnProperty("contact")&&!i.billingReport.order.contact.hasOwnProperty("firstname")?Object.assign(i,{description:"".concat(i.billingReport.order.title," (").concat(i.billingReport.order.contact.lastname,")")}):Object.assign(i,{description:"".concat(i.billingReport.order.title)})),e.compensations[o]=i,t.hasOwnProperty(i.member.id)||(t[i.member.id]=[]),t[i.member.id].push(i)}e.compensationsByMember=t,e.totalWithoutMinus=Object.keys(t).map(function(e){var n=0;return t[e].map(function(e){return n+=e.amount}),n>0?n:0}).reduce(function(e,t){return e+t},0),n[e.id]=e,a.push(e.id)};for(o.s();!(r=o.n()).done;)i()}catch(s){o.e(s)}finally{o.f()}return Object.assign({},e,{loading:!1,byId:n,ids:a});default:return e}},collectionPoints:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{loading:!1,byId:{},ids:[],sort:{keys:["city"],direction:"desc"}},t=arguments.length>1?arguments[1]:void 0,n={},a=[];switch(t.type){case k.b.FETCH_COLLECTION_POINTS:return Object.assign({},e,{loading:!0});case k.b.GOT_COLLECTION_POINTS:if(Object.keys(t.payload).length<1)return Object.assign({},e,{loading:!1});var r,o=C(t.payload);try{for(o.s();!(r=o.n()).done;){var i=r.value;n[i.id]=i,a.push(i.id)}}catch(s){o.e(s)}finally{o.f()}return Object.assign({},e,{loading:!1,byId:n,ids:a});default:return e}},user:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{loading:!1,data:void 0},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case k.b.FETCH_USER:return Object.assign({},e,{loading:!0});case k.b.GOT_USER:return Object.keys(t.payload).length>0?{loading:!1,data:t.payload}:{loading:!1,data:void 0};case y.b.LOGOUT:return{loading:!1,data:void 0};default:return e}},users:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{loading:!1,byId:{},ids:[],sort:{keys:["displayName"],direction:"asc"}},t=arguments.length>1?arguments[1]:void 0,n={},a=[];switch(t.type){case k.b.FETCH_USERS:return Object.assign({},e,{loading:!0});case k.b.GOT_USERS:if(Object.keys(t.payload).length<1)return Object.assign({},e,{loading:!1});var r,o=C(t.payload);try{for(o.s();!(r=o.n()).done;){var i=r.value;n[i.id]=i,a.push(i.id)}}catch(s){o.e(s)}finally{o.f()}return Object.assign({},e,{loading:!1,byId:n,ids:a});default:return e}},contacts:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{loading:!1,byId:{},ids:[],sort:{keys:["lastname","firstname"],direction:"asc"}},t=arguments.length>1?arguments[1]:void 0,n={},a=[];switch(t.type){case k.b.FETCH_CONTACTS:return Object.assign({},e,{loading:!0});case k.b.GOT_CONTACTS:if(Object.keys(t.payload).length<1)return Object.assign({},e,{loading:!1});var r,o=C(t.payload);try{for(o.s();!(r=o.n()).done;){var i=r.value;n[i.id]=i,a.push(i.id)}}catch(s){o.e(s)}finally{o.f()}return Object.assign({},e,{loading:!1,byId:n,ids:a});default:return e}},members:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{loading:!1,byId:{},ids:[],sort:{keys:["lastname","firstname"],direction:"asc"}},t=arguments.length>1?arguments[1]:void 0,n={},a=[];switch(t.type){case k.b.FETCH_MEMBERS:return Object.assign({},e,{loading:!0});case k.b.GOT_MEMBERS:if(Object.keys(t.payload).length<1)return Object.assign({},e,{loading:!1});var r,o=C(t.payload);try{for(o.s();!(r=o.n()).done;){var i=r.value;n[i.id]=i,a.push(i.id)}}catch(s){o.e(s)}finally{o.f()}return Object.assign({},e,{loading:!1,byId:n,ids:a});default:return e}},ranks:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{loading:!1,byId:{},ids:[],sort:{keys:["name"],direction:"asc"}},t=arguments.length>1?arguments[1]:void 0,n={},a=[];switch(t.type){case k.b.FETCH_RANKS:return Object.assign({},e,{loading:!0});case k.b.GOT_RANKS:if(Object.keys(t.payload).length<1)return Object.assign({},e,{loading:!1});var r,o=C(t.payload);try{for(o.s();!(r=o.n()).done;){var i=r.value;n[i.id]=i,a.push(i.id)}}catch(s){o.e(s)}finally{o.f()}return Object.assign({},e,{loading:!1,byId:n,ids:a});default:return e}},orders:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{loading:!1,byId:{},ids:[],sort:{keys:["documentNr"],direction:"desc"}},t=arguments.length>1?arguments[1]:void 0,n={},a=[];switch(t.type){case k.b.FETCH_ORDERS:return Object.assign({},e,{loading:!0});case k.b.GOT_ORDERS:if(Object.keys(t.payload).length<1)return Object.assign({},e,{loading:!1});var r,o=C(t.payload);try{for(o.s();!(r=o.n()).done;){var i=r.value;n[i.id]=i,a.push(i.id)}}catch(s){o.e(s)}finally{o.f()}return Object.assign({},e,{loading:!1,byId:n,ids:a});default:return e}},openOrders:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{loading:!1,byId:{},ids:[],sort:{keys:["title"],direction:"desc"}},t=arguments.length>1?arguments[1]:void 0,n={},a=[];switch(t.type){case k.b.FETCH_OPEN_ORDERS:return Object.assign({},e,{loading:!0});case k.b.GOT_OPEN_ORDERS:if(Object.keys(t.payload).length<1)return Object.assign({},e,{loading:!1});var r,o=C(t.payload);try{for(o.s();!(r=o.n()).done;){var i=r.value;n[i.id]=i,a.push(i.id)}}catch(s){o.e(s)}finally{o.f()}return Object.assign({},e,{loading:!1,byId:n,ids:a});default:return e}},billingReports:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{loading:!1,byId:{},ids:[],sort:{keys:["date"],direction:"desc"}},t=arguments.length>1?arguments[1]:void 0,n={},a=[];switch(t.type){case k.b.FETCH_BILLING_REPORTS:return Object.assign({},e,{loading:!0});case k.b.GOT_BILLING_REPORTS:if(Object.keys(t.payload).length<1)return Object.assign({},e,{loading:!1});var r,o=C(t.payload);try{for(o.s();!(r=o.n()).done;){var i=r.value;n[i.id]=i,a.push(i.id)}}catch(s){o.e(s)}finally{o.f()}return Object.assign({},e,{loading:!1,byId:n,ids:a});case k.b.APPROVE_BILLING_REPORT:return n=Object.assign({},e.byId,Object.assign({},e.byId[t.payload],{status:"approved"})),Object.assign({},e,{byId:n});default:return e}},compensationEntries:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{loading:!1,byId:{},ids:[],sort:{keys:["date"],direction:"desc"}},t=arguments.length>1?arguments[1]:void 0,n={},a=[];switch(t.type){case k.b.FETCH_COMPENSATION_ENTRIES:return Object.assign({},e,{loading:!0});case k.b.GOT_COMPENSATION_ENTRIES:if(Object.keys(t.payload).length<1)return Object.assign({},e,{loading:!1});var r,o=C(t.payload);try{for(o.s();!(r=o.n()).done;){var i=r.value;n[i.id]=i,a.push(i.id),i.hasOwnProperty("description")||i.billingReport&&i.billingReport.order&&(i.billingReport.order.contact&&!i.billingReport.order.contact.firstname?n[i.id]=Object.assign(n[i.id],{description:"".concat(i.billingReport.order.title," (").concat(i.billingReport.order.contact.lastname,")")}):n[i.id]=Object.assign(n[i.id],{description:"".concat(i.billingReport.order.title)}))}}catch(s){o.e(s)}finally{o.f()}return Object.assign({},e,{loading:!1,byId:n,ids:a});case k.b.APPROVE_COMPENSATION_ENTRY:return n=Object.assign({},e.byId,Object.assign({},e.byId[t.payload],{status:"approved"})),Object.assign({},e,{byId:n});case k.b.DELETE_COMPENSATION_ENTRY:return Object.assign({},e,{ids:e.ids.filter(function(e){return e!==t.payload})});default:return e}},mailingLists:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case k.b.GOT_MEMBERS:var n,a={all:[],drivers:[],vks:[],squad:[],vst:[],con:[]},r=C(t.payload);try{for(r.s();!(n=r.n()).done;){var o=n.value;a.all.push(o.mail),o.mailSecond&&a.all.push(o.mailSecond),a.all=a.all.concat(o.moreMails||[]),o.contactGroups.find(function(e){return 9===e.bexioId})&&(a.drivers.push(o.mail),o.mailSecond&&a.drivers.push(o.mailSecond),a.drivers=a.drivers.concat(o.moreMails||[])),o.contactGroups.find(function(e){return 17===e.bexioId||13===e.bexioId||11===e.bexioId||12===e.bexioId||28===e.bexioId||29===e.bexioId||15===e.bexioId||27===e.bexioId||26===e.bexioId||10===e.bexioId||14===e.bexioId})&&(a.vks.push(o.mail),o.mailSecond&&a.vks.push(o.mailSecond),a.vks=a.vks.concat(o.moreMails||[])),o.contactGroups.find(function(e){return 13===e.bexioId||12===e.bexioId||28===e.bexioId||29===e.bexioId||15===e.bexioId||14===e.bexioId})&&(a.squad.push(o.mail),o.mailSecond&&a.squad.push(o.mailSecond),a.squad=a.squad.concat(o.moreMails||[])),o.contactGroups.find(function(e){return 16===e.bexioId})&&(a.vst.push(o.mail),o.mailSecond&&a.vst.push(o.mailSecond),a.vst=a.vst.concat(o.moreMails||[])),o.contactGroups.find(function(e){return 22===e.bexioId})&&(a.con.push(o.mail),o.mailSecond&&a.con.push(o.mailSecond),a.con=a.con.concat(o.moreMails||[]))}}catch(i){r.e(i)}finally{r.f()}return a;default:return e}}})},N=n(138),w=n(75),x=n(103),A=n(139),R=n(118),T=n(140),I={key:"root",storage:n.n(T).a,blacklist:["router"]};function D(e){var t=Object(R.a)(I,Object(v.combineReducers)(Object(b.a)({},j,{router:Object(w.b)(e)}))),n=Object(v.createStore)(t,Object(A.composeWithDevTools)(Object(v.applyMiddleware)(N.a,Object(x.a)(e))));return n.subscribe(function(e){return function(){var t=e.getState(),n=Object.keys(t.data).find(function(e){return!0===t.data[e].loading}),a=n?"dynamic":"nop";"fixed"!==t.ui.working&&t.ui.working!==a&&e.dispatch(y.a.setWorking(a))}}(n)),{store:n,persistor:Object(R.b)(n)}}var _=n(290),L=n(141),M=n(289),P=n(12),F=n(20),B=function(e){function t(){return Object(u.a)(this,t),Object(d.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){return s.a.createElement(F.a,{title:""},s.a.createElement("div",{className:"gandalf"},s.a.createElement("div",{className:"fireball"}),s.a.createElement("div",{className:"skirt"}),s.a.createElement("div",{className:"sleeves"}),s.a.createElement("div",{className:"shoulders"},s.a.createElement("div",{className:"hand left"}),s.a.createElement("div",{className:"hand right"})),s.a.createElement("div",{className:"head"},s.a.createElement("div",{className:"hair"}),s.a.createElement("div",{className:"beard"}))),s.a.createElement("div",{className:"message"},s.a.createElement("h1",null,"403 - You Shall Not Pass"),s.a.createElement("p",null,"Uh oh, Gandalf is blocking the way!",s.a.createElement("br",null),"Maybe you have a typo in the url? Or you meant to go to a different location? Like...Hobbiton?")))}}]),t}(i.Component),G=function(e){function t(){return Object(u.a)(this,t),Object(d.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this,t=!0,n=!1,a=void 0;try{for(var r,o=this.props.roles[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){var i=r.value;if(this.props.user&&(this.props.user.roles.includes(i)||this.props.user.roles.includes(P.a.ADMIN)))return s.a.createElement(L.a,{exact:this.props.exact,path:this.props.path,component:this.props.component})}}catch(c){n=!0,a=c}finally{try{t||null==o.return||o.return()}finally{if(n)throw a}}return this.props.user&&this.props.showError?(this.props.showError("Not Authorized!"),s.a.createElement(L.a,{exact:this.props.exact,path:this.props.path,component:B})):s.a.createElement(L.a,{exact:this.props.exact,path:this.props.path,component:function(){return s.a.createElement(M.a,{push:!0,to:{pathname:"/login",state:{prevLocation:(e.props.location||{pathname:""}).pathname}}})}})}}]),t}(i.Component),V=Object(m.c)(function(e){return{user:e.data.user.data}},function(e){return{showError:function(t){e(y.a.showError(t))}}})(G),U=n(21),H=n(60),z=n(144),q=n(24),K=(n(199),n(201),n(18)),Y=n(16),W=n(22),X=n(142),J=n(5),Z=n(33),$=n(281),Q=n(25),ee=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(d.a)(this,Object(h.a)(t).call(this,e))).compensationView=n.compensationView.bind(Object(J.a)(n)),n.state={openCompensationsSum:0,compensations:[]},n}return Object(f.a)(t,e),Object(p.a)(t,[{key:"getContactCompensations",value:function(){var e=this;if(this.props.compensations.ids.length<=0)return[];var t=[];return this.props.compensations.ids.forEach(function(n){var a=e.props.compensations.byId[n];a.member.id===e.props.contact.id&&a.approved&&t.push(a)}),t}},{key:"compensationView",value:function(e){if(e.currentTarget.parentNode&&e.currentTarget.parentNode.parentNode&&e.currentTarget.parentNode.parentNode.parentElement){var t=e.currentTarget.parentNode.parentNode.parentElement.getAttribute("data-key");1==e.button?window.open(document.location.origin+"/compensation/"+t):this.props.history.push("/compensation/"+t)}}},{key:"componentDidMount",value:function(){this.props.fetchData();var e=this.getContactCompensations();this.setState({openCompensationsSum:e.filter(function(e){return!e.paied}).reduce(function(e,t){return e+t.amount},0),compensations:e})}},{key:"componentDidUpdate",value:function(e){if(this.props.compensations.ids.length>0&&!1===this.props.loading&&e.compensations.ids.length!==this.props.compensations.ids.length){var t=this.getContactCompensations();this.setState({openCompensationsSum:t.filter(function(e){return!e.paied}).reduce(function(e,t){return e+t.amount},0),compensations:t})}}},{key:"render",value:function(){var e=[s.a.createElement($.a,{variant:"success",className:"view",onMouseUp:this.compensationView},s.a.createElement(Q.a,{icon:"eye"}))];return this.props.user.roles.indexOf(P.a.COMPENSATIONS_READ)<0&&this.props.user.roles.indexOf(P.a.ADMIN)<0&&(this.props.user.bexioContact||{id:void 0}).id!==this.props.contact.id?null:this.props.loading?s.a.createElement(K.a,{title:"Entsch\xe4digungen"},s.a.createElement(q.a,null)):s.a.createElement(K.a,{title:"Entsch\xe4digungen (Offen: ".concat(this.state.openCompensationsSum.toFixed(2),".-)"),scrollable:!0},s.a.createElement(Z.a,{columns:[{text:"Datum",keys:["date"],sortable:!0,format:"toLocaleDateString"},{text:"Beschreibung",keys:["description"],sortable:!0},{text:"Betrag",keys:["amount"],prefix:"CHF ",sortable:!0,format:"toFixed(2)"},{text:"Genehmigt",keys:["approved"],sortable:!0},{text:"Ausbezahlt",keys:["paied"],sortable:!0},{text:"Actions",keys:["_id"],content:s.a.createElement("div",{className:"btn-group"},e)}],defaultSort:{keys:["date"],direction:"desc"},data:this.state.compensations}))}}]),t}(i.Component),te=Object(m.c)(function(e,t){return{user:e.data.user.data,loading:e.data.contacts.loading||e.data.members.loading||e.data.compensationEntries.loading,compensations:e.data.compensationEntries}},function(e){return{fetchData:function(){return e(k.a.fetchCompensationEntries())}}})(ee),ne=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(d.a)(this,Object(h.a)(t).call(this,e))).logoffView=n.logoffView.bind(Object(J.a)(n)),n.state={logoffs:[]},n}return Object(f.a)(t,e),Object(p.a)(t,[{key:"getContactLogoffs",value:function(){var e=this;if(this.props.logoffs.ids.length<=0)this.setState({logoffs:[]});else{var t=[];this.props.logoffs.ids.forEach(function(n){var a=e.props.logoffs.byId[n];a.contact.id===e.props.contact.id&&t.push(a)}),this.setState({logoffs:t})}}},{key:"logoffView",value:function(e){if(e.currentTarget.parentNode&&e.currentTarget.parentNode.parentNode&&e.currentTarget.parentNode.parentNode.parentElement){var t=e.currentTarget.parentNode.parentNode.parentElement.getAttribute("data-key");1==e.button?window.open(document.location.origin+"/draft/logoff/"+t):this.props.history.push("/draft/logoff/"+t)}}},{key:"componentDidMount",value:function(){this.props.fetchData(),this.getContactLogoffs()}},{key:"componentDidUpdate",value:function(e){this.props.logoffs.ids.length>0&&!1===this.props.loading&&e.logoffs.ids.length!==this.props.logoffs.ids.length&&this.getContactLogoffs()}},{key:"render",value:function(){var e=[s.a.createElement($.a,{variant:"success",className:"view",onMouseUp:this.logoffView},s.a.createElement(Q.a,{icon:"eye"}))];return this.props.user.roles.indexOf(P.a.LOGOFFS_READ)<0&&this.props.user.roles.indexOf(P.a.ADMIN)<0&&(this.props.user.bexioContact||{id:void 0}).id!==this.props.contact.id?null:this.props.loading?s.a.createElement(K.a,{title:"Abmeldungen"},s.a.createElement(q.a,null)):s.a.createElement(K.a,{title:"Abmeldungen",scrollable:!0},s.a.createElement(Z.a,{columns:[{text:"Von",keys:["from"],sortable:!0,format:"toLocaleString"},{text:"Bis",keys:["until"],sortable:!0,format:"toLocaleString"},{text:"Status",keys:["state"],sortable:!0},{text:"Actions",keys:["_id"],content:s.a.createElement("div",{className:"btn-group"},e)}],defaultSort:{keys:["from"],direction:"desc"},data:this.state.logoffs}))}}]),t}(i.Component),ae=Object(m.c)(function(e,t){return{user:e.data.user.data,loading:e.data.contacts.loading||e.data.members.loading||e.data.logoffs.loading,logoffs:e.data.logoffs}},function(e){return{fetchData:function(){return e(k.a.fetchLogoffs())}}})(ne),re=function(e){function t(){return Object(u.a)(this,t),Object(d.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){this.props.fetchUser()}},{key:"renderShortcuts",value:function(){var e=[];return this.props.user.roles.indexOf(P.a.BILLINGREPORTS_CREATE)>-1&&e.push(s.a.createElement(X.a,{key:"billingreport",to:"/billing-reports/add/",className:"btn btn-block btn-outline-primary"},"Verrechnungsrapport erstellen")),this.props.user.bexioContact&&e.push(s.a.createElement(X.a,{key:"profile",to:"/contact/".concat(this.props.user.bexioContact.id),className:"btn btn-block btn-outline-primary"},"Mein Profil")),e}},{key:"renderCompensations",value:function(){if(this.props.user.bexioContact)return s.a.createElement(Y.a,{className:"col-md-6"},s.a.createElement(te,Object.assign({contact:this.props.user.bexioContact},this.props)))}},{key:"renderLogoffs",value:function(){if(this.props.user.bexioContact)return s.a.createElement(Y.a,{className:"col-md-6"},s.a.createElement(ae,Object.assign({contact:this.props.user.bexioContact},this.props)))}},{key:"render",value:function(){return this.props.loading||!this.props.user?s.a.createElement(F.a,{title:"Dashboard"},s.a.createElement(q.a,null)):s.a.createElement(F.a,{title:"Dashboard"},s.a.createElement(W.a,null,s.a.createElement(Y.a,{className:"col-md-6"},s.a.createElement(K.a,{title:"Shortcuts"},this.renderShortcuts())),this.renderCompensations()),s.a.createElement(W.a,null,this.renderLogoffs()))}}]),t}(i.Component),oe=Object(m.c)(function(e,t){return{user:e.data.user.data,loading:e.data.user.loading}},function(e,t){return{fetchUser:function(){e(k.a.fetchUser())}}})(re),ie=n(45),se=n(3),ce=n.n(se),le=n(14),ue=n(38),pe=n(23);function de(e){return function(){var t,n=Object(h.a)(e);if(function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var a=Object(h.a)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return Object(d.a)(this,t)}}var he=function(e){Object(f.a)(n,e);var t=de(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).onClick=a.onClick.bind(Object(J.a)(a)),a}return Object(p.a)(n,[{key:"onClick",value:function(){var e=Object(le.a)(ce.a.mark(function e(t){return ce.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),!this.props.onClick){e.next=4;break}return e.next=4,this.props.onClick(t);case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){return this.props.to&&!this.props.disabled?s.a.createElement(X.a,{to:{pathname:this.props.to,state:this.props.state||{}},className:"action-button btn btn-outline-dark"},s.a.createElement(Q.a,{icon:this.props.icon})):s.a.createElement(pe.a,{onClick:this.onClick,variant:"outline-dark",className:"action-button",disabled:this.props.disabled||!1,loading:this.props.loading||!1,roles:this.props.roles},s.a.createElement(Q.a,{icon:this.props.icon}))}}]),n}(i.Component),fe=n(48),me=n.n(fe),be=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(d.a)(this,Object(h.a)(t).call(this,e))).excelExport=n.excelExport.bind(Object(J.a)(n)),n.state={filters:[]},n}return Object(f.a)(t,e),Object(p.a)(t,[{key:"componentDidUpdate",value:function(e){var t=this;if(e!==this.props&&!this.props.ranks.loading&&this.props.ranks.ids){var n=this.props.ranks.ids.map(function(e){return{id:t.props.ranks.byId[e].id.toString(),displayName:t.props.ranks.byId[e].name,filters:[{type:"eq",value:t.props.ranks.byId[e].name,key:"rank"}]}});this.setState({filters:n})}}},{key:"excelExport",value:function(){var e=Object(le.a)(ce.a.mark(function e(t){var n,a,r,o,i,s;return ce.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(a in n=[],this.props.data.byId)r=this.props.data.byId[a],o={Nachname:r.lastname,Vorname:r.firstname,Rang:r.rank||"",Funktionen:(r.functions||[]).join(","),Geburtstag:r.birthday,Adresse:"".concat(r.address,", ").concat(r.postcode," ").concat(r.city),Abholpunkt:"","E-Mail":r.mail,"E-Mail 2":r.mailSecond,Festnetz:r.phoneFixed,Mobile:r.phoneMobile},r.collectionPoint&&(o.Abholpunkt="(".concat(r.collectionPoint.name,") ").concat(r.collectionPoint.address,", ").concat(r.collectionPoint.postcode," ").concat(r.collectionPoint.city)),n.push(o);i=me.a.utils.json_to_sheet(n),s=me.a.utils.book_new(),me.a.utils.book_append_sheet(s,i,"Mitglieder"),me.a.writeFile(s,"Mitglieder.xlsx");case 6:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){return s.a.createElement(ue.a,{title:"Mitglieder",viewLocation:"/contact/",data:Object(b.a)({},this.props.data,{loading:this.props.data.loading&&this.props.ranks.loading}),fetchData:this.props.fetchData,history:this.props.history,tableColumns:[{text:"Name",keys:["lastname","firstname"],sortable:!0,searchable:!0},{text:"Grad",keys:["rank"],sortable:!0,searchable:!0},{text:"Funktionen",keys:["functions"],sortable:!0,searchable:!0},{text:"Addresse",keys:["address","postcode","city"],link:!0,linkPrefix:"https://www.google.com/maps/search/",sortable:!0,searchable:!0},{text:"Abholpunkt",keys:{collectionPoint:["address","postcode","city"]},link:!0,linkPrefix:"https://www.google.com/maps/search/",sortable:!0,searchable:!0},{text:"Festnetz",keys:["phoneFixed"],link:!0,linkPrefix:"tel:",sortable:!0,searchable:!0},{text:"Festnetz 2",keys:["phoneFixedSecond"],link:!0,linkPrefix:"tel:",sortable:!0,searchable:!0},{text:"Mobile",keys:["phoneMobile"],link:!0,linkPrefix:"tel:",sortable:!0,searchable:!0},{text:"E-Mail",keys:["mail"],link:!0,linkPrefix:"mailto:",sortable:!0,searchable:!0},{text:"E-Mail 2",keys:["mailSecond"],link:!0,linkPrefix:"mailto:",sortable:!0,searchable:!0}],panelActions:[s.a.createElement(he,{key:"excel-export",icon:"file-excel",onClick:this.excelExport}),s.a.createElement(he,{key:"pdf-export",onClick:this.props.memberlistPdf,icon:"file-pdf"})],defaultFilter:"all",filters:[{id:"all",displayName:"Alle",filters:[{type:"any"}]}].concat(Object(ie.a)(this.state.filters))})}}]),t}(i.Component),ve=Object(m.c)(function(e){return{data:e.data.members,ranks:e.data.ranks}},function(e){return{fetchData:function(){e(k.a.fetchRanks()),e(k.a.fetchMembers())},memberlistPdf:function(){var e=Object(le.a)(ce.a.mark(function e(){return ce.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:window.open("".concat(U.a.apiEndpoint,"/api/members/pdf"));case 1:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}()}})(be),ye=n(30),ge=n(51),Ee=function(e){function t(){return Object(u.a)(this,t),Object(d.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(p.a)(t,[{key:"renderChildren",value:function(){return"undefined"!==typeof this.props.value?s.a.createElement(ge.a,{name:this.props.id,editable:this.props.editable,onChange:this.props.onChange,type:this.props.type,value:this.props.value}):this.props.children}},{key:"render",value:function(){return s.a.createElement(W.a,null,s.a.createElement(Y.a,{className:"col-6"},this.props.title),s.a.createElement(Y.a,{className:"col-6"},this.renderChildren()))}}]),t}(i.Component),Oe=function e(){Object(u.a)(this,e)},ke=function(e){function t(){return Object(u.a)(this,t),Object(d.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(f.a)(t,e),t}(Oe),Ce=n(59),Se=function(e){function t(e){var n;if(Object(u.a)(this,t),(n=Object(d.a)(this,Object(h.a)(t).call(this,e))).props.defaultValue instanceof Array){var a=[],r=!0,o=!1,i=void 0;try{for(var s,c=n.props.defaultValue[Symbol.iterator]();!(r=(s=c.next()).done);r=!0){var l=s.value;l&&Object.keys(l).length>0&&a.push({value:l.id.toString(),label:"(".concat(l.name,") ").concat(l.address,", ").concat(l.postcode," ").concat(l.city)})}}catch(p){o=!0,i=p}finally{try{r||null==c.return||c.return()}finally{if(o)throw i}}n.state={value:a}}else n.state={};return n}return Object(f.a)(t,e),Object(p.a)(t,[{key:"componentDidUpdate",value:function(){if(this.props.defaultValue instanceof Array){var e=[],t=!0,n=!1,a=void 0;try{for(var r,o=this.props.defaultValue[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){var i=r.value;i&&Object.keys(i).length>0&&e.push({value:i.id.toString(),label:"(".concat(i.name,") ").concat(i.address,", ").concat(i.postcode," ").concat(i.city)})}}catch(s){n=!0,a=s}finally{try{t||null==o.return||o.return()}finally{if(n)throw a}}JSON.stringify(this.state.value)!==JSON.stringify(e)&&this.setState({value:e})}}},{key:"componentWillMount",value:function(){this.props.collectionPoints.ids.length<1&&this.props.fetchCollectionPoints()}},{key:"prepareOptions",value:function(){var e=[];if(Object.keys(this.props.collectionPoints.byId).length>0)for(var t in this.props.collectionPoints.byId){var n=this.props.collectionPoints.byId[t];e.push({label:"(".concat(n.name,") ").concat(n.address,", ").concat(n.postcode," ").concat(n.city),value:t})}return e}},{key:"onChange",value:function(e){var t=[e];this.props.isMulti&&(t=e),this.setState({value:t});var n=[],a=!0,r=!1,o=void 0;try{for(var i,s=t[Symbol.iterator]();!(a=(i=s.next()).done);a=!0){var c=i.value;c&&n.push(this.props.collectionPoints.byId[c.value])}}catch(l){r=!0,o=l}finally{try{a||null==s.return||s.return()}finally{if(r)throw o}}this.props.onChange&&(this.props.isMulti?this.props.onChange(n):this.props.onChange(n[0]))}},{key:"prepareValue",value:function(){return this.props.isMulti?this.state.value||[]:(this.state.value||[])[0]}},{key:"render",value:function(){var e=this;return this.props.loading?null:s.a.createElement(Ce.a,{ref:function(t){e.props.ref&&e.props.ref(t)},isClearable:!0,options:this.prepareOptions(),backspaceRemovesValue:!0,hideSelectedOptions:!0,openMenuOnFocus:!0,isMulti:this.props.isMulti||!1,onChange:this.onChange.bind(this),value:this.prepareValue()})}}]),t}(i.Component),je=Object(m.c)(function(e,t){return{collectionPoints:e.data.collectionPoints,loading:e.data.collectionPoints.loading}},function(e,t){return{fetchCollectionPoints:function(){e(k.a.fetchCollectionPoints())}}})(Se);function Ne(e){return function(){var t,n=Object(h.a)(e);if(function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var a=Object(h.a)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return Object(d.a)(this,t)}}var we=function(e){Object(f.a)(n,e);var t=Ne(n);function n(e){var a;Object(u.a)(this,n),(a=t.call(this,e)).groups=[],a.props.contact||a.props.loading||a.props.loadContacts(),a.onInputChange=a.onInputChange.bind(Object(J.a)(a)),a.onSave=a.onSave.bind(Object(J.a)(a)),a.onAbort=a.onAbort.bind(Object(J.a)(a)),a.onSelectChange=a.onSelectChange.bind(Object(J.a)(a)),a.renderCollectionPoint=a.renderCollectionPoint.bind(Object(J.a)(a)),a.renderPanelActions=a.renderPanelActions.bind(Object(J.a)(a)),a.onMoreMailsChange=a.onMoreMailsChange.bind(Object(J.a)(a));var r=a.props.contact||{};return a.state={editable:!1,collectionPoint:r.collectionPoint||new ke,entryDate:r.entryDate?r.entryDate:void 0,exitDate:r.exitDate?r.exitDate:void 0,bankName:r.bankName||"",iban:r.iban||"",accountHolder:r.accountHolder||"",moreMails:r.moreMails||[]},a}return Object(p.a)(n,[{key:"onInputChange",value:function(e,t){this.setState(Object(ye.a)({},e,t))}},{key:"onMoreMailsChange",value:function(e){var t=e.target,n=t.value,a=t.name;this.setState({moreMails:Object.assign([],this.state.moreMails,Object(ye.a)({},a,n))})}},{key:"removeMoreMailEntry",value:function(e){this.setState({moreMails:[].concat(Object(ie.a)(this.state.moreMails.slice(0,e)),Object(ie.a)(this.state.moreMails.slice(e+1)))})}},{key:"componentDidUpdate",value:function(e){this.props.contact&&!e.contact&&this.setState({collectionPoint:this.props.contact.collectionPoint||new ke,entryDate:this.props.contact.entryDate?this.props.contact.entryDate:void 0,exitDate:this.props.contact.exitDate?this.props.contact.exitDate:void 0,bankName:this.props.contact.bankName||"",iban:this.props.contact.iban||"",accountHolder:this.props.contact.accountHolder||"",moreMails:this.props.contact.moreMails||[]})}},{key:"onSave",value:function(){var e=Object(le.a)(ce.a.mark(function e(){return ce.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.props.contact.contactGroups.find(function(e){return 7===e.bexioId})){e.next=4;break}return e.next=3,this.props.editMember({id:this.props.contact.id,collectionPointId:(this.state.collectionPoint||{id:void 0}).id,entryDate:this.state.entryDate?new Date(this.state.entryDate):"",exitDate:this.state.exitDate?new Date(this.state.exitDate):"",bankName:this.state.bankName,iban:this.state.iban,accountHolder:this.state.accountHolder,moreMails:this.state.moreMails.filter(function(e){return""!==e})});case 3:this.setState({editable:!1});case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"onAbort",value:function(){var e=Object(le.a)(ce.a.mark(function e(t){return ce.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.setState({editable:!1,collectionPoint:this.props.contact.collectionPoint||new ke,entryDate:this.props.contact.entryDate?this.props.contact.entryDate:void 0,exitDate:this.props.contact.exitDate?this.props.contact.exitDate:void 0,bankName:this.props.contact.bankName||"",iban:this.props.contact.iban||"",accountHolder:this.props.contact.accountHolder||"",moreMails:this.props.contact.moreMails||[]});case 1:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"onSelectChange",value:function(e){var t=this;return function(n){t.setState(Object(ye.a)({},e,n))}}},{key:"renderCollectionPoint",value:function(){return this.state.editable?s.a.createElement(je,{multi:!1,onChange:this.onSelectChange("collectionPoint"),defaultValue:[this.state.collectionPoint]||void 0}):this.state.collectionPoint&&this.state.collectionPoint.hasOwnProperty("address")&&this.state.collectionPoint.hasOwnProperty("postcode")&&this.state.collectionPoint.hasOwnProperty("city")?s.a.createElement("a",{href:"https://www.google.com/maps/search/".concat(this.state.collectionPoint.address,", ").concat(this.state.collectionPoint.postcode," ").concat(this.state.collectionPoint.city),target:"_blank"},"".concat(this.state.collectionPoint.address,", ").concat(this.state.collectionPoint.postcode," ").concat(this.state.collectionPoint.city)):null}},{key:"renderPanelActions",value:function(){var e=this;return this.state.editable?[s.a.createElement(he,{icon:"save",key:"save",onClick:this.onSave}),s.a.createElement(he,{icon:"times",key:"cancel",onClick:this.onAbort})]:[s.a.createElement(he,{icon:"pencil-alt",key:"edit",onClick:Object(le.a)(ce.a.mark(function t(){return ce.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e.setState({editable:!0});case 1:case"end":return t.stop()}},t)})),roles:[P.a.CONTACTS_EDIT,P.a.MEMBERS_EDIT]})]}},{key:"renderActions",value:function(){var e=[],t=!!this.props.user.roles.indexOf(P.a.ADMIN);return(this.props.user.roles.indexOf(P.a.CONTACTS_READ)>-1||t)&&e.push(s.a.createElement("a",{target:"_blank",href:"https://office.bexio.com/index.php/kontakt/show/id/"+this.props.contact.bexioId,className:"btn btn-block btn-outline-primary"},"In Bexio anschauen")),(this.props.user.roles.indexOf(P.a.MEMBERS_READ)>-1||t)&&e.push(s.a.createElement("a",{target:"_blank",href:"https://vkazu.sharepoint.com/leitung/Personalakten?viewpath=/leitung/Personalakten&id=/leitung/Personalakten/"+this.props.contact.firstname+" "+this.props.contact.lastname,className:"btn btn-block btn-outline-primary"},"Personalakte \xf6ffnen")),e.length>0?s.a.createElement(K.a,{title:"Actions"},e):null}},{key:"render",value:function(){var e=this;if(parseInt(this.props.match.params.id)!==(this.props.user.bexioContact||{id:void 0}).id&&this.props.user.roles.indexOf(P.a.CONTACTS_READ)<0&&this.props.user.roles.indexOf(P.a.ADMIN)<0)return s.a.createElement(B,null);if(this.props.loading||!this.props.contact)return s.a.createElement(F.a,{title:"Kontakt"},s.a.createElement(q.a,null));this.groups=this.props.contact.contactGroups;var t=this.props.contact.address+", "+this.props.contact.postcode+" "+this.props.contact.city;return s.a.createElement(F.a,{title:this.props.contact.firstname+" "+this.props.contact.lastname},s.a.createElement(W.a,null,s.a.createElement(Y.a,{className:"col-md-6"},s.a.createElement(K.a,{title:"Pers\xf6nliche Informationen",actions:this.renderPanelActions()},s.a.createElement("div",{className:"container-fluid"},s.a.createElement(Ee,{id:"firstname",title:"Vorname"},this.props.contact.firstname),s.a.createElement(Ee,{id:"lastname",title:"Nachname"},this.props.contact.lastname),s.a.createElement(Ee,{id:"rank",title:"Rang"},this.props.contact.rank),s.a.createElement(Ee,{id:"birthday",title:"Geburtstag"},new Date(this.props.contact.birthday).toLocaleDateString()),s.a.createElement(Ee,{id:"address",title:"Adresse"},s.a.createElement("a",{href:"https://www.google.com/maps/search/"+t,target:"_blank"},t)),s.a.createElement(Ee,{id:"collectionPoint",title:"Abholpunkt"},this.renderCollectionPoint()),s.a.createElement(Ee,{id:"phoneFixed",title:"Festnetz"},s.a.createElement("a",{href:"tel:"+this.props.contact.phoneFixed},this.props.contact.phoneFixed)),s.a.createElement(Ee,{id:"phoneFixedSecond",title:"Festnetz 2"},s.a.createElement("a",{href:"tel:"+this.props.contact.phoneFixedSecond},this.props.contact.phoneFixedSecond)),s.a.createElement(Ee,{id:"phoneMobile",title:"Mobile"},s.a.createElement("a",{href:"tel:"+this.props.contact.phoneMobile},this.props.contact.phoneMobile)),s.a.createElement(Ee,{id:"mail",title:"E-Mails"},s.a.createElement("a",{href:"mailto:".concat(this.props.contact.mail)},this.props.contact.mail)," ",s.a.createElement("br",null),s.a.createElement("a",{href:"mailto:".concat(this.props.contact.mailSecond)},this.props.contact.mailSecond)," ",s.a.createElement("br",null),Object(ie.a)(this.state.moreMails).map(function(t,n){return e.state.editable?s.a.createElement("div",{className:"input-group"},s.a.createElement("input",{type:"email",className:"form-control",value:t,key:n.toString(),name:n.toString(),onChange:e.onMoreMailsChange}),s.a.createElement("div",{className:"input-group-append"},s.a.createElement($.a,{className:"btn-outline-secondary",onClick:e.removeMoreMailEntry.bind(e,n)},s.a.createElement(Q.a,{icon:"times"})))):s.a.createElement(s.a.Fragment,null,s.a.createElement("a",{href:"mailto:".concat(t)},t),s.a.createElement("br",null))}),this.state.editable&&s.a.createElement($.a,{className:"btn-outline btn-block",onClick:function(){e.setState({moreMails:[].concat(Object(ie.a)(e.state.moreMails),[""])})}},"Hinzuf\xfcgen")),s.a.createElement(Ee,{id:"groups",title:"Gruppen"},this.groups?this.groups.map(function(e){return s.a.createElement("span",{className:"badge badge-primary"},e.name)}):""),s.a.createElement(Ee,{id:"entryDate",title:"Eintrittsdatum",type:"date",editable:this.state.editable,value:this.state.entryDate,onChange:this.onInputChange}),s.a.createElement(Ee,{id:"exitDate",title:"Austrittsdatum",type:"date",editable:this.state.editable,value:this.state.exitDate,onChange:this.onInputChange}),s.a.createElement(Ee,{id:"remarks",title:"Bemerkungen"},this.props.contact.remarks)))),s.a.createElement(Y.a,{className:"col-md-6"},s.a.createElement(K.a,{title:"Finanzen"},s.a.createElement("div",{className:"container-fluid"},s.a.createElement(Ee,{id:"bankName",title:"Bank",value:this.state.bankName,editable:this.state.editable,onChange:this.onInputChange}),s.a.createElement(Ee,{id:"iban",title:"IBAN",value:this.state.iban,editable:this.state.editable,onChange:this.onInputChange}),s.a.createElement(Ee,{id:"accountHolder",title:"Kontoinhaber",value:this.state.accountHolder,editable:this.state.editable,onChange:this.onInputChange}))),this.renderActions())),s.a.createElement(W.a,null,s.a.createElement(Y.a,{className:"col-md-6"},s.a.createElement(te,Object.assign({contact:this.props.contact},this.props))),s.a.createElement(Y.a,{className:"col-md-6"},s.a.createElement(ae,Object.assign({contact:this.props.contact},this.props)))))}}]),n}(i.Component),xe=Object(m.c)(function(e,t){return{user:e.data.user.data,contact:e.data.contacts.byId[t.match.params.id]||e.data.members.byId[t.match.params.id],loading:e.data.contacts.loading||e.data.members.loading}},function(e,t){return{loadContacts:function(){return e(k.a.fetchContacts())},editMember:function(t){return e(k.a.editMember(t))}}})(we),Ae=Object(m.c)(function(e){return{data:e.data.orders,viewLocation:"/order/",title:"Auftr\xe4ge",tableColumns:[{text:"Auftragsnummer",keys:["documentNr"],sortable:!0,searchable:!0},{text:"Titel",keys:["title"],sortable:!0,searchable:!0},{text:"Kunde",keys:{contact:["firstname","lastname"]},sortable:!0,searchable:!0},{text:"Total",keys:["total"],sortable:!0,prefix:"CHF ",searchable:!0},{text:"Auftragsdaten",keys:["execDates"],format:"toLocaleDateString"}],defaultFilter:"upcomming",filters:[{id:"all",displayName:"Alle",filters:[{type:"any"}]},{id:"upcomming",displayName:"Kommende",filters:[{type:"gte",key:"execDates",value:Date.now()}]},{id:"passed",displayName:"Vergangene",filters:[{type:"lt",key:"execDates",value:Date.now()}]}]}},function(e){return{fetchData:function(){e(k.a.fetchOrders())}}})(ue.a),Re=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(d.a)(this,Object(h.a)(t).call(this,e))).props.order||n.props.loading||n.props.loadOrders(),n}return Object(f.a)(t,e),Object(p.a)(t,[{key:"renderPositions",value:function(){var e=[],t=!0,n=!1,a=void 0;try{for(var r,o=this.props.order.positions[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){var i=r.value;e.push(s.a.createElement(W.a,{className:"position"},s.a.createElement(Y.a,{className:"col-1"},i.pos),s.a.createElement(Y.a,null,s.a.createElement("div",{dangerouslySetInnerHTML:{__html:i.text||""}})),i.positionTotal?s.a.createElement(Y.a,{className:"col-2"},"CHF ",i.positionTotal):""))}}catch(c){n=!0,a=c}finally{try{t||null==o.return||o.return()}finally{if(n)throw a}}return e}},{key:"render",value:function(){return this.props.loading||!this.props.order?s.a.createElement(F.a,{title:"Loading..."},s.a.createElement(q.a,null)):(this.props.order.execDates instanceof Date&&(this.props.order.execDates=[this.props.order.execDates]),s.a.createElement(F.a,{title:this.props.order.title},s.a.createElement(W.a,null,s.a.createElement(Y.a,{className:"col-md-6"},s.a.createElement(K.a,{title:"Informationen"},s.a.createElement("div",{className:"container-fluid"},s.a.createElement(Ee,{id:"title",title:"Titel"},this.props.order.title),s.a.createElement(Ee,{id:"customer",title:"Kunde"},"".concat(this.props.order.contact.firstname," ").concat(this.props.order.contact.lastname)),s.a.createElement(Ee,{id:"documentNr",title:"Auftragsnummer"},this.props.order.documentNr),s.a.createElement(Ee,{id:"deliveryAddress",title:"Lieferadresse"},this.props.order.deliveryAddress),s.a.createElement(Ee,{id:"executionDates",title:"Auftragsdaten"},this.props.order.execDates?this.props.order.execDates.map(function(e){return s.a.createElement("span",{className:"badge badge-secondary"},e.toLocaleDateString())}):"")))),s.a.createElement(Y.a,{className:"col-md-6"},s.a.createElement(K.a,{title:"Actions"},s.a.createElement("a",{target:"_blank",href:"https://office.bexio.com/index.php/kb_order/show/id/".concat(this.props.order.bexioId),className:"btn btn-block btn-outline-primary"},"In Bexio anschauen")))),s.a.createElement(W.a,null,s.a.createElement(Y.a,{className:"col"},s.a.createElement(K.a,{title:"Positionen"},s.a.createElement("div",{className:"container-fluid"},this.renderPositions(),s.a.createElement(W.a,{className:"position"},s.a.createElement(Y.a,{className:"col-1"}),s.a.createElement(Y.a,null,s.a.createElement("strong",null,"Total")),s.a.createElement(Y.a,{className:"col-2"},"CHF ",this.props.order.total))))))))}}]),t}(i.Component),Te=Object(m.c)(function(e,t){return{order:e.data.orders.byId[t.match.params.id],loading:e.data.orders.loading}},function(e,t){return{loadOrders:function(){e(k.a.fetchOrders())}}})(Re),Ie=Object(m.c)(function(e){return{data:e.data.billingReports,title:"Verrechnungsrapporte",viewLocation:"/billing-report/",tableColumns:[{text:"Datum",keys:["date"],sortable:!0,format:"toLocaleDateString"},{text:"Auftrag Nr",keys:{order:["documentNr"]},sortable:!0,searchable:!0},{text:"Auftrag Titel",keys:{order:["title"]},sortable:!0,searchable:!0},{text:"Ersteller",keys:{creator:["displayName"]},sortable:!0,searchable:!0},{text:"Status",keys:["state"],sortable:!0,searchable:!0}],defaultFilter:"all",filters:[{id:"all",displayName:"Alle",filters:[{type:"any"}]},{id:"pending",displayName:"Offen",filters:[{type:"eq",value:"pending",key:"state"}]},{id:"approved",displayName:"Genehmigt",filters:[{type:"eq",value:"approved",key:"state"}]}]}},function(e){return{fetchData:function(){e(k.a.fetchBillingReports())}}})(ue.a),De=n(288),_e=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(d.a)(this,Object(h.a)(t).call(this,e))).handleClose=n.handleClose.bind(Object(J.a)(n)),n}return Object(f.a)(t,e),Object(p.a)(t,[{key:"handleClose",value:function(){this.props.onHide&&this.props.onHide()}},{key:"render",value:function(){return s.a.createElement(De.a,{show:this.props.show,onHide:this.handleClose,dialogClassName:"modal-lg"},s.a.createElement(De.a.Header,{closeButton:!0},this.props.header),s.a.createElement(De.a.Body,null,this.props.body),s.a.createElement(De.a.Footer,null,this.props.footer))}}]),t}(i.Component),Le=n(285);function Me(e){return function(){var t,n=Object(h.a)(e);if(function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var a=Object(h.a)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return Object(d.a)(this,t)}}var Pe=function(e){Object(f.a)(n,e);var t=Me(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).deleteCompensation=a.deleteCompensation.bind(Object(J.a)(a)),a.deleteCompensationConfirmed=a.deleteCompensationConfirmed.bind(Object(J.a)(a)),a.showModal=a.showModal.bind(Object(J.a)(a)),a.hideModal=a.hideModal.bind(Object(J.a)(a)),a.state={modalShow:!1},a}return Object(p.a)(n,[{key:"deleteCompensation",value:function(e){if(e.currentTarget.parentNode&&e.currentTarget.parentNode.parentNode&&e.currentTarget.parentNode.parentNode.parentElement){var t=e.currentTarget.parentNode.parentNode.parentElement.getAttribute("data-key");t&&this.setState({toDeleteCompensation:this.props.data.byId[t],modalShow:!0})}}},{key:"deleteCompensationConfirmed",value:function(e){this.state.toDeleteCompensation&&(this.props.delete(this.state.toDeleteCompensation.id),this.setState({toDeleteCompensation:void 0,modalShow:!1}))}},{key:"showModal",value:function(){this.setState({modalShow:!0})}},{key:"hideModal",value:function(e){this.setState({modalShow:!1})}},{key:"renderModal",value:function(){return this.state.toDeleteCompensation?s.a.createElement(_e,{show:this.state.modalShow,onHide:this.hideModal,header:s.a.createElement("h3",null,this.state.toDeleteCompensation.member.firstname+" "+this.state.toDeleteCompensation.member.lastname+" vom  "+this.state.toDeleteCompensation.date.toLocaleDateString()),body:s.a.createElement("span",null,"Willst du die Entsch\xe4digung von "+this.state.toDeleteCompensation.member.firstname+" "+this.state.toDeleteCompensation.member.lastname+" vom  "+this.state.toDeleteCompensation.date.toLocaleDateString()+" mit einem Betrag von CHF"+this.state.toDeleteCompensation.amount+" wirklich l\xf6schen?"),footer:s.a.createElement(Le.a,null,s.a.createElement(pe.a,{variant:"danger",onClick:this.deleteCompensationConfirmed},"L\xf6schen"),s.a.createElement(pe.a,{variant:"secondary",onClick:this.hideModal},"Abbrechen"))}):null}},{key:"render",value:function(){return s.a.createElement(ue.a,{title:"Entsch\xe4digungen",viewLocation:"/compensation/",panelActions:[s.a.createElement(he,{icon:"plus",to:"/compensations/add",roles:[P.a.COMPENSATIONS_CREATE]})],rowActions:[s.a.createElement(pe.a,{className:"btn btn-danger delete",onClick:this.deleteCompensation,roles:[P.a.COMPENSATIONS_EDIT]},s.a.createElement(Q.a,{icon:"trash"}))],tableColumns:[{text:"Mitglied",keys:{member:["firstname","lastname"]},sortable:!0,searchable:!0},{text:"Datum",keys:["date"],sortable:!0,format:"toLocaleDateString"},{text:"Betrag",keys:["amount"],sortable:!0,prefix:"CHF ",format:"toFixed(2)"},{text:"Beschreibung",keys:["description"],sortable:!1,searchable:!0},{text:"Ersteller",keys:{creator:["displayName"]},sortable:!0},{text:"Genehmigt",keys:["approved"],sortable:!0},{text:"Ausbezahlt",keys:["paied"],sortable:!0}],data:this.props.data,fetchData:this.props.fetchData,history:this.props.history,defaultFilter:"all",filters:[{id:"all",displayName:"Alle",filters:[{type:"any"}]},{id:"notApproved",displayName:"Nicht bewilligt",filters:[{type:"eq",value:"false",key:"approved"}]},{id:"approved",displayName:"Bewilligt",filters:[{type:"eq",value:"true",key:"approved"}]},{id:"paied",displayName:"Ausbezahlt",filters:[{type:"eq",value:"true",key:"paied"}]},{id:"notPaied",displayName:"Nicht Ausbezahlt",filters:[{type:"eq",value:"false",key:"paied"}]}]},this.renderModal())}}]),n}(i.Component),Fe=Object(m.c)(function(e){return{data:e.data.compensationEntries}},function(e){return{fetchData:function(){e(k.a.fetchCompensationEntries())},delete:function(t){e(k.a.deleteCompensationEntry(t))}}})(Pe),Be=n(152);function Ge(e){return function(){var t,n=Object(h.a)(e);if(function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var a=Object(h.a)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return Object(d.a)(this,t)}}var Ve=function(e){Object(f.a)(n,e);var t=Ge(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).mounted=!1,a.state={loaded:!1},a}return Object(p.a)(n,[{key:"componentDidMount",value:function(){var e=Object(le.a)(ce.a.mark(function e(){return ce.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.mounted=!0,e.next=3,this.props.fetchUser();case 3:this.mounted&&this.setState({loaded:!0});case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){var e=Object(le.a)(ce.a.mark(function e(){return ce.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.mounted=!1;case 1:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return this.props.user.data?(this.props.showSuccess("Willkommen zur\xfcck"),this.props.location.state&&this.props.location.state.prevLocation?this.props.history.push(this.props.location.state.prevLocation):this.props.history.push("/dashboard"),null):this.props.user.loading||!this.state.loaded?s.a.createElement(q.a,{fullscreen:!0}):(this.props.location.state&&!this.props.location.state.errorShown&&(this.props.showError("Sorry.... zuerst einloggen!"),this.props.history.replace(this.props.location.pathname,Object.assign({},this.props.location.state,{errorShown:!0}))),s.a.createElement("div",{id:"login"},s.a.createElement("h2",null,"Login"),s.a.createElement("div",{className:"form-group"},s.a.createElement("a",{className:"btn btn-secondary btn-block",href:U.a.apiEndpoint+"/api/auth/azure"},s.a.createElement(Q.a,{icon:["fab","microsoft"],className:"icon"}),"VK-Login"))))}}]),n}(i.Component),Ue=Object(m.c)(function(e){return{user:e.data.user}},function(e){return{fetchUser:function(){return e(k.a.fetchUser())},showError:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Ooppss...! Versuche es sp\xe4ter erneut";e(y.a.showError(t))},showSuccess:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Yeeppiii";e(y.a.showSuccess(t))}}})(Ve),He=Object(m.c)(function(e){return{data:e.data.users,viewLocation:"/user/",title:"Benutzer",tableColumns:[{text:"Name",keys:["displayName"],sortable:!0,searchable:!0},{text:"Rechte",keys:["roles"],sortable:!0,searchable:!0}]}},function(e){return{fetchData:function(){e(k.a.fetchUsers())}}})(ue.a),ze=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(d.a)(this,Object(h.a)(t).call(this,e))).props.fetchUsers(),n}return Object(f.a)(t,e),Object(p.a)(t,[{key:"renderBexioPart",value:function(){if(!this.props.user.bexioContact)return s.a.createElement("span",null,"Kein Link gefunden....");var e=this.props.user.bexioContact;return s.a.createElement("div",null,s.a.createElement(Ee,{id:"bexioId",title:"ID"},e.bexioId),s.a.createElement(Ee,{id:"firstname",title:"Vorname"},e.firstname),s.a.createElement(Ee,{id:"lastname",title:"Nachname"},e.lastname),s.a.createElement(X.a,{to:"/contact/"+e.id,className:"btn btn-block btn-outline-primary"},"Kontakt \xf6ffnen"),s.a.createElement("a",{target:"_blank",href:"https://office.bexio.com/index.php/kontakt/show/id/"+e.bexioId,className:"btn btn-block btn-outline-primary"},"In Bexio anschauen"))}},{key:"renderRolePart",value:function(){var e=[];for(var t in this.props.user.roles)e.push({role:this.props.user.roles[t],id:t});return s.a.createElement(Z.a,{columns:[{text:"Role",keys:["role"]}],data:e})}},{key:"render",value:function(){return this.props.loading||!this.props.user?s.a.createElement(F.a,{title:"Loading..."},s.a.createElement(q.a,null)):s.a.createElement(F.a,{title:this.props.user.displayName},s.a.createElement(W.a,null,s.a.createElement(Y.a,{className:"col-md-6"},s.a.createElement(K.a,{title:"Allgemeine Informationen"},s.a.createElement(Ee,{id:"displayName",title:"Name"},this.props.user.displayName)),s.a.createElement(K.a,{title:"Rechte"},this.renderRolePart())),s.a.createElement(Y.a,{className:"col-md-6"},s.a.createElement(K.a,{title:"Bexio Informationen"},this.renderBexioPart()))))}}]),t}(i.Component),qe=Object(m.c)(function(e,t){return"/me"===t.location.pathname?{user:e.data.user.data,loading:e.data.user.loading}:{user:e.data.users.byId[t.match.params.id],loading:e.data.users.loading}},function(e,t){return"/me"===t.location.pathname?{fetchUsers:function(){e(k.a.fetchUser())}}:{fetchUsers:function(){e(k.a.fetchUsers())}}})(ze),Ke=function(e){function t(e){var n;if(Object(u.a)(this,t),(n=Object(d.a)(this,Object(h.a)(t).call(this,e))).props.defaultValue instanceof Array){var a=[],r=!0,o=!1,i=void 0;try{for(var s,c=n.props.defaultValue[Symbol.iterator]();!(r=(s=c.next()).done);r=!0){var l=s.value;a.push({value:l.id.toString(),label:l.title})}}catch(p){o=!0,i=p}finally{try{r||null==c.return||c.return()}finally{if(o)throw i}}n.state={value:a}}else n.state={};return n}return Object(f.a)(t,e),Object(p.a)(t,[{key:"componentDidUpdate",value:function(){if(this.props.defaultValue instanceof Array){var e=[],t=!0,n=!1,a=void 0;try{for(var r,o=this.props.defaultValue[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){var i=r.value;i.hasOwnProperty("id")&&e.push({value:i.id.toString(),label:i.title})}}catch(s){n=!0,a=s}finally{try{t||null==o.return||o.return()}finally{if(n)throw a}}JSON.stringify(this.state.value)!==JSON.stringify(e)&&this.setState({value:e})}}},{key:"componentWillMount",value:function(){this.props.orders.ids.length<1&&this.props.fetchOrders()}},{key:"prepareOptions",value:function(){var e=[];if(Object.keys(this.props.orders.byId).length>0)for(var t in this.props.orders.byId){var n=this.props.orders.byId[t];e.push({label:n.title,value:t})}return e}},{key:"onChange",value:function(e){var t=[e];this.props.isMulti&&(t=e),this.setState({value:t});var n=[],a=!0,r=!1,o=void 0;try{for(var i,s=t[Symbol.iterator]();!(a=(i=s.next()).done);a=!0){var c=i.value;n.push(this.props.orders.byId[c.value])}}catch(l){r=!0,o=l}finally{try{a||null==s.return||s.return()}finally{if(r)throw o}}this.props.onChange&&(this.props.isMulti?this.props.onChange(n):this.props.onChange(n[0]))}},{key:"prepareValue",value:function(){return this.props.isMulti?this.state.value||[]:(this.state.value||[])[0]}},{key:"render",value:function(){var e=this;return this.props.loading?null:s.a.createElement(Ce.a,{ref:function(t){e.props.ref&&e.props.ref(t)},isClearable:!0,options:this.prepareOptions(),backspaceRemovesValue:!0,hideSelectedOptions:!0,openMenuOnFocus:!0,isMulti:this.props.isMulti||!1,onChange:this.onChange.bind(this),value:this.prepareValue()})}}]),t}(i.Component),Ye=Object(m.c)(function(e,t){return{orders:e.data.orders,loading:e.data.orders.loading}},function(e,t){return{fetchOrders:function(){e(k.a.fetchOrders())}}})(Ke),We=n(54),Xe=n(88);function Je(e){if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(!e)return;if("string"===typeof e)return Ze(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ze(e,t)}(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,r,o=!0,i=!1;return{s:function(){a=e[Symbol.iterator]()},n:function(){var e=a.next();return o=e.done,e},e:function(e){i=!0,r=e},f:function(){try{o||null==a.return||a.return()}finally{if(i)throw r}}}}function Ze(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function $e(e){return function(){var t,n=Object(h.a)(e);if(function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var a=Object(h.a)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return Object(d.a)(this,t)}}var Qe=function(e){Object(f.a)(n,e);var t=$e(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).approve=a.approve.bind(Object(J.a)(a)),a.decline=a.decline.bind(Object(J.a)(a)),a.elementView=a.elementView.bind(Object(J.a)(a)),a.billingReport=a.props.billingReports.byId[parseInt(a.props.match.params.id)],a.onInformationEdit=a.onInformationEdit.bind(Object(J.a)(a)),a.onAbort=a.onAbort.bind(Object(J.a)(a)),a.onInformationSave=a.onInformationSave.bind(Object(J.a)(a)),a.onInputChange=a.onInputChange.bind(Object(J.a)(a)),a.getCompensationActions=a.getCompensationActions.bind(Object(J.a)(a)),a.deleteCompensation=a.deleteCompensation.bind(Object(J.a)(a)),a.deleteCompensationConfirmed=a.deleteCompensationConfirmed.bind(Object(J.a)(a)),a.addCompensations=a.addCompensations.bind(Object(J.a)(a)),a.showModal=a.showModal.bind(Object(J.a)(a)),a.hideModal=a.hideModal.bind(Object(J.a)(a)),a.billingReport&&(a.state={informationEdit:!1,order:a.billingReport.order,date:a.billingReport.date,els:a.billingReport.els,drivers:a.billingReport.drivers,food:a.billingReport.food,remarks:a.billingReport.remarks,modalShow:!1}),a}return Object(p.a)(n,[{key:"componentDidUpdate",value:function(e){this.props.match.params.id!==e.match.params.id&&(this.billingReport=this.props.billingReports.byId[parseInt(this.props.match.params.id)],this.billingReport&&this.setState({order:this.billingReport.order,date:this.billingReport.date,els:this.billingReport.els,drivers:this.billingReport.drivers,food:this.billingReport.food,remarks:this.billingReport.remarks}))}},{key:"componentWillMount",value:function(){this.props.fetchBillingReports(),this.props.fetchOrders()}},{key:"approve",value:function(){return this.props.approve(this.billingReport.id.toString())}},{key:"decline",value:function(){return this.props.decline(this.billingReport.id.toString())}},{key:"onInformationEdit",value:function(){var e=Object(le.a)(ce.a.mark(function e(t){return ce.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.setState({informationEdit:!0});case 1:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"onAbort",value:function(){var e=Object(le.a)(ce.a.mark(function e(t){return ce.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.setState({informationEdit:!1,order:this.billingReport.order,date:this.billingReport.date,els:this.billingReport.els,drivers:this.billingReport.drivers,food:this.billingReport.food,remarks:this.billingReport.remarks});case 1:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"onInformationSave",value:function(){var e=Object(le.a)(ce.a.mark(function e(t){return ce.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.props.edit({id:this.billingReport.id.toString(),date:this.state.date,drivers:this.state.drivers,els:this.state.els,food:this.state.food,orderId:this.state.order.id,remarks:this.state.remarks});case 2:this.setState({informationEdit:!1});case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"onInputChange",value:function(e,t){this.setState(Object(ye.a)({},e,t))}},{key:"onSelectChange",value:function(e){var t=this;return function(n){t.setState(Object(ye.a)({},e,n))}}},{key:"elementView",value:function(){var e=Object(le.a)(ce.a.mark(function e(t){var n;return ce.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),t.currentTarget.parentNode&&t.currentTarget.parentNode.parentNode&&t.currentTarget.parentNode.parentNode.parentElement&&(n=t.currentTarget.parentNode.parentNode.parentElement.getAttribute("data-key"),1==t.button?window.open(document.location.origin+"/compensation/"+n):this.props.history.push("/compensation/"+n));case 2:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"deleteCompensation",value:function(){var e=Object(le.a)(ce.a.mark(function e(t){var n;return ce.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.currentTarget.parentNode&&t.currentTarget.parentNode.parentNode&&t.currentTarget.parentNode.parentNode.parentElement&&(n=t.currentTarget.parentNode.parentNode.parentElement.getAttribute("data-key"))&&this.setState({toDeleteCompensation:this.billingReport.compensations.find(function(e){return e.id===parseInt(n||"")}),modalShow:!0});case 1:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"deleteCompensationConfirmed",value:function(){var e=Object(le.a)(ce.a.mark(function e(){return ce.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.state.toDeleteCompensation){e.next=4;break}return e.next=3,this.props.deleteCompensation(this.state.toDeleteCompensation.id);case 3:this.setState({toDeleteCompensation:void 0,modalShow:!1});case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"addCompensations",value:function(){var e=Object(le.a)(ce.a.mark(function e(t){var n,a;return ce.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(a in n=[],t.vks)n.push(t.vks[a]);return e.next=4,this.props.addCompensationEntries({billingReportId:this.billingReport.id,entries:n});case 4:this.hideModal();case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"showModal",value:function(){var e=Object(le.a)(ce.a.mark(function e(){return ce.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.setState({modalShow:!0});case 1:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"hideModal",value:function(){var e=Object(le.a)(ce.a.mark(function e(){return ce.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({modalShow:!1}),e.abrupt("return",!0);case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"prepareCompensationsForTable",value:function(){var e,t={},n=Je(this.billingReport.compensations);try{for(n.s();!(e=n.n()).done;){var a=e.value;t[a.id]=a}}catch(r){n.e(r)}finally{n.f()}return t}},{key:"renderActions",value:function(){return[s.a.createElement(pe.a,{id:"approve",block:!0,variant:"outline-success",onClick:this.approve,roles:[P.a.BILLINGREPORTS_APPROVE]},"Genehmigen"),s.a.createElement(X.a,{to:"/order/".concat(this.billingReport.order.id),className:"btn btn-block btn-outline-primary"},"Auftrag \xf6ffnen")]}},{key:"renderOrder",value:function(){return this.state.informationEdit?s.a.createElement(Ye,{defaultValue:[this.state.order],onChange:this.onSelectChange("order")}):this.state.order.title}},{key:"renderEls",value:function(){return this.state.informationEdit?s.a.createElement(We.a,{defaultValue:this.state.els,isMulti:!0,onChange:this.onSelectChange("els")}):this.state.els.map(function(e){return e.firstname+" "+e.lastname}).join(",")}},{key:"renderDrivers",value:function(){return this.state.informationEdit?s.a.createElement(We.a,{defaultValue:this.state.drivers,isMulti:!0,onChange:this.onSelectChange("drivers")}):this.state.drivers.map(function(e){return e.firstname+" "+e.lastname}).join(",")}},{key:"renderInformations",value:function(){var e="badge-success";"pending"===this.billingReport.state&&(e="badge-warning"),"declined"===this.billingReport.state&&(e="badge-danger");var t=[];return(this.props.user.roles.includes(P.a.ADMIN)||this.props.user.roles.includes(P.a.BILLINGREPORTS_EDIT)||"pending"===this.billingReport.state&&this.billingReport.creator.id===this.props.user.id)&&(this.state.informationEdit?(t.push(s.a.createElement(he,{icon:"save",key:"save",onClick:this.onInformationSave})),t.push(s.a.createElement(he,{icon:"times",key:"edit",onClick:this.onAbort}))):t.push(s.a.createElement(he,{icon:"pencil-alt",key:"edit",onClick:this.onInformationEdit,roles:[P.a.BILLINGREPORTS_EDIT]}))),s.a.createElement(K.a,{title:"Informationen",actions:t,className:this.state.informationEdit?"editable":""},s.a.createElement(Ee,{id:"orderTitle",title:"Auftrag"},this.renderOrder()),s.a.createElement(Ee,{id:"date",title:"Datum",value:this.state.date.toISOString().split("T")[0],type:"date",editable:this.state.informationEdit,onChange:this.onInputChange}),s.a.createElement(Ee,{id:"creator",title:"Ersteller"},this.billingReport.creator.displayName),s.a.createElement(Ee,{id:"state",title:"Status"},s.a.createElement("div",{className:"badge "+e},this.billingReport.state)),s.a.createElement(Ee,{id:"els",title:"ELs"},this.renderEls()),s.a.createElement(Ee,{id:"drivers",title:"Fahrer"},this.renderDrivers()),s.a.createElement(Ee,{id:"food",title:"Verpflegung",value:this.state.food,type:"checkbox",editable:this.state.informationEdit,onChange:this.onInputChange}),s.a.createElement(Ee,{id:"remarks",title:"Bemerkungen",value:this.state.remarks,type:"textarea",editable:this.state.informationEdit,onChange:this.onInputChange}))}},{key:"renderCompensationDeletionModal",value:function(){return this.state.toDeleteCompensation?s.a.createElement(_e,{show:this.state.modalShow,onHide:this.hideModal,header:s.a.createElement("h3",null,this.state.toDeleteCompensation.member.firstname+" "+this.state.toDeleteCompensation.member.lastname+" vom  "+this.state.toDeleteCompensation.date.toLocaleDateString()),body:s.a.createElement("span",null,"Willst du die Entsch\xe4digung von "+this.state.toDeleteCompensation.member.firstname+" "+this.state.toDeleteCompensation.member.lastname+" vom  "+this.state.toDeleteCompensation.date.toLocaleDateString()+" mit einem Betrag von CHF"+this.state.toDeleteCompensation.amount+" wirklich l\xf6schen?"),footer:s.a.createElement(Le.a,null,s.a.createElement(pe.a,{variant:"danger",onClick:this.deleteCompensationConfirmed},"L\xf6schen"),s.a.createElement(pe.a,{variant:"secondary",onClick:this.hideModal},"Abbrechen"))}):null}},{key:"renderCompensationsAddModal",value:function(){return this.state.toDeleteCompensation?null:s.a.createElement(_e,{show:this.state.modalShow,onHide:this.hideModal,header:s.a.createElement("h3",null,"Entsch\xe4digungen hinzuf\xfcgen"),body:s.a.createElement(Xe.a,{onNext:this.addCompensations,onPrevious:this.hideModal}),footer:s.a.createElement("div",null)})}},{key:"getCompensationActions",value:function(){return[s.a.createElement(pe.a,{variant:"success",className:"view",onClick:this.elementView},s.a.createElement(Q.a,{icon:"eye"})),s.a.createElement(pe.a,{variant:"danger",className:"delete",onClick:this.deleteCompensation,roles:[P.a.BILLINGREPORTS_EDIT]},s.a.createElement(Q.a,{icon:"trash"}))]}},{key:"render",value:function(){return!this.props.loading&&this.billingReport&&this.state?s.a.createElement(F.a,{title:"Verrechnungsrapport"},this.renderCompensationDeletionModal(),this.renderCompensationsAddModal(),s.a.createElement(W.a,null,s.a.createElement(Y.a,{className:"col-md-6"},this.renderInformations()),s.a.createElement(Y.a,{className:"col-md-6"},s.a.createElement(K.a,{title:"Actions"},this.renderActions()))),s.a.createElement(W.a,null,s.a.createElement(Y.a,null,s.a.createElement(K.a,{title:"VKs",actions:[s.a.createElement(he,{icon:"plus",onClick:this.showModal})]},s.a.createElement(Z.a,{columns:[{text:"Name",keys:{member:["firstname","lastname"]},sortable:!0},{text:"Von",keys:["from"],format:"toLocaleTimeString",sortable:!0},{text:"Bis",keys:["until"],format:"toLocaleTimeString",sortable:!0},{text:"Verrechnen",keys:["charge"],sortable:!0},{text:"Betrag",keys:["amount"],prefix:"CHF ",sortable:!0,format:"toFixed(2)"},{text:"Ausbezahlt",keys:["paied"],sortable:!0},{text:"Actions",keys:["_id"],content:s.a.createElement(Le.a,null,this.getCompensationActions())}],defaultSort:{keys:["from"],direction:"asc"},data:this.prepareCompensationsForTable()}))))):s.a.createElement(F.a,{title:"Verrechnungsrapport"},s.a.createElement(q.a,null))}}]),n}(i.Component),et=Object(m.c)(function(e,t){return{billingReports:e.data.billingReports,user:e.data.user.data,orders:e.data.orders,loading:e.data.billingReports.loading||e.data.user.loading||e.data.orders.loading}},function(e,t){return{fetchBillingReports:function(){return e(k.a.fetchBillingReports())},fetchOrders:function(){return e(k.a.fetchOrders())},approve:function(t){return e(k.a.approveBillingReport(t))},decline:function(t){return e(k.a.declineBillingReport(t))},edit:function(t){return e(k.a.editBillingReport(t))},deleteCompensation:function(){var t=Object(le.a)(ce.a.mark(function t(n){return ce.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e(k.a.deleteCompensationEntry(n)).then(function(){e(k.a.fetchBillingReports())}));case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}(),addCompensationEntries:function(t){return e(k.a.addCompensationEntriesForBillingReport(t)).then(function(){e(k.a.fetchBillingReports())})}}})(Qe);function tt(e){return function(){var t,n=Object(h.a)(e);if(function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var a=Object(h.a)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return Object(d.a)(this,t)}}var nt=function(e){Object(f.a)(n,e);var t=tt(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).onSelectChange=a.onSelectChange.bind(Object(J.a)(a)),a.onInputChange=a.onInputChange.bind(Object(J.a)(a)),a.onSave=a.onSave.bind(Object(J.a)(a)),a.state={member:"",date:"",description:""},a}return Object(p.a)(n,[{key:"componentDidMount",value:function(){this.props.fetchMembers()}},{key:"validate",value:function(){if(this.formEl){var e=this.formEl.checkValidity();return this.formEl.className="was-validated",e}return!1}},{key:"onSelectChange",value:function(e){e?this.setState({member:e.value}):this.setState({member:""})}},{key:"prepareMembers",value:function(){var e=[];if(Object.keys(this.props.members.byId).length>0)for(var t in this.props.members.byId){var n=this.props.members.byId[t];e.push({label:n.firstname+" "+n.lastname,value:t})}return e}},{key:"onInputChange",value:function(e){var t=e.target,n="checkbox"===t.type?t.checked:t.value,a=t.name;this.setState(Object(ye.a)({},a,n))}},{key:"onSave",value:function(){var e=Object(le.a)(ce.a.mark(function e(t){return ce.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),!this.formEl){e.next=6;break}if(!this.validate()){e.next=6;break}return e.next=5,this.props.save({member:this.state.member,date:new Date(this.state.date),description:this.state.description,amount:this.state.amount});case 5:this.props.history.push("/compensations");case 6:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return this.props.loading&&this.props.members.ids.length<1?s.a.createElement(F.a,{title:"Entsch\xe4digung hinzuf\xfcgen"},s.a.createElement(q.a,null)):s.a.createElement(F.a,{title:"Entsch\xe4digung hinzuf\xfcgen"},s.a.createElement(W.a,null,s.a.createElement(Y.a,null,s.a.createElement(K.a,null,s.a.createElement("form",{id:"addCompensation",ref:function(t){e.formEl=t}},s.a.createElement("h5",null,"Mitglied"),s.a.createElement(Ce.a,{isClearable:!0,onChange:this.onSelectChange,options:this.prepareMembers(),backspaceRemovesValue:!0,hideSelectedOptions:!0,openMenuOnFocus:!0}),s.a.createElement("br",null),s.a.createElement("h5",null,"Datum"),s.a.createElement("input",{name:"date",type:"date",className:"form-control",value:this.state.date,onChange:this.onInputChange,required:!0}),s.a.createElement("br",null),s.a.createElement("h5",null,"Beschreibung"),s.a.createElement("input",{name:"description",type:"text",className:"form-control",value:this.state.description,onChange:this.onInputChange,required:!0}),s.a.createElement("br",null),s.a.createElement("h5",null,"Betrag"),s.a.createElement("div",{className:"input-group mb-2"},s.a.createElement("div",{className:"input-group-prepend"},s.a.createElement("div",{className:"input-group-text"},"CHF")),s.a.createElement("input",{type:"number",step:"0.05",className:"form-control",name:"amount",value:this.state.amount,onChange:this.onInputChange,placeholder:"0.00",required:!0})),s.a.createElement("br",null),s.a.createElement(pe.a,{variant:"primary",block:!0,onClick:this.onSave},"Speichern"))))))}}]),n}(i.Component),at=Object(m.c)(function(e){return{members:e.data.members,loading:e.data.members.loading}},function(e){return{fetchMembers:function(){e(k.a.fetchMembers())},save:function(t){e(k.a.addCompensationEntry(t))}}})(nt),rt=function(e){function t(e,n,a,r){var o,i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=arguments.length>5&&void 0!==arguments[5]&&arguments[5],c=arguments.length>6?arguments[6]:void 0;return Object(u.a)(this,t),(o=Object(d.a)(this,Object(h.a)(t).call(this))).member=e,o.creator=n,o.amount=a,o.date=r,o.approved=i,o.paied=s,o.payout=c,o}return Object(f.a)(t,e),Object(p.a)(t,null,[{key:"isOrderBased",value:function(e){return void 0!==e.billingReport&&null!==e.billingReport}},{key:"isCustom",value:function(e){return void 0!==e.description&&null!==e.description}}]),t}(Oe),ot=function(e){function t(){return Object(u.a)(this,t),Object(d.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){return s.a.createElement(F.a,{title:""},s.a.createElement("div",{id:"page-404"},s.a.createElement("img",{src:"/webapp/404.png"})))}}]),t}(i.Component);function it(e){return function(){var t,n=Object(h.a)(e);if(function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var a=Object(h.a)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return Object(d.a)(this,t)}}var st=function(e){Object(f.a)(n,e);var t=it(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).approve=a.approve.bind(Object(J.a)(a)),a.renderBillingReport=a.renderBillingReport.bind(Object(J.a)(a)),a.renderActions=a.renderActions.bind(Object(J.a)(a)),a.props.fetchCompensations(),a}return Object(p.a)(n,[{key:"approve",value:function(){return this.props.approve(this.props.compensation.id)}},{key:"renderActions",value:function(){var e=[i.createElement(X.a,{to:"/contact/"+this.props.compensation.member.id,className:"btn btn-block btn-outline-primary"},"Kontakt \xf6ffnen")];return this.props.compensation.approved||e.push(i.createElement(pe.a,{id:"approve",block:!0,variant:"outline-success",onClick:this.approve,roles:[P.a.COMPENSATIONS_APPROVE]},"Genehmigen")),e}},{key:"renderBillingReport",value:function(){if(rt.isOrderBased(this.props.compensation)){var e="badge-success";return"pending"===this.props.compensation.billingReport.state&&(e="badge-warning"),i.createElement(Y.a,{className:"col-md-6"},i.createElement(K.a,{title:"Verrechnungsrapport"},i.createElement(Ee,{id:"orderNr",title:"Auftragsnummer"},this.props.compensation.billingReport.order.documentNr),i.createElement(Ee,{id:"orderNr",title:"Auftrag"},this.props.compensation.billingReport.order.title),i.createElement(Ee,{id:"state",title:"Verrechnungsrapportstatus"},i.createElement("div",{className:"badge "+e},this.props.compensation.billingReport.state)),i.createElement(Ee,{id:"from",title:"Von"},this.props.compensation.from.toLocaleTimeString()),i.createElement(Ee,{id:"until",title:"Bis"},this.props.compensation.until.toLocaleTimeString()),i.createElement(Ee,{id:"charge",title:"Verrechnen"},this.props.compensation.charge?"\u2713":"\u2a2f"),i.createElement(X.a,{to:"/order/"+this.props.compensation.billingReport.order.id,className:"btn btn-outline-primary btn-block"},"Auftrag"),i.createElement(X.a,{to:"/billing-report/"+this.props.compensation.billingReport.id,className:"btn btn-outline-primary btn-block"},"Verrechnungsrapport")))}}},{key:"render",value:function(){if(!this.props.loading&&!this.props.compensation&&this.props.compensationIds.length>0)return i.createElement(ot,null);if(this.props.loading||!this.props.compensation)return i.createElement(F.a,{title:"Entsch\xe4digung"},i.createElement(q.a,null));var e="badge-success";return this.props.compensation.approved||(e="badge-warning"),i.createElement(F.a,{title:"Entsch\xe4digung"},i.createElement(W.a,null,i.createElement(Y.a,{className:"col-md-6"},i.createElement(K.a,{title:"Informationen"},i.createElement(Ee,{id:"member",title:"Mitglied"},this.props.compensation.member.firstname," ",this.props.compensation.member.lastname),i.createElement(Ee,{id:"date",title:"Datum"},this.props.compensation.date.toLocaleDateString()),i.createElement(Ee,{id:"amount",title:"Betrag"},"CHF ",this.props.compensation.amount.toFixed(2)),rt.isCustom(this.props.compensation)&&i.createElement(Ee,{id:"description",title:"Beschreibung"},this.props.compensation.description),i.createElement(Ee,{id:"state",title:"Status"},i.createElement("div",{className:"badge "+e},this.props.compensation.approved?"Bewilligt":"Ausstehend")),i.createElement(Ee,{id:"creator",title:"Ersteller"},this.props.compensation.creator.displayName))),i.createElement(Y.a,{className:"col-md-6"},i.createElement(K.a,{title:"Actions"},this.renderActions()))),i.createElement(W.a,null,this.renderBillingReport(),i.createElement(Y.a,{className:"col-md-6"},i.createElement(K.a,{title:"Auszahlung"},i.createElement(Ee,{id:"paied",title:"Ausbezahlt"},this.props.compensation.paied?"\u2713":"\u2a2f"),this.props.compensation.payout?i.createElement(X.a,{to:"/payout/"+this.props.compensation.payout.id+"/"+this.props.compensation.member.id,className:"btn btn-outline-primary btn-block"},"Auszahlung"):i.createElement("p",null),this.props.compensation.bexioBill?i.createElement("a",{href:"https://office.bexio.com/index.php/kb_bill/show/id/".concat(this.props.compensation.bexioBill),target:"_blank",className:"btn btn-outline-primary btn-block"},"Bexio Lieferantenrechnung"):i.createElement("p",null),this.props.compensation.transferCompensation?i.createElement(X.a,{to:"/compensation/".concat(this.props.compensation.transferCompensation.id),className:"btn btn-outline-primary btn-block"},"\xdcbertrag"):i.createElement("p",null)))))}}]),n}(i.Component),ct=Object(m.c)(function(e,t){return{compensation:e.data.compensationEntries.byId[t.match.params.id],compensationIds:e.data.compensationEntries.ids,loading:e.data.compensationEntries.loading}},function(e){return{fetchCompensations:function(){return e(k.a.fetchCompensationEntries())},approve:function(t){return e(k.a.approveCompensationEntry(t))}}})(st),lt=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(d.a)(this,Object(h.a)(t).call(this,e))).props.fetchMembers(),n}return Object(f.a)(t,e),Object(p.a)(t,[{key:"copy",value:function(e){var t=this;navigator.permissions.query({name:"clipboard-write"}).then(function(n){"granted"==n.state||"prompt"==n.state?navigator.clipboard.writeText(e).then(function(){t.props.showSuccess("Kopiert!")}).catch(function(e){console.error(e),t.props.showError("Ooops... Etwas ging schief...")}):t.props.showError("Ich darf nichts kopieren....")}).catch(function(e){console.error(e),t.props.showError("Ooops... Etwas ging schief...")})}},{key:"addCopy",value:function(e){return s.a.createElement("div",{className:"input-group-prepend"},s.a.createElement("button",{className:"btn btn-outline-secondary",id:"btnGroupAddon",onClick:this.copy.bind(this,e)},s.a.createElement(Q.a,{icon:"clipboard"})))}},{key:"render",value:function(){return Object.keys(this.props.mailingLists).length<1?s.a.createElement(F.a,{title:"Verteiler"},s.a.createElement(q.a,null)):(console.log(this.props.mailingLists),s.a.createElement(F.a,{title:"Verteiler"},s.a.createElement(W.a,null,s.a.createElement(Y.a,{className:"col-md-4"},s.a.createElement(K.a,{title:"Mitglieder"},s.a.createElement("div",{className:"input-group"},s.a.createElement("input",{className:"form-control",readOnly:!0,value:this.props.mailingLists.all.join(";")}),this.addCopy(this.props.mailingLists.all.join(";"))))),s.a.createElement(Y.a,{className:"col-md-4"},s.a.createElement(K.a,{title:"VKs (ohne Fahrer und Condor)"},s.a.createElement("div",{className:"input-group"},s.a.createElement("input",{className:"form-control",readOnly:!0,value:this.props.mailingLists.vks.join(";")}),this.addCopy(this.props.mailingLists.vks.join(";"))))),s.a.createElement(Y.a,{className:"col-md-4"},s.a.createElement(K.a,{title:"Kader"},s.a.createElement("div",{className:"input-group"},s.a.createElement("input",{className:"form-control",readOnly:!0,value:this.props.mailingLists.squad.join(";")}),this.addCopy(this.props.mailingLists.squad.join(";")))))),s.a.createElement(W.a,null,s.a.createElement(Y.a,{className:"col-md-4"},s.a.createElement(K.a,{title:"Fahrer"},s.a.createElement("div",{className:"input-group"},s.a.createElement("input",{className:"form-control",readOnly:!0,value:this.props.mailingLists.drivers.join(";")}),this.addCopy(this.props.mailingLists.drivers.join(";"))))),s.a.createElement(Y.a,{className:"col-md-4"},s.a.createElement(K.a,{title:"Vorstand"},s.a.createElement("div",{className:"input-group"},s.a.createElement("input",{className:"form-control",readOnly:!0,value:this.props.mailingLists.vst.join(";")}),this.addCopy(this.props.mailingLists.vst.join(";"))))),s.a.createElement(Y.a,{className:"col-md-4"},s.a.createElement(K.a,{title:"Condor"},s.a.createElement("div",{className:"input-group"},s.a.createElement("input",{className:"form-control",readOnly:!0,value:this.props.mailingLists.con.join(";")}),this.addCopy(this.props.mailingLists.con.join(";"))))))))}}]),t}(i.Component),ut=Object(m.c)(function(e){return{mailingLists:e.data.mailingLists}},function(e,t){return{fetchMembers:function(){e(k.a.fetchMembers())},showError:function(t){e(y.a.showError(t))},showSuccess:function(t){e(y.a.showSuccess(t))}}})(lt),pt=Object(m.c)(function(e){return{data:e.data.collectionPoints,title:"Abholpunkte",panelActions:[s.a.createElement(he,{icon:"plus",to:"/draft/collection-point/add",roles:[P.a.DRAFT_CREATE,P.a.DRAFT_EDIT]})],viewLocation:"/collection-point/",tableColumns:[{text:"Name",keys:["name"],sortable:!0,searchable:!0},{text:"Abholpunkt",keys:["address","postcode","city"],link:!0,linkPrefix:"https://www.google.com/maps/search/",sortable:!0,searchable:!0}]}},function(e){return{fetchData:function(){e(k.a.fetchCollectionPoints())}}})(ue.a),dt=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(d.a)(this,Object(h.a)(t).call(this,e))).state={name:"",address:"",postcode:"",city:""},n.onInputChange=n.onInputChange.bind(Object(J.a)(n)),n.save=n.save.bind(Object(J.a)(n)),n}return Object(f.a)(t,e),Object(p.a)(t,[{key:"onInputChange",value:function(e){var t=e.target,n=t.value,a=t.name;this.setState(Object(ye.a)({},a,n))}},{key:"save",value:function(e){if(e.preventDefault(),this.formEl){var t=this.formEl.checkValidity();return this.formEl.className="was-validated",t&&(this.props.save({name:this.state.name,postcode:this.state.postcode,address:this.state.address,city:this.state.city}),this.props.history.push("/draft/collection-points")),t}return!1}},{key:"render",value:function(){var e=this;return s.a.createElement(F.a,{title:"Abholpunkt Hinzuf\xfcgen"},s.a.createElement(W.a,null,s.a.createElement(Y.a,null,s.a.createElement(K.a,null,s.a.createElement("form",{ref:function(t){return e.formEl=t}},s.a.createElement("h5",null,"Name"),s.a.createElement("input",{type:"text",name:"name",id:"name",className:"form-control",value:this.state.name,onChange:this.onInputChange,required:!0}),s.a.createElement("br",null),s.a.createElement("h5",null,"Addresse"),s.a.createElement("input",{type:"text",name:"address",id:"address",className:"form-control",value:this.state.address,onChange:this.onInputChange,required:!0}),s.a.createElement("br",null),s.a.createElement("h5",null,"PLZ"),s.a.createElement("input",{type:"text",minLength:4,maxLength:4,name:"postcode",id:"postcode",className:"form-control",value:this.state.postcode,onChange:this.onInputChange,required:!0}),s.a.createElement("br",null),s.a.createElement("h5",null,"Ort"),s.a.createElement("input",{type:"text",name:"city",id:"city",className:"form-control",value:this.state.city,onChange:this.onInputChange,required:!0}),s.a.createElement("br",null),s.a.createElement("button",{className:"btn btn-primary btn-block",onClick:this.save},"Speichern"))))))}}]),t}(i.Component),ht=Object(m.c)(function(){},function(e){return{save:function(t){e(k.a.addCollectionPoint(t))}}})(dt),ft=Object(m.c)(function(e){return{panelActions:[s.a.createElement(he,{icon:"plus",to:"/payouts/add",roles:[P.a.PAYOUTS_CREATE]})],data:e.data.payouts,viewLocation:"/payout/",title:"Auszahlungen",tableColumns:[{text:"Von",keys:["from"],sortable:!0,format:"toLocaleDateString"},{text:"Bis",keys:["until"],sortable:!0,format:"toLocaleDateString"},{text:"Total",keys:["totalWithoutMinus"],sortable:!0,prefix:"CHF ",format:"toFixed(2)"}]}},function(e){return{fetchData:function(){e(k.a.fetchPayouts())}}})(ue.a);function mt(e){return function(){var t,n=Object(h.a)(e);if(function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var a=Object(h.a)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return Object(d.a)(this,t)}}var bt=function(e){Object(f.a)(n,e);var t=mt(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).props.fetchPayouts(),a.elementView=a.elementView.bind(Object(J.a)(a)),a.showMailModal=a.showMailModal.bind(Object(J.a)(a)),a.showBexioModal=a.showBexioModal.bind(Object(J.a)(a)),a.hideModal=a.hideModal.bind(Object(J.a)(a)),a.sendMails=a.sendMails.bind(Object(J.a)(a)),a.sendToBexio=a.sendToBexio.bind(Object(J.a)(a)),a.onCheck=a.onCheck.bind(Object(J.a)(a)),a.reclaim=a.reclaim.bind(Object(J.a)(a)),a.transfer=a.transfer.bind(Object(J.a)(a)),a.state={modalShow:!1,modalType:"",selected:[]},a}return Object(p.a)(n,[{key:"hideModal",value:function(){var e=Object(le.a)(ce.a.mark(function e(){return ce.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.setState({modalShow:!1});case 1:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"showMailModal",value:function(){var e=Object(le.a)(ce.a.mark(function e(){return ce.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.setState({modalShow:!0,modalType:"mail"});case 1:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"showBexioModal",value:function(){var e=Object(le.a)(ce.a.mark(function e(){return ce.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.setState({modalShow:!0,modalType:"bexio"});case 1:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"sendMails",value:function(){var e=Object(le.a)(ce.a.mark(function e(){return ce.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.props.sendMails(this.props.payout.id,this.state.selected);case 2:this.setState({modalShow:!1});case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"sendToBexio",value:function(){var e=Object(le.a)(ce.a.mark(function e(){return ce.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.props.sendToBexio(this.props.payout.id,this.state.selected);case 2:this.setState({modalShow:!1});case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"reclaim",value:function(){var e=Object(le.a)(ce.a.mark(function e(){return ce.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.props.reclaim(this.props.payout.id));case 1:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"transfer",value:function(){var e=Object(le.a)(ce.a.mark(function e(){return ce.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.state.selected.length>0)){e.next=2;break}return e.abrupt("return",this.props.transfer(this.props.payout.id,this.state.selected));case 2:this.props.showError("Bitte zuerst auswahl t\xe4tigen!");case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"elementView",value:function(){var e=Object(le.a)(ce.a.mark(function e(t){var n;return ce.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),t.currentTarget.parentNode&&t.currentTarget.parentNode.parentNode&&t.currentTarget.parentNode.parentNode.parentElement&&(n=t.currentTarget.parentNode.parentNode.parentElement.getAttribute("data-key"),1==t.button?window.open(document.location.origin+this.props.history.location.pathname+"/".concat(n)):this.props.history.push(this.props.history.location.pathname+"/".concat(n)));case 2:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"onCheck",value:function(e){if(e.currentTarget.parentNode&&e.currentTarget.parentNode.parentNode&&e.currentTarget.parentNode.parentNode.parentElement){var t=e.currentTarget.parentNode.parentNode.parentElement.getAttribute("data-key");if(t){var n=parseInt(t);this.state.selected.indexOf(n)>-1?this.setState({selected:Object(ie.a)(this.state.selected.filter(function(e){return e!==n}))}):this.setState({selected:[].concat(Object(ie.a)(this.state.selected),[parseInt(t)])})}}}},{key:"renderCompensationsAddModal",value:function(){var e=this;return"mail"===this.state.modalType?0===this.state.selected.length?s.a.createElement(_e,{show:this.state.modalShow,header:s.a.createElement("h3",null,"E-Mails versenden"),body:s.a.createElement("span",null,"Willst du wirklich eine E-Mail ",s.a.createElement("b",null,"an alle")," mit der Entsch\xe4digungsauszahlung senden?"),footer:s.a.createElement(Le.a,null,s.a.createElement(pe.a,{variant:"success",onClick:this.sendMails},"Senden"),s.a.createElement(pe.a,{variant:"danger",onClick:this.hideModal},"Abbrechen"))}):s.a.createElement(_e,{show:this.state.modalShow,header:s.a.createElement("h3",null,"E-Mails versenden"),body:s.a.createElement("span",null,"Willst du wirklich eine E-Mail ",s.a.createElement("b",null,"an folgende Personen")," mit der Entsch\xe4digungsauszahlung senden?",s.a.createElement("ul",null,this.state.selected.map(function(t){var n=e.props.payout.compensationsByMember[t][0].member;return s.a.createElement("li",null,n.lastname," ",n.firstname)}))),footer:s.a.createElement(Le.a,null,s.a.createElement(pe.a,{variant:"success",onClick:this.sendMails},"Senden"),s.a.createElement(pe.a,{variant:"danger",onClick:this.hideModal},"Abbrechen"))}):"bexio"===this.state.modalType?0===this.state.selected.length?s.a.createElement(_e,{show:this.state.modalShow,header:s.a.createElement("h3",null,"Bexio \xdcbertrag"),body:s.a.createElement("span",null,"Willst du wirklich ",s.a.createElement("b",null,"alle")," Entsch\xe4digungen an Bexio \xfcbertragen?"),footer:s.a.createElement(Le.a,null,s.a.createElement(pe.a,{variant:"success",onClick:this.sendToBexio},"Ja"),s.a.createElement(pe.a,{variant:"danger",onClick:this.hideModal},"Nein"))}):s.a.createElement(_e,{show:this.state.modalShow,header:s.a.createElement("h3",null,"Bexio \xdcbertrag"),body:s.a.createElement("span",null,"Willst du wirklich ",s.a.createElement("b",null,"folgende Entsch\xe4digungen")," an Bexio \xfcbertragen?",s.a.createElement("ul",null,this.state.selected.map(function(t){var n=e.props.payout.compensationsByMember[t][0].member;return s.a.createElement("li",null,n.lastname," ",n.firstname)}))),footer:s.a.createElement(Le.a,null,s.a.createElement(pe.a,{variant:"success",onClick:this.sendToBexio},"Ja"),s.a.createElement(pe.a,{variant:"danger",onClick:this.hideModal},"Abbrechen"))}):null}},{key:"render",value:function(){var e=this;if(this.props.loading||!this.props.payout)return s.a.createElement(F.a,{title:"Loading..."},s.a.createElement(q.a,null));var t={},n=function(n){var a=e.props.payout.compensationsByMember[n],r=0;a.map(function(e){return r+=parseFloat(e.amount.toFixed(2))}),t[a[0].member.id]={id:a[0].member.id,member:a[0].member,total:r}};for(var a in this.props.payout.compensationsByMember)n(a);return s.a.createElement(F.a,{title:"Auszahlung ".concat(this.props.payout.from.toLocaleDateString()," - ").concat(this.props.payout.until.toLocaleDateString())},s.a.createElement(W.a,null,s.a.createElement(Y.a,{className:"col-md-6"},s.a.createElement(K.a,{title:"Informationen"},s.a.createElement(Ee,{id:"from",title:"Von",value:this.props.payout.from.toLocaleDateString(),type:"date"}),s.a.createElement(Ee,{id:"until",title:"Bis",value:this.props.payout.until.toLocaleDateString(),type:"date"}),s.a.createElement(Ee,{id:"countCompensations",title:"Anzahl Entsch\xe4diungen",value:this.props.payout.compensations.length,editable:!1}),s.a.createElement(Ee,{id:"total",title:"Total",value:"CHF ".concat(this.props.payout.total.toFixed(2))}),s.a.createElement(Ee,{id:"totalWithoutMinus",title:"Total ohne Minus",value:"CHF ".concat(this.props.payout.totalWithoutMinus.toFixed(2))}))),s.a.createElement(Y.a,{className:"col-md-6"},s.a.createElement(K.a,{title:"Actions"},s.a.createElement("a",{className:"btn btn-block btn-outline-primary",target:"_blank",href:"".concat(U.a.apiEndpoint,"/api/payouts/").concat(this.props.payout.id,"/pdf")},"PDF"),s.a.createElement(pe.a,{block:!0,variant:"outline-primary",roles:[P.a.PAYOUTS_SEND],onClick:this.showMailModal},"Best\xe4tigung E-Mails verschicken"),s.a.createElement(pe.a,{block:!0,variant:"outline-primary",roles:[P.a.PAYOUTS_SEND],onClick:this.showBexioModal},"An Bexio \xfcbertragen"),s.a.createElement(pe.a,{block:!0,variant:"outline-primary",onClick:function(){return e.props.getBankingXml(e.props.payout,e.state.selected)}},"Banking XML herunterladen"),s.a.createElement(pe.a,{block:!0,variant:"outline-primary",onClick:this.reclaim},"Neu Berechnen"),s.a.createElement(pe.a,{block:!0,variant:"outline-primary",roles:[P.a.PAYOUTS_SEND],onClick:function(){return e.transfer()}},"\xdcbertragen")))),s.a.createElement(W.a,null,s.a.createElement(Y.a,null,s.a.createElement(K.a,{title:"Entsch\xe4diungen"},s.a.createElement(Z.a,{columns:[{text:"Mitglied",keys:{member:["lastname","firstname"]},sortable:!0},{text:"Betrag",keys:["total"],prefix:"CHF ",sortable:!0,format:"toFixed(2)"},{text:"Actions",keys:["id"],content:s.a.createElement("div",{className:"btn-group"},s.a.createElement(pe.a,{variant:"success",className:"view",onClick:this.elementView},s.a.createElement(Q.a,{icon:"eye"})))}],checkable:!0,onCheck:this.onCheck,defaultSort:{keys:["_member.lastname","firstname"],direction:"asc"},data:t})))),this.renderCompensationsAddModal())}}]),n}(i.Component),vt=Object(m.c)(function(e,t){return{payout:e.data.payouts.byId[t.match.params.id],loading:e.data.payouts.loading}},function(e,t){var n=function(e,t){var n=window.URL.createObjectURL(e),a=document.createElement("a");a.href=n,a.download=t,document.body.appendChild(a),a.click(),document.body.removeChild(a)};return{fetchPayouts:function(){e(k.a.fetchPayouts())},sendMails:function(t,n){return e(k.a.sendPayoutMails(t,n))},sendToBexio:function(t,n){return e(k.a.sendToBexio(t,n))},reclaim:function(t){return e(k.a.reclaimPayout(t))},getBankingXml:function(){var t=Object(le.a)(ce.a.mark(function t(a,r){var o;return ce.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,k.a.sendToApi("post","".concat(U.a.apiEndpoint,"/api/payouts/xml"),{payoutId:a.id,memberIds:r},e,void 0,void 0,!1);case 2:return o=t.sent,n(new Blob([o]),"Soldperiode_".concat(a.from>new Date("1970-01-01")?a.from.toLocaleDateString():"","_-_").concat(a.until.toLocaleDateString(),".xml")),t.abrupt("return");case 5:case"end":return t.stop()}},t)}));return function(e,n){return t.apply(this,arguments)}}(),transfer:function(t,n){return k.a.sendToApi("post","".concat(U.a.apiEndpoint,"/api/payouts/transfer"),{payoutId:t,memberIds:n},e)},showError:function(t){return e(y.a.showError(t))}}})(bt),yt=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(d.a)(this,Object(h.a)(t).call(this,e))).props.payout&&n.props.member||n.props.fetchPayouts(),n.compensationView=n.compensationView.bind(Object(J.a)(n)),n}return Object(f.a)(t,e),Object(p.a)(t,[{key:"compensationView",value:function(e){if(e.currentTarget.parentNode&&e.currentTarget.parentNode.parentElement){var t=e.currentTarget.parentNode.parentElement.getAttribute("data-key");1==e.button?window.open(document.location.origin+"/compensation/"+t):this.props.history.push("/compensation/"+t)}}},{key:"render",value:function(){var e=this;if(this.props.loading||!this.props.payout)return s.a.createElement(F.a,{title:"Loading..."},s.a.createElement(q.a,null));var t=0;return this.props.member.compensations.map(function(e){return t+=parseFloat(e.amount.toFixed(2))}),s.a.createElement(F.a,{title:"Auszahlung ".concat(this.props.payout.from.toLocaleDateString()," - ").concat(this.props.payout.until.toLocaleDateString()," / ").concat(this.props.member.firstname," ").concat(this.props.member.lastname)},s.a.createElement(W.a,null,s.a.createElement(Y.a,{className:"col-md-6"},s.a.createElement(K.a,{title:"Informationen"},s.a.createElement(Ee,{id:"member",title:"Mitglied"},this.props.member.firstname," ",this.props.member.lastname),s.a.createElement(Ee,{id:"amountCompensations",title:"Anzahl Entsch\xe4digungen"},this.props.member.compensations.length),s.a.createElement(Ee,{id:"total",title:"Total"},"CHF ",t.toFixed(2)),s.a.createElement(Ee,{id:"payout",title:"Auszahlung"},this.props.payout.until.toLocaleDateString()))),s.a.createElement(Y.a,{className:"col-md-6"},s.a.createElement(K.a,{title:"Actions"},s.a.createElement(pe.a,{block:!0,variant:"outline-primary",onClick:Object(le.a)(ce.a.mark(function t(){return ce.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.props.memberPdf(e.props.payout.id,e.props.member);case 2:case"end":return t.stop()}},t)}))},"PDF")))),s.a.createElement(W.a,null,s.a.createElement(Y.a,null,s.a.createElement(K.a,{title:"Entsch\xe4digungen"},s.a.createElement(Z.a,{columns:[{text:"Datum",keys:["date"],sortable:!0,format:"toLocaleDateString"},{text:"Beschreibung",keys:["description"],sortable:!0},{text:"Betrag",keys:["amount"],prefix:"CHF ",sortable:!0,format:"toFixed(2)"},{text:"Genehmigt",keys:["approved"],sortable:!0},{text:"Ausbezahlt",keys:["paied"],sortable:!0},{text:"Actions",keys:["_id"],content:s.a.createElement($.a,{variant:"success",className:"view",onMouseUp:this.compensationView},s.a.createElement(Q.a,{icon:"eye"}))}],defaultSort:{keys:["date"],direction:"desc"},data:this.props.member.compensations})))))}}]),t}(i.Component),gt=Object(m.c)(function(e,t){var n=e.data.payouts.byId[t.match.params.id];return n?{payout:n,member:Object.assign({},n.compensationsByMember[t.match.params.memberId][0].member,{compensations:n.compensationsByMember[t.match.params.memberId]}),loading:e.data.payouts.loading}:{payout:n,member:{},loading:!1}},function(e,t){var n=function(e,t){var n=window.URL.createObjectURL(e),a=document.createElement("a");a.href=n,a.download=t,document.body.appendChild(a),a.click(),document.body.removeChild(a),setTimeout(function(){window.URL.revokeObjectURL(n)},100)};return{fetchPayouts:function(){e(k.a.fetchPayouts())},memberPdf:function(){var t=Object(le.a)(ce.a.mark(function t(a,r){var o;return ce.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,k.a.sendToApi("post","".concat(U.a.apiEndpoint,"/api/payouts/member/pdf"),{payoutId:a,memberId:r.id},e,void 0,{responseType:"arraybuffer"});case 2:return o=t.sent,n(new Blob([o],{type:"application/pdf"}),"Auszahlung Verkehrskadettenentsch\xe4digung ".concat(r.lastname," ").concat(r.firstname,".pdf")),t.abrupt("return");case 5:case"end":return t.stop()}},t)}));return function(e,n){return t.apply(this,arguments)}}()}})(yt),Et=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(d.a)(this,Object(h.a)(t).call(this,e))).onInputChange=n.onInputChange.bind(Object(J.a)(n)),n.onSave=n.onSave.bind(Object(J.a)(n)),n.state={from:"",until:""},n}return Object(f.a)(t,e),Object(p.a)(t,[{key:"validate",value:function(){if(this.formEl){var e=this.formEl.checkValidity();return this.formEl.className="was-validated",e}return!1}},{key:"onInputChange",value:function(e){var t=e.target,n="checkbox"===t.type?t.checked:t.value,a=t.name;this.setState(Object(ye.a)({},a,n))}},{key:"onSave",value:function(){var e=Object(le.a)(ce.a.mark(function e(t){return ce.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),!this.formEl){e.next=6;break}if(!this.validate()){e.next=6;break}return e.next=5,this.props.save({from:new Date(this.state.from||"01/01/1970"),until:new Date(this.state.until)});case 5:this.props.history.push("/payouts");case 6:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return s.a.createElement(F.a,{title:"Auszahlung hinzuf\xfcgen"},s.a.createElement(W.a,null,s.a.createElement(Y.a,null,s.a.createElement(K.a,null,s.a.createElement("form",{id:"addPayout",ref:function(t){e.formEl=t}},s.a.createElement("h5",null,"Von (optional)"),s.a.createElement("input",{name:"from",type:"date",className:"form-control",value:this.state.from,onChange:this.onInputChange}),s.a.createElement("br",null),s.a.createElement("h5",null,"Bis"),s.a.createElement("input",{name:"until",type:"date",className:"form-control",value:this.state.until,onChange:this.onInputChange,required:!0}),s.a.createElement("br",null),s.a.createElement(pe.a,{variant:"primary",block:!0,onClick:this.onSave},"Speichern"))))))}}]),t}(i.Component),Ot=Object(m.c)(function(){},function(e){return{save:function(t){e(k.a.addPayout(t))}}})(Et),kt=n(287);function Ct(e){return function(){var t,n=Object(h.a)(e);if(function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var a=Object(h.a)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return Object(d.a)(this,t)}}var St,jt=function(e){Object(f.a)(n,e);var t=Ct(n);function n(e){var a;Object(u.a)(this,n),(a=t.call(this,e)).deleteLogoff=a.deleteLogoff.bind(Object(J.a)(a)),a.deleteLogoffConfirmed=a.deleteLogoffConfirmed.bind(Object(J.a)(a)),a.showModal=a.showModal.bind(Object(J.a)(a)),a.hideModal=a.hideModal.bind(Object(J.a)(a)),a.excelExport=a.excelExport.bind(Object(J.a)(a)),a.onFilter=a.onFilter.bind(Object(J.a)(a)),a.getFilters=a.getFilters.bind(Object(J.a)(a)),a.onTableDataChange=a.onTableDataChange.bind(Object(J.a)(a));var r=new Date;return r.setHours(0,0,0,0),a.state={modalShow:!1,from:r,until:r,filter:"pending",tableData:{}},a}return Object(p.a)(n,[{key:"deleteLogoff",value:function(e){if(e.currentTarget.parentNode&&e.currentTarget.parentNode.parentNode&&e.currentTarget.parentNode.parentNode.parentElement){var t=e.currentTarget.parentNode.parentNode.parentElement.getAttribute("data-key");t&&this.setState({toDeleteLogoff:this.props.data.byId[t],modalShow:!0})}}},{key:"deleteLogoffConfirmed",value:function(){this.state.toDeleteLogoff&&(this.props.delete(this.state.toDeleteLogoff.id),this.setState({toDeleteLogoff:void 0,modalShow:!1}))}},{key:"showModal",value:function(){this.setState({modalShow:!0})}},{key:"hideModal",value:function(){this.setState({modalShow:!1})}},{key:"renderModal",value:function(){if(this.state.toDeleteLogoff){var e=this.state.toDeleteLogoff;return s.a.createElement(_e,{show:this.state.modalShow,onHide:this.hideModal,header:s.a.createElement("h3",null,"".concat(e.contact.firstname," ").concat(e.contact.lastname," (").concat(e.from.toLocaleDateString()," - ").concat(e.until.toLocaleDateString())),body:s.a.createElement("span",null,"Willst du die Abmeldung von \n                                ".concat(e.contact.firstname," ").concat(e.contact.lastname,"\n                                vom ").concat(e.from.toLocaleDateString()," bis ").concat(e.until.toLocaleDateString(),"\n                                wirklich l\xf6schen?")),footer:s.a.createElement(Le.a,null,s.a.createElement($.a,{variant:"danger",onClick:this.deleteLogoffConfirmed},"L\xf6schen"),s.a.createElement($.a,{variant:"secondary",onClick:this.hideModal},"Abbrechen"))})}return null}},{key:"excelExport",value:function(){var e=Object(le.a)(ce.a.mark(function e(t){var n,a,r,o=this;return ce.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=function(e,t){return(e=new Date(e.getTime())).setDate(e.getDate()+t),e},n=this.getFilters().find(function(e){return e.id===o.state.filter}),a=Object.keys(this.state.tableData).map(function(e){return o.state.tableData[e]}),n?function(){var e=[],t=[];if("custom"!==n.id)t=a.map(function(e){for(var t=[],n=new Date(e.from.getTime());n<=e.until;)t.push(n),n=r(n,1);return t}).reduce(function(e,t){return e.concat(t)},[]).sort(function(e,t){return e.getTime()-t.getTime()}).map(function(e){return e.toLocaleDateString()}).filter(function(e,t,n){return n.indexOf(e)===t});else for(var i=new Date(o.state.from.getTime());i<=o.state.until;)t.push(i.toLocaleDateString()),i=r(i,1);var s=function(n){var i=o.props.members.byId[n];if(i.functions&&(i.functions.indexOf("FHR")>-1&&i.functions.length>1||i.functions.indexOf("FHR")<0)){var s=a.filter(function(e){return e.contact.id.toString()===n}),c={Rang:i.rank||"",Funktionen:(i.functions||[]).join(","),Nachname:i.lastname,Vorname:i.firstname,Abholpunkt:"",AbholpunktAdresse:"",Adresse:"".concat(i.address,", ").concat(i.postcode," ").concat(i.city)};t.forEach(function(e){c[e]=""}),i.collectionPoint&&(c.Abholpunkt=i.collectionPoint.name,c.AbholpunktAdresse="".concat(i.collectionPoint.address,", ").concat(i.collectionPoint.postcode," ").concat(i.collectionPoint.city)),s.forEach(function(e){for(var n=new Date(e.from.getTime()),a=[];n<=e.until;)t.indexOf(n.toLocaleDateString())>-1&&a.push(n),(n=r(n,1)).setHours(0,0,0,0);(e.until.getHours()>0||e.until.getMinutes()>0)&&a.push(e.until),a.forEach(function(e){e.getHours()>0||e.getMinutes()>0?c[e.toLocaleDateString()]?c[e.toLocaleDateString()]="".concat(c[e.toLocaleDateString()]," - ").concat(e.toLocaleTimeString()):c[e.toLocaleDateString()]=e.toLocaleTimeString():c[e.toLocaleDateString()]="x"})}),e.push(c)}};for(var c in o.props.members.byId)s(c);var l=me.a.utils.json_to_sheet(e),u=me.a.utils.book_new();me.a.utils.book_append_sheet(u,l,"Abmeldungen"),"custom"===n.id?me.a.writeFile(u,"Abmeldungen ".concat(o.state.from.toLocaleDateString().replace(/\./g,"_"),"-").concat(o.state.until.toLocaleDateString().replace(/\./g,"_"),".xlsx")):me.a.writeFile(u,"Abmeldungen ".concat(n.displayName,".xlsx"))}():console.error("Couldn't find filter ".concat(this.state.filter));case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"onFilter",value:function(e){this.setState({filter:e})}},{key:"getFilters",value:function(){var e=this;return[{id:"all",displayName:"Alle ".concat("all"===this.state.filter?"(".concat(Object.keys(this.state.tableData).length,")"):""),filters:[{type:"any"}]},{id:"pending",displayName:"Offen ".concat("pending"===this.state.filter?"(".concat(Object.keys(this.state.tableData).length,")"):""),filters:[{type:"eq",value:"pending",key:"state"}]},{id:"approved",displayName:"Genehmigt ".concat("approved"===this.state.filter?"(".concat(Object.keys(this.state.tableData).length,")"):""),filters:[{type:"eq",value:"approved",key:"state"}]},{id:"declined",displayName:"Abgelehnt ".concat("declined"===this.state.filter?"(".concat(Object.keys(this.state.tableData).length,")"):""),filters:[{type:"eq",value:"declined",key:"state"}]},{id:"custom",displayName:"Custom ".concat("custom"===this.state.filter?"(".concat(Object.keys(this.state.tableData).length,")"):""),filterComponents:[s.a.createElement(kt.a,{size:"sm"},s.a.createElement(kt.a.Prepend,null,s.a.createElement(kt.a.Text,null,"Von/Bis")),s.a.createElement(ge.a,{type:"date",value:this.state.from,name:"from",editable:!0,onChange:function(t,n){e.setState({from:n})}}),s.a.createElement(ge.a,{type:"date",value:this.state.until,name:"until",editable:!0,onChange:function(t,n){e.setState({until:n})}}))],filters:[{type:"cu",filter:function(t){return t.from<=e.state.until&&t.until>=e.state.from}}]}]}},{key:"onTableDataChange",value:function(e){this.setState({tableData:e})}},{key:"shouldComponentUpdate",value:function(e,t){return JSON.stringify(this.state)!==JSON.stringify(t)||JSON.stringify(this.props)!==JSON.stringify(e)}},{key:"render",value:function(){return s.a.createElement(ue.a,{title:"Abmeldungen",viewLocation:"/draft/logoff/",panelActions:[s.a.createElement(he,{icon:"plus",to:"/draft/logoff/add",roles:[P.a.LOGOFFS_CREATE]}),s.a.createElement(he,{key:"excel-export",icon:"file-excel",onClick:this.excelExport,disabled:this.props.members.loading,loading:this.props.members.loading})],rowActions:[s.a.createElement("button",{className:"btn btn-danger delete",onMouseUp:this.deleteLogoff},s.a.createElement(Q.a,{icon:"trash"}))],tableColumns:[{text:"Mitglied",keys:{contact:["firstname","lastname"]},sortable:!0,searchable:!0},{text:"Von",keys:["from"],sortable:!0,format:"toLocaleString"},{text:"Bis",keys:["until"],sortable:!0,format:"toLocaleString"},{text:"Status",keys:["state"],sortable:!0}],data:this.props.data,fetchData:this.props.fetchData,history:this.props.history,defaultFilter:"pending",filters:this.getFilters(),onFilter:this.onFilter,onDataChange:this.onTableDataChange},this.renderModal())}}]),n}(i.Component),Nt=Object(m.c)(function(e){return{data:e.data.logoffs,members:e.data.members}},function(e){return{fetchData:function(){e(k.a.fetchLogoffs()),e(k.a.fetchMembers())},delete:function(t){e(k.a.deleteLogoff(t))}}})(jt);!function(e){e.APPROVED="approved",e.PENDING="pending",e.DECLINED="declined"}(St||(St={}));function wt(e){return function(){var t,n=Object(h.a)(e);if(function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var a=Object(h.a)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return Object(d.a)(this,t)}}var xt=function(e){Object(f.a)(n,e);var t=wt(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).approve=a.approve.bind(Object(J.a)(a)),a.decline=a.decline.bind(Object(J.a)(a)),a.renderActions=a.renderActions.bind(Object(J.a)(a)),a.props.fetchLogoffs(),a}return Object(p.a)(n,[{key:"approve",value:function(){return this.props.approve(this.props.logoff.id)}},{key:"decline",value:function(){return this.props.decline(this.props.logoff.id)}},{key:"renderActions",value:function(){var e=[s.a.createElement(X.a,{to:"/contact/"+this.props.logoff.contact.id,className:"btn btn-block btn-outline-primary"},"Kontakt \xf6ffnen")];return this.props.logoff.state===St.PENDING&&(e=[].concat(Object(ie.a)(e),[s.a.createElement(pe.a,{id:"approve",block:!0,variant:"outline-success",onClick:this.approve,roles:[P.a.LOGOFFS_APPROVE]},"Genehmigen"),s.a.createElement(pe.a,{id:"decline",block:!0,variant:"outline-danger",onClick:this.decline,roles:[P.a.LOGOFFS_APPROVE]},"Ablehnen")])),e}},{key:"render",value:function(){var e,t;if(!this.props.loading&&!this.props.logoff&&this.props.logoffIds.length>0)return s.a.createElement(ot,null);if(this.props.loading||!this.props.logoff)return s.a.createElement(F.a,{title:"Abmeldung"},s.a.createElement(q.a,null));var n="";switch(this.props.logoff.state){case St.PENDING:n="badge-warning";break;case St.APPROVED:n="badge-success";break;case St.DECLINED:n="badge-danger"}return s.a.createElement(F.a,{title:"Abmeldung"},s.a.createElement(W.a,null,s.a.createElement(Y.a,{className:"col-md-6"},s.a.createElement(K.a,{title:"Informationen"},s.a.createElement(Ee,{id:"contact",title:"Mitglied"},this.props.logoff.contact.firstname," ",this.props.logoff.contact.lastname),s.a.createElement(Ee,{id:"from",title:"Von"},this.props.logoff.from.toLocaleString()),s.a.createElement(Ee,{id:"until",title:"Bis"},this.props.logoff.until.toLocaleString()),s.a.createElement(Ee,{id:"state",title:"Status"},s.a.createElement("div",{className:"badge "+n},this.props.logoff.state)),s.a.createElement(Ee,{id:"creator",title:"Ersteller"},this.props.logoff.createdBy.displayName),s.a.createElement(Ee,{id:"changedStateBy",title:"Status ge\xe4ndert von"},null===(e=this.props.logoff)||void 0===e?void 0:null===(t=e.changedStateBy)||void 0===t?void 0:t.displayName),s.a.createElement(Ee,{id:"remarks",title:"Bemerkungen"},this.props.logoff.remarks))),s.a.createElement(Y.a,{className:"col-md-6"},s.a.createElement(K.a,{title:"Actions"},this.renderActions()))))}}]),n}(i.Component),At=Object(m.c)(function(e,t){return{logoff:e.data.logoffs.byId[t.match.params.id],logoffIds:e.data.logoffs.ids,loading:e.data.logoffs.loading}},function(e){return{fetchLogoffs:function(){return e(k.a.fetchLogoffs())},approve:function(t){return e(k.a.approveLogoff(t))},decline:function(t){return e(k.a.declineLogoff(t))}}})(xt),Rt=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(d.a)(this,Object(h.a)(t).call(this,e))).onSelectChange=n.onSelectChange.bind(Object(J.a)(n)),n.onInputChange=n.onInputChange.bind(Object(J.a)(n)),n.onSave=n.onSave.bind(Object(J.a)(n)),n.onLogoffChange=n.onLogoffChange.bind(Object(J.a)(n)),n.onNotifyChange=n.onNotifyChange.bind(Object(J.a)(n)),n.state={logoffs:[],notify:!0},n}return Object(f.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){this.props.fetchMembers()}},{key:"validate",value:function(){if(this.formEl){var e=this.formEl.checkValidity();return this.formEl.className="was-validated",e}return!1}},{key:"onSelectChange",value:function(e){e?this.setState({contact:e}):this.setState({contact:void 0})}},{key:"onInputChange",value:function(e){var t=e.target,n="checkbox"===t.type?t.checked:t.value,a=t.name;this.setState(Object(ye.a)({},a,n))}},{key:"onNotifyChange",value:function(e,t){this.setState(Object(ye.a)({},e,t))}},{key:"onSave",value:function(){var e=Object(le.a)(ce.a.mark(function e(t){return ce.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),!this.formEl){e.next=6;break}if(!this.validate()||!this.state.contact){e.next=6;break}return e.next=5,this.props.save({contact:this.state.contact.id,logoffs:this.state.logoffs,notify:this.state.notify});case 5:this.props.history.push("/draft/logoffs");case 6:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"onLogoffChange",value:function(e,t,n,a){var r=this.state.logoffs;if(a){var o={id:r.length.toString()};o[t]=n,o.state=St.APPROVED,r.push(o)}else{if(!e)return void this.props.error("Something failed... Refresh and please try again!");r[parseInt(e.toString())][t]=n}this.setState({logoffs:r})}},{key:"render",value:function(){var e=this;return this.props.loading||this.props.members.ids.length<1?s.a.createElement(F.a,{title:"Abmeldungen hinzuf\xfcgen"},s.a.createElement(q.a,null)):s.a.createElement(F.a,{title:"Abmeldungen hinzuf\xfcgen"},s.a.createElement(W.a,null,s.a.createElement(Y.a,null,s.a.createElement(K.a,null,s.a.createElement("form",{id:"addLogoffs",ref:function(t){e.formEl=t}},s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"col"},s.a.createElement("h5",null,"Mitglied"),s.a.createElement(We.a,{onChange:this.onSelectChange,required:!0})),s.a.createElement("div",{className:"col-1"},s.a.createElement("h5",null,"Benachrichtigen"),s.a.createElement(ge.a,{type:"checkbox",className:"d-flex justify-content-center",name:"notify",key:"notify",value:this.state.notify,onChange:this.onNotifyChange,editable:!0}))),s.a.createElement("br",null),s.a.createElement(Z.a,{columns:[{keys:["from"],text:"Von",editable:!0,type:"datetime",onChange:this.onLogoffChange,required:!0},{keys:["until"],text:"Bis",editable:!0,type:"datetime",onChange:this.onLogoffChange,required:!0},{keys:["state"],text:"Status",editable:!0,type:"select",options:["approved","pending","declined"],onChange:this.onLogoffChange,required:!0},{keys:["remarks"],text:"Bemerkungen",editable:!0,type:"text",onChange:this.onLogoffChange,required:!1}],addNew:!0,data:this.state.logoffs}),s.a.createElement($.a,{variant:"primary",block:!0,onClick:this.onSave},"Speichern"))))))}}]),t}(i.Component),Tt=Object(m.c)(function(e){return{members:e.data.members,loading:e.data.members.loading}},function(e){return{fetchMembers:function(){e(k.a.fetchMembers())},save:function(t){e(k.a.addLogoffs(t))},error:function(t){e(y.a.showError(t))}}})(Rt);function It(e){return function(){var t,n=Object(h.a)(e);if(function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var a=Object(h.a)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return Object(d.a)(this,t)}}var Dt=function(e){Object(f.a)(n,e);var t=It(n);function n(e,a){var r;Object(u.a)(this,n),r=t.call(this,e,a),U.a.loadConfig(),r.history=Object(H.a)({basename:"/webapp/"});var o=D(r.history),i=o.store,s=o.persistor;return r.store=i,r.persistor=s,r.store.getState(),r}return Object(p.a)(n,[{key:"render",value:function(){return s.a.createElement(m.a,{store:this.store},s.a.createElement(z.a,{persistor:this.persistor,loading:s.a.createElement(q.a,null)},s.a.createElement("div",{className:"body"},s.a.createElement(g.ToastContainer,{position:"top-center",autoClose:5e3,hideProgressBar:!1,newestOnTop:!0,closeOnClick:!0,rtl:!1,draggable:!0,pauseOnHover:!0}),s.a.createElement(w.a,{history:this.history},s.a.createElement(_.a,null,s.a.createElement(L.a,{exact:!0,path:"/",component:function(){return s.a.createElement(M.a,{to:"/login"})}}),s.a.createElement(L.a,{exact:!0,path:"/login",component:Ue}),s.a.createElement(L.a,{exact:!0,path:"/login?source=:source",component:Ue}),s.a.createElement(V,{exact:!0,path:"/dashboard",roles:[P.a.AUTHENTICATED],component:oe}),s.a.createElement(V,{exact:!0,path:"/members",roles:[P.a.MEMBERS_READ],component:ve}),s.a.createElement(V,{exact:!0,path:"/mailing-lists",roles:[P.a.MAILING_LISTS],component:ut}),s.a.createElement(V,{exact:!0,path:"/draft/collection-points",roles:[P.a.DRAFT_READ],component:pt}),s.a.createElement(V,{exact:!0,path:"/draft/collection-point/add",roles:[P.a.DRAFT_EDIT,P.a.DRAFT_CREATE],component:ht}),s.a.createElement(V,{exact:!0,path:"/draft/logoffs",roles:[P.a.LOGOFFS_READ],component:Nt}),s.a.createElement(V,{exact:!0,path:"/draft/logoff/add",roles:[P.a.LOGOFFS_CREATE],component:Tt}),s.a.createElement(V,{exact:!0,path:"/draft/logoff/:id",roles:[P.a.LOGOFFS_READ,P.a.AUTHENTICATED],component:At}),s.a.createElement(V,{exact:!0,path:"/contact/:id",roles:[P.a.CONTACTS_READ,P.a.MEMBERS_READ,P.a.AUTHENTICATED],component:xe}),s.a.createElement(V,{exact:!0,path:"/orders",roles:[P.a.ORDERS_READ],component:Ae}),s.a.createElement(V,{exact:!0,path:"/order/:id",roles:[P.a.ORDERS_READ],component:Te}),s.a.createElement(V,{exact:!0,path:"/billing-reports",roles:[P.a.BILLINGREPORTS_READ,P.a.BILLINGREPORTS_CREATE],component:Ie}),s.a.createElement(V,{exact:!0,path:"/billing-reports/add",roles:[P.a.BILLINGREPORTS_CREATE],component:Be.a}),s.a.createElement(V,{exact:!0,path:"/billing-report/:id",roles:[P.a.BILLINGREPORTS_CREATE,P.a.BILLINGREPORTS_READ],component:et}),s.a.createElement(V,{exact:!0,path:"/compensations",roles:[P.a.COMPENSATIONS_READ],component:Fe}),s.a.createElement(V,{exact:!0,path:"/compensations/add",roles:[P.a.COMPENSATIONS_CREATE],component:at}),s.a.createElement(V,{exact:!0,path:"/compensation/:id",roles:[P.a.COMPENSATIONS_READ,P.a.AUTHENTICATED],component:ct}),s.a.createElement(V,{exact:!0,path:"/payouts",roles:[P.a.PAYOUTS_READ],component:ft}),s.a.createElement(V,{exact:!0,path:"/payouts/add",roles:[P.a.PAYOUTS_CREATE],component:Ot}),s.a.createElement(V,{exact:!0,path:"/payout/:id",roles:[P.a.PAYOUTS_READ],component:vt}),s.a.createElement(V,{exact:!0,path:"/payout/:id/:memberId",roles:[P.a.PAYOUTS_READ],component:gt}),s.a.createElement(V,{exact:!0,path:"/users",roles:[P.a.ADMIN],component:He}),s.a.createElement(V,{exact:!0,path:"/user/:id",roles:[P.a.ADMIN],component:qe}),s.a.createElement(L.a,{path:"/*",component:ot}))))))}}]),n}(i.Component),_t=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function Lt(e,t){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See http://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}}).catch(function(e){console.error("Error during service worker registration:",e)})}l.a.render(s.a.createElement(Dt,null),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/webapp",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",function(){var t="".concat("/webapp","/service-worker.js");_t?(function(e,t){fetch(e).then(function(n){var a=n.headers.get("content-type");404===n.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):Lt(e,t)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(t,e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit http://bit.ly/CRA-PWA")})):Lt(t,e)})}}()},33:function(e,t,n){"use strict";n.d(t,"a",function(){return v});var a=n(6),r=n(9),o=n(5),i=n(11),s=n(4),c=n(10),l=n(0),u=n.n(l),p=n(25),d=n(65),h=n(51);function f(e){if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(!e)return;if("string"===typeof e)return m(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return m(e,t)}(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,r,o=!0,i=!1;return{s:function(){a=e[Symbol.iterator]()},n:function(){var e=a.next();return o=e.done,e},e:function(e){i=!0,r=e},f:function(){try{o||null==a.return||a.return()}finally{if(i)throw r}}}}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function b(e){return function(){var t,n=Object(s.a)(e);if(function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var a=Object(s.a)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return Object(i.a)(this,t)}}var v=function(e){Object(c.a)(n,e);var t=b(n);function n(e){var r;return Object(a.a)(this,n),(r=t.call(this,e)).sortClick=r.sortClick.bind(Object(o.a)(r)),r.search=r.search.bind(Object(o.a)(r)),r.ref=r.ref.bind(Object(o.a)(r)),r.onColumnDataChange=r.onColumnDataChange.bind(Object(o.a)(r)),r.props.defaultSort?r.state={sortKey:r.props.defaultSort.keys.join("-"),sortDirection:r.props.defaultSort.direction,searchableKeys:r.genSearchKeys(r.props.columns),filter:r.props.defaultFilter||(r.props.filters||[{id:""}])[0].id}:r.state={sortKey:"",sortDirection:"asc",searchableKeys:r.genSearchKeys(r.props.columns),filter:r.props.defaultFilter||(r.props.filters||[{id:""}])[0].id},r}return Object(r.a)(n,[{key:"onColumnDataChange",value:function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=this.props.columns.find(function(t){var n="";if(t.keys instanceof Array)n=t.keys.join("-");else for(var a in t.keys)n+="_"+a+"."+t.keys[a].join("-");return n===e});r&&r.onChange&&r.onChange(t,e,n,a)}},{key:"componentDidUpdate",value:function(e){e!==this.props&&this.setState({searchableKeys:this.genSearchKeys(this.props.columns),filter:this.props.defaultFilter})}},{key:"ref",value:function(e){this.props.ref&&this.props.ref(e)}},{key:"goDownFilterKey",value:function(e,t){return"string"===typeof t?e[t]:this.goDownFilterKey(e[Object.keys(t)[0]],t[Object.keys(t)[0]])}},{key:"filterMatcher",value:function(e,t){switch(e.type){case"eq":return e.value instanceof RegExp?e.value.test(t.toString()):t.toString()===e.value;case"lt":return t<e.value;case"lte":return t<=e.value;case"gt":return t>e.value;case"gte":return t>=e.value}}},{key:"filter",value:function(e,t){var n=this;if(t=t||this.props.data){if(this.props.filters){var a=this.props.filters.find(function(t){return t.id===e});if(a){if(a.filters.find(function(e){return"any"===e.type}))return t;if(t instanceof Array)return t.filter(function(e){for(var t=!0,r=0,o=a.filters.length;t&&r<o;){var i=a.filters[r];if("cu"===i.type)t=i.filter(e);else{var s=n.goDownFilterKey(e,i.key);t=n.filterMatcher(i,s)}r+=1}return t});var r=Object.keys(t).filter(function(e){for(var r=t[e],o=!0,i=0,s=a.filters.length;o&&i<s;){var c=a.filters[i];if("cu"===c.type)o=c.filter(r);else{var l=n.goDownFilterKey(r,c.key);o=n.filterMatcher(c,l)}i+=1}return o}),o={};return r.forEach(function(e){o[e]=t[e]}),o}}return t}return[]}},{key:"sort",value:function(e,t,n){var a=this.genSortKeys(e),r=[];for(var o in n=n||this.props.data){var i=n[o],s=[];for(var c in a){var l=a[c];if(l instanceof Array){var u,p=f(l);try{for(p.s();!(u=p.n()).done;){var d=u.value;i[c]&&(d.indexOf("phone")>-1?s.push(i[c][d].replace(" ","")):i[l]instanceof Date?s.push(i[l].getTime()):s.push(i[c][d]))}}catch(y){p.e(y)}finally{p.f()}}else l.indexOf("phone")>-1?s.push(i[l].replace(" ","")):i[l]instanceof Date?s.push(i[l].getTime()):s.push(i[l])}r.push({id:o,value:s.join(" ").toLowerCase()})}r.sort(function(e,n){var a,r;return a=parseFloat(e.value),r=parseFloat(n.value),(isNaN(a)||isNaN(r))&&(a=e.value,r=n.value),a<r?"asc"===t?-1:1:a>r?"asc"===t?1:-1:0});for(var h={},m=0,b=r;m<b.length;m++){var v=b[m];h["_".concat(v.id)]=this.props.data[v.id]}return h}},{key:"genSortKeys",value:function(e){var t=[e];e.indexOf("_")>-1&&(t=e.split("_"));var n,a={},r=f(t);try{for(r.s();!(n=r.n()).done;){var o=n.value;o&&(o.indexOf(".")>-1?a[o.split(".")[0]]=o.split(".")[1].split("-"):a=o.split("-"))}}catch(i){r.e(i)}finally{r.f()}return a}},{key:"sortClick",value:function(e){var t=e.target.dataset.key;t||(t=e.target.parentElement.dataset.key);var n="asc";this.state.sortKey===t&&(n="asc"===this.state.sortDirection?"desc":"asc"),this.props.onSort&&this.props.onSort(e,this.genSortKeys(t),n),this.setState({sortDirection:n,sortKey:t})}},{key:"genSearchKeys",value:function(e){var t,n=[],a=f(e);try{for(a.s();!(t=a.n()).done;){var r=t.value;r.searchable&&(r.keys instanceof Array?n=n.concat(r.keys):n.push(r.keys))}}catch(o){a.e(o)}finally{a.f()}return n}},{key:"search",value:function(e,t){var n={};if(t=t||this.props.data,e&&this.state.searchableKeys.length>0){for(var a in t){var r,o=t[a],i="",s=f(this.state.searchableKeys);try{for(s.s();!(r=s.n()).done;){var c=r.value;if(c instanceof Object)for(var l in c){var u,p=f(c[l]);try{for(p.s();!(u=p.n()).done;){var d=u.value;o[l]&&o[l][d]&&(d.indexOf("phone")>-1&&(i+=o[l][d].toString().replace(" ","")+" "),i+=o[l][d].toString()+" ")}}catch(h){p.e(h)}finally{p.f()}}else"string"===typeof c&&o.hasOwnProperty(c)&&null!==o[c]&&(c.indexOf("phone")>-1&&(i+=o[c].toString().replace(" ","")+" "),i+=o[c].toString()+" ")}}catch(h){s.e(h)}finally{s.f()}i.toLowerCase().indexOf(e.toLowerCase())>-1&&!n.hasOwnProperty(a)&&(n[a]=o)}return n}return t}},{key:"renderColumnValues",value:function(e,t){var n=this;if("boolean"===typeof e)return e?"\u2713":"\u2a2f";if(e instanceof Array)return e.map(function(e){return n.renderColumnValues(e,t)}).join(",");if(t.format){var a,r=t.format;if(t.format.indexOf("(")>-1&&t.format.indexOf(")")>-1){var o=t.format.match(/(\w+)\((.*)\)/);o&&o.length>2&&(r=o[1],a=o[2])}if(e[r])return e[r](a)}return(e||"").toString()}},{key:"renderRows",value:function(){var e=this,t=[],n=this.filter(this.state.filter||"");n=this.search(this.props.searchString||"",n),n=this.sort(this.state.sortKey,this.state.sortDirection,n),this.props.onDataChange&&this.props.onDataChange(n);var a=function(a){var r=n[a],o=[];e.props.checkable&&o.push(u.a.createElement("td",{style:{width:"40px"}},u.a.createElement(d.a,{onChange:e.props.onCheck||function(){}})));var i,s=f(e.props.columns);try{var c=function(){var t=i.value,n=t.keys instanceof Array?t.keys.join("-"):Object.keys(t.keys).map(function(e){return t.keys[e].join("-")}).join("-");if(t.content)o.push(u.a.createElement("td",{key:n},t.content||""));else{var a=[];if(t.keys instanceof Array)a=t.keys.map(function(n){return e.renderColumnValues(r[n],t)});else{var s=function(o){n="".concat(n).concat(o),a=a.concat(t.keys[o].map(function(n){return r.hasOwnProperty(o)&&r[o]?e.renderColumnValues(r[o][n],t):""}))};for(var c in t.keys)s(c)}t.link?o.push(u.a.createElement("td",{className:t.className||"",key:"".concat(r.id,"-").concat(n)},u.a.createElement("a",{key:"".concat(r.id,"-").concat(n,"-a"),href:(t.linkPrefix?t.linkPrefix:"")+a.join(" "),target:t.linkPrefix&&(t.linkPrefix.match(/w+:/i)||[]).length>0?"":"_blank"},(t.prefix?t.prefix:"")+a.join(" ")+(t.suffix?t.suffix:"")))):t.editable?o.push(u.a.createElement("td",{className:t.className||"",key:"".concat(r.id,"-").concat(n)},u.a.createElement(h.a,{name:n,value:a.join(" "),editable:!0,type:t.type,onChange:function(t,a){return e.onColumnDataChange(n,r.id,a)},options:t.options,required:t.required}))):o.push(u.a.createElement("td",{className:t.className||"",key:"".concat(r.id,"-").concat(n)},"".concat(t.prefix||"").concat(a.join(" ")).concat(t.suffix||"")))}};for(s.s();!(i=s.n()).done;)c()}catch(p){s.e(p)}finally{s.f()}var l=a;e.props.data instanceof Array&&(l=r.id.toString()),t.push(u.a.createElement("tr",{key:l,"data-key":l.replace(/^_/,"")},o))};for(var r in n)a(r);if(this.props.addNew){var o,i=Object.keys(this.props.data).length,s=[],c=f(this.props.columns);try{var l=function(){var t=o.value,n="";n=t.keys instanceof Array?t.keys.join("-"):Object.keys(t.keys).join("-"),t.editable?s.push(u.a.createElement("td",{className:t.className||"",key:"".concat(i,"-").concat(n)},u.a.createElement(h.a,{name:"".concat(i,"-").concat(n),value:"",editable:!0,type:t.type,onChange:function(t,a){return e.onColumnDataChange(n,null,a,!0)},options:t.options}))):s.push(u.a.createElement("td",{className:t.className||"",key:"".concat(i,"-").concat(n)}))};for(c.s();!(o=c.n()).done;)l()}catch(p){c.e(p)}finally{c.f()}t.push(u.a.createElement("tr",{key:i},s))}return t}},{key:"render",value:function(){var e=this;return u.a.createElement("div",{className:"table-responsive"},u.a.createElement("table",{className:"table table-striped ".concat(this.props.className||""),ref:this.ref},u.a.createElement("thead",{key:"table-head"},u.a.createElement("tr",{key:"table-head-row"},this.props.checkable?u.a.createElement("th",null):"",this.props.columns.map(function(t){var n,a="";if(t.keys instanceof Array)a=t.keys.join("-");else for(var r in t.keys)a+="_"+r+"."+t.keys[r].join("-");return a===e.state.sortKey&&(n="asc"===e.state.sortDirection?u.a.createElement(p.a,{icon:"sort-down",className:"float-right"}):u.a.createElement(p.a,{icon:"sort-up",className:"float-right"})),t.sortable?u.a.createElement("th",{key:a,"data-key":a,scope:"col",onClick:e.sortClick,style:{cursor:"pointer"}},t.text,n):u.a.createElement("th",{key:a,"data-key":a,scope:"col"},t.text)}))),u.a.createElement("tbody",{key:"table-body"},this.renderRows())))}}]),n}(l.Component)},38:function(e,t,n){"use strict";(function(e){n.d(t,"a",function(){return S});var a=n(6),r=n(9),o=n(5),i=n(11),s=n(4),c=n(10),l=n(0),u=n.n(l),p=n(20),d=n(22),h=n(16),f=n(18),m=n(33),b=n(25),v=n(24),y=n(285),g=n(281),E=n(286);function O(e){if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(!e)return;if("string"===typeof e)return k(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return k(e,t)}(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,r,o=!0,i=!1;return{s:function(){a=e[Symbol.iterator]()},n:function(){var e=a.next();return o=e.done,e},e:function(e){i=!0,r=e},f:function(){try{o||null==a.return||a.return()}finally{if(i)throw r}}}}function k(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function C(e){return function(){var t,n=Object(s.a)(e);if(function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var a=Object(s.a)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return Object(i.a)(this,t)}}var S=function(t){Object(c.a)(i,t);var n=C(i);function i(t){var r;return Object(a.a)(this,i),(r=n.call(this,t)).props.data.loading||e(function(){r.props.fetchData()}),r.elementView=r.elementView.bind(Object(o.a)(r)),r.textSearch=r.textSearch.bind(Object(o.a)(r)),r.onSort=r.onSort.bind(Object(o.a)(r)),r.onFilter=r.onFilter.bind(Object(o.a)(r)),r.state={searchString:"",sort:{keys:r.props.data.sort.keys,direction:r.props.data.sort.direction},filter:r.props.defaultFilter||(r.props.filters||[{id:""}])[0].id},r}return Object(r.a)(i,[{key:"elementView",value:function(e){if(e.currentTarget.parentNode&&e.currentTarget.parentNode.parentNode&&e.currentTarget.parentNode.parentNode.parentElement){var t=e.currentTarget.parentNode.parentNode.parentElement.getAttribute("data-key");1==e.button?window.open(document.location.origin+this.props.viewLocation+t):this.props.history.push(this.props.viewLocation+t)}}},{key:"shouldComponentUpdate",value:function(e,t){return this.props!==e||(this.state.searchString!==t.searchString||this.state.filter!==t.filter)}},{key:"onSort",value:function(e,t,n){this.setState({sort:{keys:t,direction:n}})}},{key:"onFilter",value:function(e){this.props.onFilter&&this.props.onFilter(e),this.setState({filter:e})}},{key:"textSearch",value:function(e){this.props.onSearch&&this.props.onSearch(e.target.value),this.setState({searchString:e.target.value})}},{key:"renderFilters",value:function(){var e=this;if(this.props.filters){var t=this.props.filters.find(function(t){return t.id===e.state.filter}),n=[];return t&&"filterComponents"in t&&(n=t.filterComponents),u.a.createElement(u.a.Fragment,null,u.a.createElement(y.a,{className:"filters"},this.props.filters.map(function(t){return u.a.createElement(g.a,{variant:"outline-secondary",active:t.id===e.state.filter,onClick:function(){return e.onFilter(t.id)}},t.displayName)})),n)}return u.a.createElement(y.a,null)}},{key:"renderTable",value:function(){if(this.props.data.loading&&0===this.props.data.ids.length)return u.a.createElement(v.a,null);var e,t={},n=O(this.props.data.ids);try{for(n.s();!(e=n.n()).done;){var a=e.value;t[a]=this.props.data.byId[a]}}catch(r){n.e(r)}finally{n.f()}return u.a.createElement(m.a,{columns:this.props.tableColumns.concat([{text:"Actions",keys:["id"],content:u.a.createElement("div",{className:"btn-group"},u.a.createElement("button",{className:"btn btn-success view",onMouseUp:this.elementView},u.a.createElement(b.a,{icon:"eye"})),this.props.rowActions)}]),data:t,defaultSort:this.state.sort,searchString:this.state.searchString,onSort:this.onSort,filters:this.props.filters,defaultFilter:this.state.filter,onDataChange:this.props.onDataChange})}},{key:"render",value:function(){var e=this;return u.a.createElement(p.a,{title:this.props.title},u.a.createElement(d.a,null,u.a.createElement(h.a,null,u.a.createElement(f.a,{actions:this.props.panelActions||[],title:u.a.createElement(E.a,{className:"justify-content-between align-items-center"},this.renderFilters(),this.props.additionalTitleStuff||[],u.a.createElement("input",{id:"search",value:this.state.searchString,placeholder:"Search...",className:"form-control form-control-sm",onChange:function(t){return e.textSearch(t)}}))},this.renderTable()))),this.props.children)}}]),i}(l.Component)}).call(this,n(93).setImmediate)},51:function(e,t,n){"use strict";n.d(t,"a",function(){return h});var a=n(6),r=n(9),o=n(11),i=n(4),s=n(10),c=n(0),l=n.n(c),u=n(65),p=n(113),d=n.n(p),h=(n(203),function(e){function t(){return Object(a.a)(this,t),Object(o.a)(this,Object(i.a)(t).apply(this,arguments))}return Object(s.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e,t=this,n=function(e,t){};switch(this.props.onChange&&(n=this.props.onChange),this.props.type){case"checkbox":return l.a.createElement(u.a,{checked:this.props.value,editable:this.props.editable,onChange:function(e){return n(t.props.name,e.target.checked)},label:"",required:!!this.props.required,"aria-describedby":this.props.name,className:this.props.className});case"textarea":return l.a.createElement("textarea",{name:this.props.name,value:this.props.value,onChange:function(e){return n(t.props.name,e.target.value)},className:"form-entry form-control"+(this.props.editable?"":"-plaintext")+" ".concat(this.props.className),readOnly:!this.props.editable,required:!!this.props.required,"aria-describedby":this.props.name});case"date":return e=this.props.value,"string"===typeof this.props.value&&(e=new Date(this.props.value)),""===this.props.value&&(e=null),this.props.editable?l.a.createElement(d.a,{name:this.props.name,onChange:function(e,a){return n(t.props.name,e)},selected:e,className:"form-entry form-control"+" ".concat(this.props.className),allowSameDay:!0,required:!!this.props.required,dateFormat:"dd.MM.yyyy",disabledKeyboardNavigation:!0,"aria-describedby":this.props.name}):e instanceof Date?e.toLocaleDateString():"";case"datetime":return e=this.props.value,"string"===typeof this.props.value&&(e=new Date(this.props.value)),""===this.props.value&&(e=null),this.props.editable?l.a.createElement(d.a,{name:this.props.name,onChange:function(e,a){return n(t.props.name,e)},selected:e,showTimeSelect:!0,className:"form-entry form-control"+" ".concat(this.props.className),required:!!this.props.required,timeFormat:"HH:mm",dateFormat:"dd.MM.yyyy HH:mm",disabledKeyboardNavigation:!0,shouldCloseOnSelect:!1,"aria-describedby":this.props.name}):e instanceof Date?e.toLocaleString():"";case"select":if(this.props.options)return l.a.createElement("select",{name:this.props.name,value:this.props.value,onChange:function(e){return n(t.props.name,e.target.value)},className:"form-entry form-control"+(this.props.editable?"":"-plaintext")+" ".concat(this.props.className),required:!!this.props.required,"aria-describedby":this.props.name},this.props.options.map(function(e){return l.a.createElement("option",{value:e},e)}));default:return l.a.createElement("input",{name:this.props.name,type:this.props.type||"text",value:this.props.value,onChange:function(e){return n(t.props.name,e.target.value)},className:"form-entry form-control"+(this.props.editable?"":"-plaintext")+" ".concat(this.props.className),readOnly:!this.props.editable,required:!!this.props.required,"aria-describedby":this.props.name})}}}]),t}(c.Component))},54:function(e,t,n){"use strict";n.d(t,"a",function(){return f});var a=n(6),r=n(9),o=n(11),i=n(4),s=n(10),c=n(0),l=n.n(c),u=n(8),p=n(59),d=n(15),h=function(e){function t(e){var n;if(Object(a.a)(this,t),(n=Object(o.a)(this,Object(i.a)(t).call(this,e))).props.defaultValue instanceof Array){var r=[],s=!0,c=!1,l=void 0;try{for(var u,p=n.props.defaultValue[Symbol.iterator]();!(s=(u=p.next()).done);s=!0){var d=u.value;r.push({value:d.id.toString(),label:d.firstname+" "+d.lastname})}}catch(h){c=!0,l=h}finally{try{s||null==p.return||p.return()}finally{if(c)throw l}}n.state={value:r}}else n.state={};return n}return Object(s.a)(t,e),Object(r.a)(t,[{key:"componentDidUpdate",value:function(){if(this.props.defaultValue instanceof Array){var e=[],t=!0,n=!1,a=void 0;try{for(var r,o=this.props.defaultValue[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){var i=r.value;e.push({value:i.id.toString(),label:i.firstname+" "+i.lastname})}}catch(s){n=!0,a=s}finally{try{t||null==o.return||o.return()}finally{if(n)throw a}}JSON.stringify(this.state.value)!==JSON.stringify(e)&&this.setState({value:e})}}},{key:"componentWillMount",value:function(){this.props.members.ids.length<1&&this.props.fetchMembers()}},{key:"prepareOptions",value:function(){var e=[];if(Object.keys(this.props.members.byId).length>0)for(var t in this.props.members.byId){var n=this.props.members.byId[t];e.push({label:n.firstname+" "+n.lastname,value:t})}return e}},{key:"onChange",value:function(e){var t=[e];this.props.isMulti&&(t=e),this.setState({value:t});var n=[],a=!0,r=!1,o=void 0;try{for(var i,s=t[Symbol.iterator]();!(a=(i=s.next()).done);a=!0){var c=i.value;c?n.push(this.props.members.byId[c.value]):n.push(void 0)}}catch(l){r=!0,o=l}finally{try{a||null==s.return||s.return()}finally{if(r)throw o}}this.props.onChange&&(this.props.isMulti?this.props.onChange(n):this.props.onChange(n[0]))}},{key:"prepareValue",value:function(){return this.props.isMulti?this.state.value||[]:(this.state.value||[])[0]}},{key:"render",value:function(){var e=this;return this.props.loading?null:l.a.createElement(p.a,{ref:function(t){e.props.ref&&e.props.ref(t)},isClearable:!0,options:this.prepareOptions(),backspaceRemovesValue:!0,hideSelectedOptions:!0,openMenuOnFocus:!0,isMulti:this.props.isMulti||!1,onChange:this.onChange.bind(this),value:this.prepareValue(),required:!!this.props.required})}}]),t}(c.Component),f=Object(d.c)(function(e,t){return{members:e.data.members,loading:e.data.members.loading}},function(e,t){return{fetchMembers:function(){e(u.a.fetchMembers())}}})(h)},58:function(e,t,n){"use strict";n.d(t,"a",function(){return m});var a=n(3),r=n.n(a),o=n(14),i=n(6),s=n(9),c=n(11),l=n(4),u=n(5),p=n(10),d=n(0),h=n.n(d),f=n(23),m=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(c.a)(this,Object(l.a)(t).call(this,e))).previousStep=n.previousStep.bind(Object(u.a)(n)),n.nextStep=n.nextStep.bind(Object(u.a)(n)),n.renderBackButton=n.renderBackButton.bind(Object(u.a)(n)),n}return Object(p.a)(t,e),Object(s.a)(t,[{key:"nextStep",value:function(){var e=Object(o.a)(r.a.mark(function e(){var t;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=!0,!this.props.onNextStep){e.next=5;break}return e.next=4,this.props.onNextStep();case 4:t=e.sent;case 5:t&&this.props.nextStep&&this.props.nextStep();case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"previousStep",value:function(){var e=Object(o.a)(r.a.mark(function e(){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.props.onPreviousStep){e.next=3;break}return e.next=3,this.props.onPreviousStep();case 3:this.props.previousStep&&this.props.previousStep();case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"renderBackButton",value:function(){return(this.props.currentStep||0)>1?h.a.createElement(f.a,{variant:"secondary",onClick:this.previousStep},"Zur\xfcck"):h.a.createElement("div",null)}},{key:"render",value:function(){var e="Weiter",t="btn btn-primary";return this.props.currentStep===this.props.totalSteps&&(e="Speichern",t="btn btn-success"),h.a.createElement("div",null,h.a.createElement("div",{className:"wizard-step-header"},h.a.createElement("h4",null,this.props.title)),h.a.createElement("div",{className:"wizard-step-body"},this.props.children),h.a.createElement("div",{className:"d-flex justify-content-between wizard-step-footer"},this.renderBackButton(),h.a.createElement(f.a,{className:t,onClick:this.nextStep},e)))}}]),t}(d.Component)},65:function(e,t,n){"use strict";n.d(t,"a",function(){return d});var a=n(6),r=n(9),o=n(5),i=n(11),s=n(4),c=n(10),l=n(0),u=n.n(l);function p(e){return function(){var t,n=Object(s.a)(e);if(function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var a=Object(s.a)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return Object(i.a)(this,t)}}var d=function(e){Object(c.a)(n,e);var t=p(n);function n(e){var r;return Object(a.a)(this,n),(r=t.call(this,e)).onCheck=r.onCheck.bind(Object(o.a)(r)),r.state={checked:r.props.checked||!1},r}return Object(r.a)(n,[{key:"onCheck",value:function(e){!0!==this.props.editable&&void 0!==this.props.editable||(this.setState({checked:!this.state.checked}),this.props.onChange(e))}},{key:"componentDidUpdate",value:function(e){this.props.hasOwnProperty("checked")&&this.props.checked!==e.checked&&this.setState({checked:this.props.checked||!1})}},{key:"render",value:function(){return u.a.createElement("span",{className:this.props.className},u.a.createElement("input",{id:this.props.id||"",type:"checkbox",checked:this.state.checked||!1,onChange:this.onCheck,required:!!this.props.required}),u.a.createElement("label",{htmlFor:"food"},this.props.label||""))}}]),n}(l.Component)},8:function(e,t,n){"use strict";n.d(t,"b",function(){return h}),n.d(t,"a",function(){return f});var a=n(64),r=n(3),o=n.n(r),i=n(14),s=n(6),c=n(9),l=n(17),u=n(112),p=n.n(u),d=n(21),h={FETCH_USER:"fetch_user",GOT_USER:"got_user",FETCH_MEMBERS:"fetch_members",GOT_MEMBERS:"got_members",EDIT_MEMBER:"edit_member",FETCH_RANKS:"fetch_ranks",GOT_RANKS:"got_ranks",FETCH_CONTACTS:"fetch_contacts",GOT_CONTACTS:"got_contacts",FETCH_ORDERS:"fetch_orders",GOT_ORDERS:"got_orders",FETCH_OPEN_ORDERS:"fetch_open_orders",GOT_OPEN_ORDERS:"got_open_orders",FETCH_BILLING_REPORTS:"fetch_billing_reports",GOT_BILLING_REPORTS:"got_billing_reports",ADD_BILLING_REPORT:"add_billing_report",APPROVE_BILLING_REPORT:"approve_billing_report",DECLINE_BILLING_REPORT:"decline_billing_report",EDIT_BILLING_REPORT:"edit_billing_report",FETCH_COMPENSATION_ENTRIES:"fetch_compensation_entries",GOT_COMPENSATION_ENTRIES:"got_compensation_entries",ADD_COMPENSATION_ENTRIES:"add_compensation_entries",ADD_COMPENSATION_ENTRY:"add_compensation_entry",APPROVE_COMPENSATION_ENTRY:"approve_compensation_entry",DECLINE_COMPENSATION_ENTRY:"dcline_compensation_entry",DELETE_COMPENSATION_ENTRY:"delete_compensation_entry",FETCH_USERS:"fetch_users",GOT_USERS:"got_users",FETCH_COLLECTION_POINTS:"fetch_collection_points",GOT_COLLECTION_POINTS:"got_collection_points",ADD_COLLECTION_POINT:"add_collection_point",ADD_PAYOUT:"add_payout",FETCH_PAYOUTS:"fetch_payouts",GOT_PAYOUTS:"got_payouts",SENDING_PAYOUTS_MAILS:"sending_payouts_mail",SENT_PAYOUTS_MAILS:"sent_payouts_mail",SENDING_PAYOUTS_BEXIO:"sending_payouts_bexio",SENT_PAYOUTS_BEXIO:"sent_payouts_bexio",FETCH_LOGOFFS:"fetch_logoffs",GOT_LOGOFFS:"got_logoffs",ADD_LOGOFFS:"add_logoffs",ADD_LOGOFF:"add_logoff",APPROVE_LOGOFF:"approve_logoff",DECLINE_LOGOFF:"dcline_logoff",DELETE_LOGOFF:"delete_logoff"},f=function(){function e(){Object(s.a)(this,e)}return Object(c.a)(e,null,[{key:"fetchUser",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];return e.fetchFromApi(d.a.apiEndpoint+"/api/me",h.FETCH_USER,h.GOT_USER)}},{key:"fetchContacts",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];return e.fetchFromApi(d.a.apiEndpoint+"/api/contacts",h.FETCH_CONTACTS,h.GOT_CONTACTS)}},{key:"fetchMembers",value:function(){return e.fetchFromApi(d.a.apiEndpoint+"/api/members",h.FETCH_MEMBERS,h.GOT_MEMBERS)}},{key:"editMember",value:function(t){return function(){var n=Object(i.a)(o.a.mark(function n(a){return o.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return a({type:h.EDIT_MEMBER}),n.abrupt("return",e.sendToApi("post",d.a.apiEndpoint+"/api/members",t,a,function(){a(e.fetchContacts())}));case 2:case"end":return n.stop()}},n)}));return function(e){return n.apply(this,arguments)}}()}},{key:"fetchRanks",value:function(){return e.fetchFromApi(d.a.apiEndpoint+"/api/ranks",h.FETCH_RANKS,h.GOT_RANKS)}},{key:"fetchOrders",value:function(){return e.fetchFromApi(d.a.apiEndpoint+"/api/orders",h.FETCH_ORDERS,h.GOT_ORDERS)}},{key:"fetchOpenOrders",value:function(){return e.fetchFromApi(d.a.apiEndpoint+"/api/billing-reports/open",h.FETCH_OPEN_ORDERS,h.GOT_OPEN_ORDERS)}},{key:"fetchBillingReports",value:function(){return e.fetchFromApi(d.a.apiEndpoint+"/api/billing-reports",h.FETCH_BILLING_REPORTS,h.GOT_BILLING_REPORTS)}},{key:"addBillingReport",value:function(t){return function(){var n=Object(i.a)(o.a.mark(function n(a){return o.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return a({type:h.ADD_BILLING_REPORT}),n.abrupt("return",e.sendToApi("put",d.a.apiEndpoint+"/api/billing-reports",t,a,function(){a(l.a.showSuccess("Gespeichert!")),a(e.fetchBillingReports())}));case 2:case"end":return n.stop()}},n)}));return function(e){return n.apply(this,arguments)}}()}},{key:"approveBillingReport",value:function(t){return function(){var n=Object(i.a)(o.a.mark(function n(a){return o.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return a({type:h.APPROVE_BILLING_REPORT,payload:t}),n.abrupt("return",e.sendToApi("post",d.a.apiEndpoint+"/api/billing-reports/approve",{id:t},a,function(){a(e.fetchBillingReports())}));case 2:case"end":return n.stop()}},n)}));return function(e){return n.apply(this,arguments)}}()}},{key:"declineBillingReport",value:function(t){return function(){var n=Object(i.a)(o.a.mark(function n(a){return o.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return a({type:h.DECLINE_BILLING_REPORT,payload:t}),n.abrupt("return",e.sendToApi("post",d.a.apiEndpoint+"/api/billing-reports/decline",{id:t},a,function(){a(e.fetchBillingReports())}));case 2:case"end":return n.stop()}},n)}));return function(e){return n.apply(this,arguments)}}()}},{key:"editBillingReport",value:function(t){return function(){var n=Object(i.a)(o.a.mark(function n(a){return o.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return a({type:h.EDIT_BILLING_REPORT}),n.abrupt("return",e.sendToApi("post",d.a.apiEndpoint+"/api/billing-reports",t,a,function(){a(e.fetchBillingReports())}));case 2:case"end":return n.stop()}},n)}));return function(e){return n.apply(this,arguments)}}()}},{key:"fetchCompensationEntries",value:function(){return e.fetchFromApi(d.a.apiEndpoint+"/api/compensations",h.FETCH_COMPENSATION_ENTRIES,h.GOT_COMPENSATION_ENTRIES)}},{key:"addCompensationEntriesForBillingReport",value:function(t){return function(){var n=Object(i.a)(o.a.mark(function n(a){return o.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return a({type:h.ADD_COMPENSATION_ENTRIES}),n.abrupt("return",e.sendToApi("put",d.a.apiEndpoint+"/api/compensations/bulk",t,a,function(){a(e.fetchCompensationEntries()),a(l.a.showSuccess("Gespeichert!"))}));case 2:case"end":return n.stop()}},n)}));return function(e){return n.apply(this,arguments)}}()}},{key:"addCompensationEntry",value:function(t){return function(){var n=Object(i.a)(o.a.mark(function n(a){return o.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return a({type:h.ADD_COMPENSATION_ENTRY}),n.abrupt("return",e.sendToApi("put",d.a.apiEndpoint+"/api/compensations",t,a,function(){a(e.fetchCompensationEntries())}));case 2:case"end":return n.stop()}},n)}));return function(e){return n.apply(this,arguments)}}()}},{key:"approveCompensationEntry",value:function(t){return function(){var n=Object(i.a)(o.a.mark(function n(a){return o.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return a({type:h.APPROVE_COMPENSATION_ENTRY,payload:t}),n.abrupt("return",e.sendToApi("post",d.a.apiEndpoint+"/api/compensations/approve",{id:t},a,function(){a(e.fetchCompensationEntries()),a(l.a.showSuccess("Genehmigt!"))}));case 2:case"end":return n.stop()}},n)}));return function(e){return n.apply(this,arguments)}}()}},{key:"deleteCompensationEntry",value:function(t){return function(){var n=Object(i.a)(o.a.mark(function n(a){return o.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return a({type:h.DELETE_COMPENSATION_ENTRY,payload:t}),n.abrupt("return",e.sendToApi("delete",d.a.apiEndpoint+"/api/compensations",{id:t},a,function(){a(e.fetchCompensationEntries()),a(l.a.showSuccess("Gel\xf6scht!"))}));case 2:case"end":return n.stop()}},n)}));return function(e){return n.apply(this,arguments)}}()}},{key:"fetchUsers",value:function(){return e.fetchFromApi(d.a.apiEndpoint+"/api/users",h.FETCH_USERS,h.GOT_USERS)}},{key:"fetchCollectionPoints",value:function(){return e.fetchFromApi(d.a.apiEndpoint+"/api/collection-points",h.FETCH_COLLECTION_POINTS,h.GOT_COLLECTION_POINTS)}},{key:"addCollectionPoint",value:function(t){return function(){var n=Object(i.a)(o.a.mark(function n(a){return o.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",new Promise(function(n,r){a({type:h.ADD_COLLECTION_POINT}),e.sendToApi("put",d.a.apiEndpoint+"/api/collection-points",t,a).then(function(){a(e.fetchCollectionPoints()),a(l.a.showSuccess("Gespeichert!")),n()}).catch(function(e){r(e)})}));case 1:case"end":return n.stop()}},n)}));return function(e){return n.apply(this,arguments)}}()}},{key:"fetchPayouts",value:function(){return e.fetchFromApi(d.a.apiEndpoint+"/api/payouts",h.FETCH_PAYOUTS,h.GOT_PAYOUTS)}},{key:"sendPayoutMails",value:function(t,n){return function(){var a=Object(i.a)(o.a.mark(function a(r){return o.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return r({type:h.SENDING_PAYOUTS_MAILS}),a.next=3,e.sendToApi("post",d.a.apiEndpoint+"/api/payouts/email",{payoutId:t,memberIds:n},r);case 3:r({type:h.SENT_PAYOUTS_MAILS}),r(l.a.showSuccess("Gesendet!"));case 5:case"end":return a.stop()}},a)}));return function(e){return a.apply(this,arguments)}}()}},{key:"sendToBexio",value:function(t,n){return function(){var a=Object(i.a)(o.a.mark(function a(r){return o.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return r({type:h.SENDING_PAYOUTS_BEXIO}),a.next=3,e.sendToApi("post",d.a.apiEndpoint+"/api/payouts/bexio",{payoutId:t,memberIds:n},r);case 3:r({type:h.SENT_PAYOUTS_BEXIO}),r(l.a.showSuccess("\xdcbertragen!"));case 5:case"end":return a.stop()}},a)}));return function(e){return a.apply(this,arguments)}}()}},{key:"addPayout",value:function(t){return function(){var n=Object(i.a)(o.a.mark(function n(a){return o.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",new Promise(function(n,r){a({type:h.ADD_PAYOUT}),e.sendToApi("put",d.a.apiEndpoint+"/api/payouts",t,a).then(function(){a(e.fetchPayouts()),a(l.a.showSuccess("Gespeichert!")),n()}).catch(function(e){r(e)})}));case 1:case"end":return n.stop()}},n)}));return function(e){return n.apply(this,arguments)}}()}},{key:"reclaimPayout",value:function(t){return function(){var n=Object(i.a)(o.a.mark(function n(a){return o.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.sendToApi("post",d.a.apiEndpoint+"/api/payouts/reclaim",{id:t},a);case 2:a(e.fetchPayouts()),a(l.a.showSuccess("Done!"));case 4:case"end":return n.stop()}},n)}));return function(e){return n.apply(this,arguments)}}()}},{key:"fetchLogoffs",value:function(){return e.fetchFromApi(d.a.apiEndpoint+"/api/logoffs",h.FETCH_LOGOFFS,h.GOT_LOGOFFS)}},{key:"addLogoff",value:function(t){return function(){var n=Object(i.a)(o.a.mark(function n(a){return o.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",new Promise(function(n,r){a({type:h.ADD_LOGOFF}),e.sendToApi("put",d.a.apiEndpoint+"/api/logoffs/add",t,a).then(function(){a(e.fetchLogoffs()),a(l.a.showSuccess("Gespeichert!")),n()}).catch(function(e){r(e)})}));case 1:case"end":return n.stop()}},n)}));return function(e){return n.apply(this,arguments)}}()}},{key:"addLogoffs",value:function(t){return function(){var n=Object(i.a)(o.a.mark(function n(a){return o.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",new Promise(function(n,r){a({type:h.ADD_LOGOFFS}),e.sendToApi("put",d.a.apiEndpoint+"/api/logoffs/add/bulk",t,a).then(function(){a(e.fetchLogoffs()),a(l.a.showSuccess("Gespeichert!")),n()}).catch(function(e){r(e)})}));case 1:case"end":return n.stop()}},n)}));return function(e){return n.apply(this,arguments)}}()}},{key:"approveLogoff",value:function(t){return function(){var n=Object(i.a)(o.a.mark(function n(a){return o.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return a({type:h.APPROVE_LOGOFF,payload:t}),n.abrupt("return",e.sendToApi("post",d.a.apiEndpoint+"/api/logoffs/approve",{id:t},a,function(){a(e.fetchLogoffs()),a(l.a.showSuccess("Genehmigt!"))}));case 2:case"end":return n.stop()}},n)}));return function(e){return n.apply(this,arguments)}}()}},{key:"declineLogoff",value:function(t){return function(){var n=Object(i.a)(o.a.mark(function n(a){return o.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return a({type:h.DECLINE_LOGOFF,payload:t}),n.abrupt("return",e.sendToApi("post",d.a.apiEndpoint+"/api/logoffs/decline",{id:t},a,function(){a(e.fetchLogoffs()),a(l.a.showSuccess("Genehmigt!"))}));case 2:case"end":return n.stop()}},n)}));return function(e){return n.apply(this,arguments)}}()}},{key:"deleteLogoff",value:function(t){return function(){var n=Object(i.a)(o.a.mark(function n(a){return o.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return a({type:h.DELETE_LOGOFF,payload:t}),n.abrupt("return",e.sendToApi("delete","".concat(d.a.apiEndpoint,"/api/logoffs/").concat(t),{},a).then(function(){a(e.fetchLogoffs()),a(l.a.showSuccess("Gel\xf6scht!"))}));case 2:case"end":return n.stop()}},n)}));return function(e){return n.apply(this,arguments)}}()}},{key:"fetchFromApi",value:function(t,n,a){return function(){var r=Object(i.a)(o.a.mark(function r(i){return o.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",new Promise(function(r,o){i({type:n}),e.getFromApi(t,i).then(function(e){r(i({type:a,payload:e}))}).catch(function(e){o(e)})}));case 1:case"end":return r.stop()}},r)}));return function(e){return r.apply(this,arguments)}}()}},{key:"getFromApi",value:function(){var t=Object(i.a)(o.a.mark(function t(n,a){var r,i;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,p.a.get(n,{withCredentials:!0});case 3:return r=t.sent,i=e.deepParser(r.data),t.abrupt("return",i);case 8:throw t.prev=8,t.t0=t.catch(0),t.t0.response&&403===t.t0.response.status?a(l.a.showError("Zugriff verweigert!")):t.t0.response&&401===t.t0.response.status?a(l.a.logout()):a(l.a.showError("Ooops... Da ist ein Fehler passiert!")),t.t0;case 12:case"end":return t.stop()}},t,null,[[0,8]])}));return function(e,n){return t.apply(this,arguments)}}()},{key:"sendToApi",value:function(t,n,r,o,i,s){var c=!(arguments.length>6&&void 0!==arguments[6])||arguments[6];return o(l.a.setWorking("fixed")),new Promise(function(u,d){p()(Object(a.a)({},s,{method:t,url:n,data:r,withCredentials:!0,timeout:6e5})).then(function(t){var n=t.data;c&&(n=e.deepParser(n)),i&&i(n),o(l.a.setWorking("nop")),u(n)}).catch(function(e){e.response&&403===e.response.status?o(l.a.showError("Zugriff verweigert!")):e.response&&401===e.response.status?o(l.a.logout()):o(l.a.showError("Ooops... Da ist ein Fehler passiert!")),o(l.a.setWorking("nop")),d(e)})})}},{key:"deepParser",value:function(t){if(t instanceof Array||"object"===typeof t){for(var n in t)t[n]=e.deepParser(t[n]);return t}return/([0-9]{4}-(0[1-9]|1[0-2])-(0[1-9]|[1-2][0-9]|3[0-1])T(2[0-3]|[01][0-9]):[0-5][0-9]:[0-5][0-9].[0-9][0-9][0-9]Z|[0-9]{4}-(0[1-9]|1[0-2])-(0[1-9]|[1-2][0-9]|3[0-1]))/.test(t)?new Date(t):t}}]),e}()},88:function(e,t,n){"use strict";n.d(t,"a",function(){return y});var a=n(3),r=n.n(a),o=n(14),i=n(30),s=n(6),c=n(9),l=n(11),u=n(4),p=n(5),d=n(10),h=n(0),f=n.n(h),m=n(33),b=n(58),v=n(54),y=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).onAdd=n.onAdd.bind(Object(p.a)(n)),n.onInputChange=n.onInputChange.bind(Object(p.a)(n)),n.onSelectChange=n.onSelectChange.bind(Object(p.a)(n)),n.removeTableItem=n.removeTableItem.bind(Object(p.a)(n)),n.validate=n.validate.bind(Object(p.a)(n)),n.state={tableEntries:{},vks:[],from:"",until:"",charge:!0},n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"onAdd",value:function(e){if(e.preventDefault(),this.formEl){var t=this.state.tableEntries,n=this.formEl.checkValidity();if(this.formEl.className="was-validated",n&&(n=this.state.vks.length>0),n){var a=new Date("01/01/1970 "+this.state.from),r=new Date("01/01/1970 "+this.state.until),o=(r.getTime()-a.getTime())/1e3/60/60;o<0&&(o+=24);var i=!0,s=!1,c=void 0;try{for(var l,u=this.state.vks[Symbol.iterator]();!(i=(l=u.next()).done);i=!0){var p=l.value;t[Math.round(1e5*Math.random())]={id:p.id,member:p,from:a,until:r,charge:this.state.charge,totalHours:o}}}catch(d){s=!0,c=d}finally{try{i||null==u.return||u.return()}finally{if(s)throw c}}this.setState({tableEntries:t,vks:[],from:"",until:"",charge:!0})}}}},{key:"onInputChange",value:function(e){var t=e.target,n="checkbox"===t.type?t.checked:t.value,a=t.name;this.setState(Object(i.a)({},a,n))}},{key:"onSelectChange",value:function(e){if(e){var t=e;this.setState({vks:t})}}},{key:"removeTableItem",value:function(e){if(e.currentTarget.parentNode&&e.currentTarget.parentNode.parentElement){var t=e.currentTarget.parentNode.parentElement.getAttribute("data-key");if(t){var n=this.state.tableEntries;delete n[t.replace("_","")],this.setState({tableEntries:n})}}}},{key:"validate",value:function(){var e=Object(o.a)(r.a.mark(function e(){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(Object.keys(this.state.tableEntries).length>0)){e.next=3;break}return this.props.onNext({vks:this.state.tableEntries}),e.abrupt("return",!0);case 3:return e.abrupt("return",!1);case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return f.a.createElement(b.a,Object.assign({title:"Einsatzzeiten",onNextStep:this.validate,onPreviousStep:this.props.onPrevious||Object(o.a)(r.a.mark(function e(){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",!0);case 1:case"end":return e.stop()}},e)}))},this.props),f.a.createElement("form",{ref:function(t){return e.formEl=t}},f.a.createElement("div",{className:"row"},f.a.createElement("div",{className:"col"},f.a.createElement("h5",null,"VKs"),f.a.createElement(v.a,{onChange:this.onSelectChange,isMulti:!0,defaultValue:this.state.vks})),f.a.createElement("div",{className:"col-2"},f.a.createElement("h5",null,"Verrechnen"),f.a.createElement("span",{className:"switch switch-sm"},f.a.createElement("input",{type:"checkbox",className:"switch",id:"charge",name:"charge",checked:this.state.charge,onChange:this.onInputChange}),f.a.createElement("label",{htmlFor:"charge"})))),f.a.createElement("br",null),f.a.createElement("div",{className:"row"},f.a.createElement("div",{className:"col"},f.a.createElement("h5",null,"Von"),f.a.createElement("input",{type:"time",name:"from",value:this.state.from,onChange:this.onInputChange,className:"form-control",required:!0})),f.a.createElement("div",{className:"col"},f.a.createElement("h5",null,"Bis"),f.a.createElement("input",{type:"time",name:"until",value:this.state.until,onChange:this.onInputChange,className:"form-control",required:!0}))),f.a.createElement("br",null),f.a.createElement("div",{className:"row"},f.a.createElement("div",{className:"col"},f.a.createElement("button",{className:"btn btn-primary btn-block",onClick:this.onAdd},"Hinzuf\xfcgen")))),f.a.createElement("br",null),f.a.createElement("div",{className:"row"},f.a.createElement(m.a,{columns:[{text:"VK",keys:{member:["firstname","lastname"]},sortable:!0},{text:"Von",keys:["from"],format:"toLocaleTimeString",sortable:!0},{text:"Bis",keys:["until"],format:"toLocaleTimeString",sortable:!0},{text:"Anzahl Stunden",keys:["totalHours"],sortable:!0},{text:"Verrechnet",keys:["charge"],sortable:!0},{text:"Actions",keys:["id"],content:f.a.createElement("button",{className:"btn btn-danger",onClick:this.removeTableItem},"\u2a2f")}],defaultSort:{keys:["from"],direction:"asc"},data:this.state.tableEntries})))}}]),t}(h.Component)}},[[161,2,1]]]);
//# sourceMappingURL=main.965fdf3e.chunk.js.map